/*! Built with IMPACT - impactjs.com */

(function(window){"use strict";Number.prototype.clamp=function(min,max){return Math.min(Math.max(this,min),max);};Number.prototype.map=function(istart,istop,ostart,ostop){return ostart+(ostop-ostart)*((this-istart)/(istop-istart));};Number.prototype.limit=function(min,max){return Math.min(max,Math.max(min,this));};Number.prototype.round=function(precision){precision=Math.pow(10,precision||0);return Math.round(this*precision)/precision;};Number.prototype.floor=function(){return Math.floor(this);};Number.prototype.ceil=function(){return Math.ceil(this);};Number.prototype.toInt=function(){return(this|0);};Number.prototype.toRad=function(){return(this/180)*Math.PI;};Number.prototype.toDeg=function(){return(this*180)/Math.PI;};Array.prototype.erase=function(item){for(var i=this.length;i--;){if(this[i]===item){this.splice(i,1);}}
return this;};Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)];};Function.prototype.bind=Function.prototype.bind||function(oThis){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");}
var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){},fBound=function(){return fToBind.apply((this instanceof fNOP&&oThis?this:oThis),aArgs.concat(Array.prototype.slice.call(arguments)));};fNOP.prototype=this.prototype;fBound.prototype=new fNOP();return fBound;};window.ig={game:null,debug:null,version:'1.22',global:window,modules:{},resources:[],ready:false,baked:false,nocache:'',ua:{},prefix:(window.ImpactPrefix||''),lib:'lib/',_current:null,_loadQueue:[],_waitForOnload:0,$:function(selector){return selector.charAt(0)=='#'?document.getElementById(selector.substr(1)):document.getElementsByTagName(selector);},$new:function(name){return document.createElement(name);},copy:function(object){if(!object||typeof(object)!='object'||object instanceof HTMLElement||object instanceof ig.Class){return object;}
else if(object instanceof Array){var c=[];for(var i=0,l=object.length;i<l;i++){c[i]=ig.copy(object[i]);}
return c;}
else{var c={};for(var i in object){c[i]=ig.copy(object[i]);}
return c;}},merge:function(original,extended){for(var key in extended){var ext=extended[key];if(typeof(ext)!='object'||ext instanceof HTMLElement||ext instanceof ig.Class){original[key]=ext;}
else{if(!original[key]||typeof(original[key])!='object'){original[key]=(ext instanceof Array)?[]:{};}
ig.merge(original[key],ext);}}
return original;},ksort:function(obj){if(!obj||typeof(obj)!='object'){return[];}
var keys=[],values=[];for(var i in obj){keys.push(i);}
keys.sort();for(var i=0;i<keys.length;i++){values.push(obj[keys[i]]);}
return values;},setVendorAttribute:function(el,attr,val){var uc=attr.charAt(0).toUpperCase()+attr.substr(1);el[attr]=el['ms'+uc]=el['moz'+uc]=el['webkit'+uc]=el['o'+uc]=val;},getVendorAttribute:function(el,attr){var uc=attr.charAt(0).toUpperCase()+attr.substr(1);return el[attr]||el['ms'+uc]||el['moz'+uc]||el['webkit'+uc]||el['o'+uc];},normalizeVendorAttribute:function(el,attr){var prefixedVal=ig.getVendorAttribute(el,attr);if(!el[attr]&&prefixedVal){el[attr]=prefixedVal;}},getImagePixels:function(image,x,y,width,height){var canvas=ig.$new('canvas');canvas.width=image.width;canvas.height=image.height;var ctx=canvas.getContext('2d');ig.System.SCALE.CRISP(canvas,ctx);var ratio=ig.getVendorAttribute(ctx,'backingStorePixelRatio')||1;ig.normalizeVendorAttribute(ctx,'getImageDataHD');var realWidth=image.width/ratio,realHeight=image.height/ratio;canvas.width=Math.ceil(realWidth);canvas.height=Math.ceil(realHeight);ctx.drawImage(image,0,0,realWidth,realHeight);return(ratio===1)?ctx.getImageData(x,y,width,height):ctx.getImageDataHD(x,y,width,height);},module:function(name){if(ig._current){throw("Module '"+ig._current.name+"' defines nothing");}
if(ig.modules[name]&&ig.modules[name].body){throw("Module '"+name+"' is already defined");}
ig._current={name:name,requires:[],loaded:false,body:null};ig.modules[name]=ig._current;ig._loadQueue.push(ig._current);return ig;},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig;},defines:function(body){ig._current.body=body;ig._current=null;ig._initDOMReady();},addResource:function(resource){ig.resources.push(resource);},setNocache:function(set){ig.nocache=set?'?'+Date.now():'';},log:function(){},assert:function(condition,msg){},show:function(name,number){},mark:function(msg,color){},_loadScript:function(name,requiredFrom){ig.modules[name]={name:name,requires:[],loaded:false,body:null};ig._waitForOnload++;var path=ig.prefix+ig.lib+name.replace(/\./g,'/')+'.js'+ig.nocache;var script=ig.$new('script');script.type='text/javascript';script.src=path;script.onload=function(){ig._waitForOnload--;ig._execModules();};script.onerror=function(){throw('Failed to load module '+name+' at '+path+' '+'required from '+requiredFrom);};ig.$('head')[0].appendChild(script);},_execModules:function(){var modulesLoaded=false;for(var i=0;i<ig._loadQueue.length;i++){var m=ig._loadQueue[i];var dependenciesLoaded=true;for(var j=0;j<m.requires.length;j++){var name=m.requires[j];if(!ig.modules[name]){dependenciesLoaded=false;ig._loadScript(name,m.name);}
else if(!ig.modules[name].loaded){dependenciesLoaded=false;}}
if(dependenciesLoaded&&m.body){ig._loadQueue.splice(i,1);m.loaded=true;m.body();modulesLoaded=true;i--;}}
if(modulesLoaded){ig._execModules();}
else if(!ig.baked&&ig._waitForOnload==0&&ig._loadQueue.length!=0){var unresolved=[];for(var i=0;i<ig._loadQueue.length;i++){var unloaded=[];var requires=ig._loadQueue[i].requires;for(var j=0;j<requires.length;j++){var m=ig.modules[requires[j]];if(!m||!m.loaded){unloaded.push(requires[j]);}}
unresolved.push(ig._loadQueue[i].name+' (requires: '+unloaded.join(', ')+')');}
throw('Unresolved (circular?) dependencies. '+"Most likely there's a name/path mismatch for one of the listed modules:\n"+
unresolved.join('\n'));}},_DOMReady:function(){if(!ig.modules['dom.ready'].loaded){if(!document.body){return setTimeout(ig._DOMReady,13);}
ig.modules['dom.ready'].loaded=true;ig._waitForOnload--;ig._execModules();}
return 0;},_boot:function(){if(document.location.href.match(/\?nocache/)){ig.setNocache(true);}
ig.ua.pixelRatio=window.devicePixelRatio||1;ig.ua.viewport={width:window.innerWidth,height:window.innerHeight};ig.ua.screen={width:window.screen.availWidth*ig.ua.pixelRatio,height:window.screen.availHeight*ig.ua.pixelRatio};ig.ua.iPhone=/iPhone/i.test(navigator.userAgent);ig.ua.iPhone4=(ig.ua.iPhone&&ig.ua.pixelRatio==2);ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.winPhone;ig.ua.touchDevice=(('ontouchstart'in window)||(window.navigator.msMaxTouchPoints));},_initDOMReady:function(){if(ig.modules['dom.ready']){ig._execModules();return;}
ig._boot();ig.modules['dom.ready']={requires:[],loaded:false,body:null};ig._waitForOnload++;if(document.readyState==='complete'){ig._DOMReady();}
else{document.addEventListener('DOMContentLoaded',ig._DOMReady,false);window.addEventListener('load',ig._DOMReady,false);}}};ig.normalizeVendorAttribute(window,'requestAnimationFrame');if(window.requestAnimationFrame){var next=1,anims={};window.ig.setAnimation=function(callback,element){var current=next++;anims[current]=true;var animate=function(){if(!anims[current]){return;}
window.requestAnimationFrame(animate,element);callback();};window.requestAnimationFrame(animate,element);return current;};window.ig.clearAnimation=function(id){delete anims[id];};}
else{window.ig.setAnimation=function(callback,element){return window.setInterval(callback,1000/60);};window.ig.clearAnimation=function(id){window.clearInterval(id);};}
var initializing=false,fnTest=/xyz/.test(function(){xyz;})?/\bparent\b/:/.*/;window.ig.Class=function(){};var inject=function(prop){var proto=this.prototype;var parent={};for(var name in prop){if(typeof(prop[name])=="function"&&typeof(proto[name])=="function"&&fnTest.test(prop[name])){parent[name]=proto[name];proto[name]=(function(name,fn){return function(){var tmp=this.parent;this.parent=parent[name];var ret=fn.apply(this,arguments);this.parent=tmp;return ret;};})(name,prop[name]);}
else{proto[name]=prop[name];}}};window.ig.Class.extend=function(prop){var parent=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){if(typeof(prop[name])=="function"&&typeof(parent[name])=="function"&&fnTest.test(prop[name])){prototype[name]=(function(name,fn){return function(){var tmp=this.parent;this.parent=parent[name];var ret=fn.apply(this,arguments);this.parent=tmp;return ret;};})(name,prop[name]);}
else{prototype[name]=prop[name];}}
function Class(){if(!initializing){if(this.staticInstantiate){var obj=this.staticInstantiate.apply(this,arguments);if(obj){return obj;}}
for(var p in this){if(typeof(this[p])=='object'){this[p]=ig.copy(this[p]);}}
if(this.init){this.init.apply(this,arguments);}}
return this;}
Class.prototype=prototype;Class.prototype.constructor=Class;Class.extend=window.ig.Class.extend;Class.inject=inject;return Class;};if(window.ImpactMixin){ig.merge(ig,window.ImpactMixin);}})(window);

// lib/impact/image.js
ig.baked=true;ig.module('impact.image').defines(function(){"use strict";ig.Image=ig.Class.extend({data:null,width:0,height:0,loaded:false,failed:false,loadCallback:null,path:'',staticInstantiate:function(path){return ig.Image.cache[path]||null;},init:function(path){this.path=path;this.load();},load:function(loadCallback){if(this.loaded){if(loadCallback){loadCallback(this.path,true);}
return;}
else if(!this.loaded&&ig.ready){this.loadCallback=loadCallback||null;this.data=new Image();this.data.onload=this.onload.bind(this);this.data.onerror=this.onerror.bind(this);this.data.src=ig.prefix+this.path+ig.nocache;}
else{ig.addResource(this);}
ig.Image.cache[this.path]=this;},reload:function(){this.loaded=false;this.data=new Image();this.data.onload=this.onload.bind(this);this.data.src=this.path+'?'+Date.now();},onload:function(event){this.width=this.data.width;this.height=this.data.height;this.loaded=true;if(ig.system.scale!=1){this.resize(ig.system.scale);}
if(this.loadCallback){this.loadCallback(this.path,true);}},onerror:function(event){this.failed=true;if(this.loadCallback){this.loadCallback(this.path,false);}},resize:function(scale){var origPixels=ig.getImagePixels(this.data,0,0,this.width,this.height);var widthScaled=this.width*scale;var heightScaled=this.height*scale;var scaled=ig.$new('canvas');scaled.width=widthScaled;scaled.height=heightScaled;var scaledCtx=scaled.getContext('2d');var scaledPixels=scaledCtx.getImageData(0,0,widthScaled,heightScaled);for(var y=0;y<heightScaled;y++){for(var x=0;x<widthScaled;x++){var index=(Math.floor(y/scale)*this.width+Math.floor(x/scale))*4;var indexScaled=(y*widthScaled+x)*4;scaledPixels.data[indexScaled]=origPixels.data[index];scaledPixels.data[indexScaled+1]=origPixels.data[index+1];scaledPixels.data[indexScaled+2]=origPixels.data[index+2];scaledPixels.data[indexScaled+3]=origPixels.data[index+3];}}
scaledCtx.putImageData(scaledPixels,0,0);this.data=scaled;},draw:function(targetX,targetY,sourceX,sourceY,width,height){if(!this.loaded){return;}
var scale=ig.system.scale;sourceX=sourceX?sourceX*scale:0;sourceY=sourceY?sourceY*scale:0;width=(width?width:this.width)*scale;height=(height?height:this.height)*scale;ig.system.context.drawImage(this.data,sourceX,sourceY,width,height,ig.system.getDrawPos(targetX),ig.system.getDrawPos(targetY),width,height);ig.Image.drawCount++;},drawTile:function(targetX,targetY,tile,tileWidth,tileHeight,flipX,flipY){tileHeight=tileHeight?tileHeight:tileWidth;if(!this.loaded||tileWidth>this.width||tileHeight>this.height){return;}
var scale=ig.system.scale;var tileWidthScaled=Math.floor(tileWidth*scale);var tileHeightScaled=Math.floor(tileHeight*scale);var scaleX=flipX?-1:1;var scaleY=flipY?-1:1;if(flipX||flipY){ig.system.context.save();ig.system.context.scale(scaleX,scaleY);}
ig.system.context.drawImage(this.data,(Math.floor(tile*tileWidth)%this.width)*scale,(Math.floor(tile*tileWidth/this.width)*tileHeight)*scale,tileWidthScaled,tileHeightScaled,ig.system.getDrawPos(targetX)*scaleX-(flipX?tileWidthScaled:0),ig.system.getDrawPos(targetY)*scaleY-(flipY?tileHeightScaled:0),tileWidthScaled,tileHeightScaled);if(flipX||flipY){ig.system.context.restore();}
ig.Image.drawCount++;}});ig.Image.drawCount=0;ig.Image.cache={};ig.Image.reloadCache=function(){for(var path in ig.Image.cache){ig.Image.cache[path].reload();}};});

// lib/impact/font.js
ig.baked=true;ig.module('impact.font').requires('impact.image').defines(function(){"use strict";ig.Font=ig.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(ev){this._loadMetrics(this.data);this.parent(ev);},widthForString:function(text){if(text.indexOf('\n')!==-1){var lines=text.split('\n');var width=0;for(var i=0;i<lines.length;i++){width=Math.max(width,this._widthForLine(lines[i]));}
return width;}
else{return this._widthForLine(text);}},_widthForLine:function(text){var width=0;for(var i=0;i<text.length;i++){width+=this.widthMap[text.charCodeAt(i)-this.firstChar]+this.letterSpacing;}
return width;},heightForString:function(text){return text.split('\n').length*(this.height+this.lineSpacing);},draw:function(text,x,y,align){if(typeof(text)!='string'){text=text.toString();}
if(text.indexOf('\n')!==-1){var lines=text.split('\n');var lineHeight=this.height+this.lineSpacing;for(var i=0;i<lines.length;i++){this.draw(lines[i],x,y+i*lineHeight,align);}
return;}
if(align==ig.Font.ALIGN.RIGHT||align==ig.Font.ALIGN.CENTER){var width=this._widthForLine(text);x-=align==ig.Font.ALIGN.CENTER?width/2:width;}
if(this.alpha!==1){ig.system.context.globalAlpha=this.alpha;}
for(var i=0;i<text.length;i++){var c=text.charCodeAt(i);x+=this._drawChar(c-this.firstChar,x,y);}
if(this.alpha!==1){ig.system.context.globalAlpha=1;}
ig.Image.drawCount+=text.length;},_drawChar:function(c,targetX,targetY){if(!this.loaded||c<0||c>=this.indices.length){return 0;}
var scale=ig.system.scale;var charX=this.indices[c]*scale;var charY=0;var charWidth=this.widthMap[c]*scale;var charHeight=(this.height-2)*scale;ig.system.context.drawImage(this.data,charX,charY,charWidth,charHeight,ig.system.getDrawPos(targetX),ig.system.getDrawPos(targetY),charWidth,charHeight);return this.widthMap[c]+this.letterSpacing;},_loadMetrics:function(image){this.height=image.height-1;this.widthMap=[];this.indices=[];var px=ig.getImagePixels(image,0,image.height-1,image.width,1);var currentChar=0;var currentWidth=0;for(var x=0;x<image.width;x++){var index=x*4+3;if(px.data[index]>127){currentWidth++;}
else if(px.data[index]<128&&currentWidth){this.widthMap.push(currentWidth);this.indices.push(x-currentWidth);currentChar++;currentWidth=0;}}
this.widthMap.push(currentWidth);this.indices.push(x-currentWidth);}});ig.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2};});

// lib/impact/sound.js
ig.baked=true;ig.module('impact.sound').defines(function(){"use strict";ig.SoundManager=ig.Class.extend({clips:{},volume:1,format:null,init:function(){if(!ig.Sound.enabled||!window.Audio){ig.Sound.enabled=false;return;}
var probe=new Audio();for(var i=0;i<ig.Sound.use.length;i++){var format=ig.Sound.use[i];if(probe.canPlayType(format.mime)){this.format=format;break;}}
if(!this.format){ig.Sound.enabled=false;}},load:function(path,multiChannel,loadCallback){var realPath=ig.prefix+path.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[path]){if(multiChannel&&this.clips[path].length<ig.Sound.channels){for(var i=this.clips[path].length;i<ig.Sound.channels;i++){var a=new Audio(realPath);a.load();this.clips[path].push(a);}}
return this.clips[path][0];}
var clip=new Audio(realPath);if(loadCallback){clip.addEventListener('canplaythrough',function cb(ev){clip.removeEventListener('canplaythrough',cb,false);loadCallback(path,true,ev);},false);clip.addEventListener('error',function(ev){loadCallback(path,false,ev);},false);}
clip.preload='auto';clip.load();this.clips[path]=[clip];if(multiChannel){for(var i=1;i<ig.Sound.channels;i++){var a=new Audio(realPath);a.load();this.clips[path].push(a);}}
return clip;},get:function(path){var channels=this.clips[path];for(var i=0,clip;clip=channels[i++];){if(clip.paused||clip.ended){if(clip.ended){clip.currentTime=0;}
return clip;}}
channels[0].pause();channels[0].currentTime=0;return channels[0];}});ig.Music=ig.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,random:false,_volume:1,_loop:false,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this);if(Object.defineProperty){Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)});Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)});}
else if(this.__defineGetter__){this.__defineGetter__('volume',this.getVolume.bind(this));this.__defineSetter__('volume',this.setVolume.bind(this));this.__defineGetter__('loop',this.getLooping.bind(this));this.__defineSetter__('loop',this.setLooping.bind(this));}},add:function(music,name){if(!ig.Sound.enabled){return;}
var path=music instanceof ig.Sound?music.path:music;var track=ig.soundManager.load(path,false);track.loop=this._loop;track.volume=this._volume;track.addEventListener('ended',this._endedCallbackBound,false);this.tracks.push(track);if(name){this.namedTracks[name]=track;}
if(!this.currentTrack){this.currentTrack=track;}},next:function(){if(!this.tracks.length){return;}
this.stop();this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length;this.currentTrack=this.tracks[this.currentIndex];this.play();},pause:function(){if(!this.currentTrack){return;}
this.currentTrack.pause();},stop:function(){if(!this.currentTrack){return;}
this.currentTrack.pause();this.currentTrack.currentTime=0;},play:function(name){if(name&&this.namedTracks[name]){var newTrack=this.namedTracks[name];if(newTrack!=this.currentTrack){this.stop();this.currentTrack=newTrack;}}
else if(!this.currentTrack){return;}
this.currentTrack.play();},getLooping:function(){return this._loop;},setLooping:function(l){this._loop=l;for(var i in this.tracks){this.tracks[i].loop=l;}},getVolume:function(){return this._volume;},setVolume:function(v){this._volume=v.limit(0,1);for(var i in this.tracks){this.tracks[i].volume=this._volume;}},fadeOut:function(time){if(!this.currentTrack){return;}
clearInterval(this._fadeInterval);this.fadeTimer=new ig.Timer(time);this._fadeInterval=setInterval(this._fadeStep.bind(this),50);},_fadeStep:function(){var v=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;if(v<=0.01){this.stop();this.currentTrack.volume=this._volume;clearInterval(this._fadeInterval);}
else{this.currentTrack.volume=v;}},_endedCallback:function(){if(this._loop){this.play();}
else{this.next();}}});ig.Sound=ig.Class.extend({path:'',volume:1,currentClip:null,multiChannel:true,init:function(path,multiChannel){this.path=path;this.multiChannel=(multiChannel!==false);this.load();},load:function(loadCallback){if(!ig.Sound.enabled){if(loadCallback){loadCallback(this.path,true);}
return;}
if(ig.ready){ig.soundManager.load(this.path,this.multiChannel,loadCallback);}
else{ig.addResource(this);}},play:function(){if(!ig.Sound.enabled){return;}
this.currentClip=ig.soundManager.get(this.path);this.currentClip.volume=ig.soundManager.volume*this.volume;this.currentClip.play();},stop:function(){if(this.currentClip){this.currentClip.pause();this.currentClip.currentTime=0;}}});ig.Sound.FORMAT={MP3:{ext:'mp3',mime:'audio/mpeg'},M4A:{ext:'m4a',mime:'audio/mp4; codecs=mp4a'},OGG:{ext:'ogg',mime:'audio/ogg; codecs=vorbis'},WEBM:{ext:'webm',mime:'audio/webm; codecs=vorbis'},CAF:{ext:'caf',mime:'audio/x-caf'}};ig.Sound.use=[ig.Sound.FORMAT.OGG,ig.Sound.FORMAT.MP3];ig.Sound.channels=4;ig.Sound.enabled=true;});

// lib/impact/loader.js
ig.baked=true;ig.module('impact.loader').requires('impact.image','impact.font','impact.sound').defines(function(){"use strict";ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:false,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(gameClass,resources){this.gameClass=gameClass;this.resources=resources;this._loadCallbackBound=this._loadCallback.bind(this);for(var i=0;i<this.resources.length;i++){this._unloaded.push(this.resources[i].path);}},load:function(){ig.system.clear('#000');if(!this.resources.length){this.end();return;}
for(var i=0;i<this.resources.length;i++){this.loadResource(this.resources[i]);}
this._intervalId=setInterval(this.draw.bind(this),16);},loadResource:function(res){res.load(this._loadCallbackBound);},end:function(){if(this.done){return;}
this.done=true;clearInterval(this._intervalId);ig.system.setGame(this.gameClass);},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;var s=ig.system.scale;var w=ig.system.width*0.6;var h=ig.system.height*0.1;var x=ig.system.width*0.5-w/2;var y=ig.system.height*0.5-h/2;ig.system.context.fillStyle='#000';ig.system.context.fillRect(0,0,480,320);ig.system.context.fillStyle='#fff';ig.system.context.fillRect(x*s,y*s,w*s,h*s);ig.system.context.fillStyle='#000';ig.system.context.fillRect(x*s+s,y*s+s,w*s-s-s,h*s-s-s);ig.system.context.fillStyle='#fff';ig.system.context.fillRect(x*s,y*s,w*s*this._drawStatus,h*s);},_loadCallback:function(path,status){if(status){this._unloaded.erase(path);}
else{throw('Failed to load resource: '+path);}
this.status=1-(this._unloaded.length/this.resources.length);if(this._unloaded.length==0){setTimeout(this.end.bind(this),250);}}});});

// lib/impact/timer.js
ig.baked=true;ig.module('impact.timer').defines(function(){"use strict";ig.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(seconds){this.base=ig.Timer.time;this.last=ig.Timer.time;this.target=seconds||0;},set:function(seconds){this.target=seconds||0;this.base=ig.Timer.time;this.pausedAt=0;},reset:function(){this.base=ig.Timer.time;this.pausedAt=0;},tick:function(){var delta=ig.Timer.time-this.last;this.last=ig.Timer.time;return(this.pausedAt?0:delta);},delta:function(){return(this.pausedAt||ig.Timer.time)-this.base-this.target;},pause:function(){if(!this.pausedAt){this.pausedAt=ig.Timer.time;}},unpause:function(){if(this.pausedAt){this.base+=ig.Timer.time-this.pausedAt;this.pausedAt=0;}}});ig.Timer._last=0;ig.Timer.time=Number.MIN_VALUE;ig.Timer.timeScale=1;ig.Timer.maxStep=0.05;ig.Timer.step=function(){var current=Date.now();var delta=(current-ig.Timer._last)/1000;ig.Timer.time+=Math.min(delta,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=current;};});

// lib/impact/system.js
ig.baked=true;ig.module('impact.system').requires('impact.timer','impact.image').defines(function(){"use strict";ig.System=ig.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:false,delegate:null,clock:null,canvas:null,context:null,init:function(canvasId,fps,width,height,scale){this.fps=fps;this.clock=new ig.Timer();this.canvas=ig.$(canvasId);this.resize(width,height,scale);this.context=this.canvas.getContext('2d');this.getDrawPos=ig.System.drawMode;if(this.scale!=1){ig.System.scaleMode=ig.System.SCALE.CRISP;}
ig.System.scaleMode(this.canvas,this.context);},resize:function(width,height,scale){this.width=width;this.height=height;this.scale=scale||this.scale;this.realWidth=this.width*this.scale;this.realHeight=this.height*this.scale;this.canvas.width=this.realWidth;this.canvas.height=this.realHeight;},setGame:function(gameClass){if(this.running){this.newGameClass=gameClass;}
else{this.setGameNow(gameClass);}},setGameNow:function(gameClass){ig.game=new(gameClass)();ig.system.setDelegate(ig.game);},setDelegate:function(object){if(typeof(object.run)=='function'){this.delegate=object;this.startRunLoop();}else{throw('System.setDelegate: No run() function in object');}},stopRunLoop:function(){ig.clearAnimation(this.animationId);this.running=false;},startRunLoop:function(){this.stopRunLoop();this.animationId=ig.setAnimation(this.run.bind(this),this.canvas);this.running=true;},clear:function(color){this.context.fillStyle=color;this.context.fillRect(0,0,this.realWidth,this.realHeight);},run:function(){ig.Timer.step();this.tick=this.clock.tick();this.delegate.run();ig.input.clearPressed();if(this.newGameClass){this.setGameNow(this.newGameClass);this.newGameClass=null;}},getDrawPos:null});ig.System.DRAW={AUTHENTIC:function(p){return(0|(0.5+p))*this.scale;},SMOOTH:function(p){return 0|(0.5+p*this.scale);},SUBPIXEL:function(p){return p*this.scale;}};ig.System.drawMode=ig.System.DRAW.SMOOTH;ig.System.SCALE={CRISP:function(canvas,context){ig.setVendorAttribute(context,'imageSmoothingEnabled',false);canvas.style.imageRendering='-moz-crisp-edges';canvas.style.imageRendering='-o-crisp-edges';canvas.style.imageRendering='-webkit-optimize-contrast';canvas.style.imageRendering='crisp-edges';canvas.style.msInterpolationMode='nearest-neighbor';},SMOOTH:function(canvas,context){ig.setVendorAttribute(context,'imageSmoothingEnabled',true);canvas.style.imageRendering='';canvas.style.msInterpolationMode='';}};ig.System.scaleMode=ig.System.SCALE.SMOOTH;});

// lib/impact/input.js
ig.baked=true;ig.module('impact.input').defines(function(){"use strict";ig.KEY={'MOUSE1':-1,'MOUSE2':-3,'MWHEEL_UP':-4,'MWHEEL_DOWN':-5,'BACKSPACE':8,'TAB':9,'ENTER':13,'PAUSE':19,'CAPS':20,'ESC':27,'SPACE':32,'PAGE_UP':33,'PAGE_DOWN':34,'END':35,'HOME':36,'LEFT_ARROW':37,'UP_ARROW':38,'RIGHT_ARROW':39,'DOWN_ARROW':40,'INSERT':45,'DELETE':46,'_0':48,'_1':49,'_2':50,'_3':51,'_4':52,'_5':53,'_6':54,'_7':55,'_8':56,'_9':57,'A':65,'B':66,'C':67,'D':68,'E':69,'F':70,'G':71,'H':72,'I':73,'J':74,'K':75,'L':76,'M':77,'N':78,'O':79,'P':80,'Q':81,'R':82,'S':83,'T':84,'U':85,'V':86,'W':87,'X':88,'Y':89,'Z':90,'NUMPAD_0':96,'NUMPAD_1':97,'NUMPAD_2':98,'NUMPAD_3':99,'NUMPAD_4':100,'NUMPAD_5':101,'NUMPAD_6':102,'NUMPAD_7':103,'NUMPAD_8':104,'NUMPAD_9':105,'MULTIPLY':106,'ADD':107,'SUBSTRACT':109,'DECIMAL':110,'DIVIDE':111,'F1':112,'F2':113,'F3':114,'F4':115,'F5':116,'F6':117,'F7':118,'F8':119,'F9':120,'F10':121,'F11':122,'F12':123,'SHIFT':16,'CTRL':17,'ALT':18,'PLUS':187,'COMMA':188,'MINUS':189,'PERIOD':190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:false,isUsingKeyboard:false,isUsingAccelerometer:false,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){if(this.isUsingMouse){return;}
this.isUsingMouse=true;var mouseWheelBound=this.mousewheel.bind(this);ig.system.canvas.addEventListener('mousewheel',mouseWheelBound,false);ig.system.canvas.addEventListener('DOMMouseScroll',mouseWheelBound,false);ig.system.canvas.addEventListener('contextmenu',this.contextmenu.bind(this),false);ig.system.canvas.addEventListener('mousedown',this.keydown.bind(this),false);ig.system.canvas.addEventListener('mouseup',this.keyup.bind(this),false);ig.system.canvas.addEventListener('mousemove',this.mousemove.bind(this),false);if(ig.ua.touchDevice){ig.system.canvas.addEventListener('touchstart',this.keydown.bind(this),false);ig.system.canvas.addEventListener('touchend',this.keyup.bind(this),false);ig.system.canvas.addEventListener('touchmove',this.mousemove.bind(this),false);ig.system.canvas.addEventListener('MSPointerDown',this.keydown.bind(this),false);ig.system.canvas.addEventListener('MSPointerUp',this.keyup.bind(this),false);ig.system.canvas.addEventListener('MSPointerMove',this.mousemove.bind(this),false);ig.system.canvas.style.msTouchAction='none';}},initKeyboard:function(){if(this.isUsingKeyboard){return;}
this.isUsingKeyboard=true;window.addEventListener('keydown',this.keydown.bind(this),false);window.addEventListener('keyup',this.keyup.bind(this),false);},initAccelerometer:function(){if(this.isUsingAccelerometer){return;}
window.addEventListener('devicemotion',this.devicemotion.bind(this),false);},mousewheel:function(event){var delta=event.wheelDelta?event.wheelDelta:(event.detail*-1);var code=delta>0?ig.KEY.MWHEEL_UP:ig.KEY.MWHEEL_DOWN;var action=this.bindings[code];if(action){this.actions[action]=true;this.presses[action]=true;this.delayedKeyup[action]=true;event.stopPropagation();event.preventDefault();}},mousemove:function(event){var internalWidth=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;var scale=ig.system.scale*(internalWidth/ig.system.realWidth);var pos={left:0,top:0};if(ig.system.canvas.getBoundingClientRect){pos=ig.system.canvas.getBoundingClientRect();}
var ev=event.touches?event.touches[0]:event;this.mouse.x=(ev.clientX-pos.left)/scale;this.mouse.y=(ev.clientY-pos.top)/scale;},contextmenu:function(event){if(this.bindings[ig.KEY.MOUSE2]){event.stopPropagation();event.preventDefault();}},keydown:function(event){var tag=event.target.tagName;if(tag=='INPUT'||tag=='TEXTAREA'){return;}
var code=event.type=='keydown'?event.keyCode:(event.button==2?ig.KEY.MOUSE2:ig.KEY.MOUSE1);if(event.type=='touchstart'||event.type=='mousedown'){this.mousemove(event);}
var action=this.bindings[code];if(action){this.actions[action]=true;if(!this.locks[action]){this.presses[action]=true;this.locks[action]=true;}
event.stopPropagation();event.preventDefault();}},keyup:function(event){var tag=event.target.tagName;if(tag=='INPUT'||tag=='TEXTAREA'){return;}
var code=event.type=='keyup'?event.keyCode:(event.button==2?ig.KEY.MOUSE2:ig.KEY.MOUSE1);var action=this.bindings[code];if(action){this.delayedKeyup[action]=true;event.stopPropagation();event.preventDefault();}},devicemotion:function(event){this.accel=event.accelerationIncludingGravity;},bind:function(key,action){if(key<0){this.initMouse();}
else if(key>0){this.initKeyboard();}
this.bindings[key]=action;},bindTouch:function(selector,action){var element=ig.$(selector);var that=this;element.addEventListener('touchstart',function(ev){that.touchStart(ev,action);},false);element.addEventListener('touchend',function(ev){that.touchEnd(ev,action);},false);element.addEventListener('MSPointerDown',function(ev){that.touchStart(ev,action);},false);element.addEventListener('MSPointerUp',function(ev){that.touchEnd(ev,action);},false);},unbind:function(key){var action=this.bindings[key];this.delayedKeyup[action]=true;this.bindings[key]=null;},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={};},state:function(action){return this.actions[action];},pressed:function(action){return this.presses[action];},released:function(action){return this.delayedKeyup[action];},clearPressed:function(){for(var action in this.delayedKeyup){this.actions[action]=false;this.locks[action]=false;}
this.delayedKeyup={};this.presses={};},touchStart:function(event,action){this.actions[action]=true;this.presses[action]=true;event.stopPropagation();event.preventDefault();return false;},touchEnd:function(event,action){this.delayedKeyup[action]=true;event.stopPropagation();event.preventDefault();return false;}});});

// C:\Users\dvoyle200\SkyDrive\Development\web\impact\lib\impact\impact.js
ig.baked=true;ig.module('impact.impact').requires('dom.ready','impact.loader','impact.system','impact.input','impact.sound').defines(function(){"use strict";ig.main=function(canvasId,gameClass,fps,width,height,scale,loaderClass){ig.system=new ig.System(canvasId,fps,width,height,scale||1);ig.input=new ig.Input();ig.soundManager=new ig.SoundManager();ig.music=new ig.Music();ig.ready=true;var loader=new(loaderClass||ig.Loader)(gameClass,ig.resources);loader.load();};});(function(window){"use strict";Number.prototype.clamp=function(min,max){return Math.min(Math.max(this,min),max);};Number.prototype.map=function(istart,istop,ostart,ostop){return ostart+(ostop-ostart)*((this-istart)/(istop-istart));};Number.prototype.limit=function(min,max){return Math.min(max,Math.max(min,this));};Number.prototype.round=function(precision){precision=Math.pow(10,precision||0);return Math.round(this*precision)/precision;};Number.prototype.floor=function(){return Math.floor(this);};Number.prototype.ceil=function(){return Math.ceil(this);};Number.prototype.toInt=function(){return(this|0);};Number.prototype.toRad=function(){return(this/180)*Math.PI;};Number.prototype.toDeg=function(){return(this*180)/Math.PI;};Array.prototype.erase=function(item){for(var i=this.length;i--;){if(this[i]===item){this.splice(i,1);}}
return this;};Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)];};Function.prototype.bind=Function.prototype.bind||function(oThis){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");}
var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){},fBound=function(){return fToBind.apply((this instanceof fNOP&&oThis?this:oThis),aArgs.concat(Array.prototype.slice.call(arguments)));};fNOP.prototype=this.prototype;fBound.prototype=new fNOP();return fBound;};window.ig={game:null,debug:null,version:'1.22',global:window,modules:{},resources:[],ready:false,baked:false,nocache:'',ua:{},prefix:(window.ImpactPrefix||''),lib:'lib/',_current:null,_loadQueue:[],_waitForOnload:0,$:function(selector){return selector.charAt(0)=='#'?document.getElementById(selector.substr(1)):document.getElementsByTagName(selector);},$new:function(name){return document.createElement(name);},copy:function(object){if(!object||typeof(object)!='object'||object instanceof HTMLElement||object instanceof ig.Class){return object;}
else if(object instanceof Array){var c=[];for(var i=0,l=object.length;i<l;i++){c[i]=ig.copy(object[i]);}
return c;}
else{var c={};for(var i in object){c[i]=ig.copy(object[i]);}
return c;}},merge:function(original,extended){for(var key in extended){var ext=extended[key];if(typeof(ext)!='object'||ext instanceof HTMLElement||ext instanceof ig.Class){original[key]=ext;}
else{if(!original[key]||typeof(original[key])!='object'){original[key]=(ext instanceof Array)?[]:{};}
ig.merge(original[key],ext);}}
return original;},ksort:function(obj){if(!obj||typeof(obj)!='object'){return[];}
var keys=[],values=[];for(var i in obj){keys.push(i);}
keys.sort();for(var i=0;i<keys.length;i++){values.push(obj[keys[i]]);}
return values;},setVendorAttribute:function(el,attr,val){var uc=attr.charAt(0).toUpperCase()+attr.substr(1);el[attr]=el['ms'+uc]=el['moz'+uc]=el['webkit'+uc]=el['o'+uc]=val;},getVendorAttribute:function(el,attr){var uc=attr.charAt(0).toUpperCase()+attr.substr(1);return el[attr]||el['ms'+uc]||el['moz'+uc]||el['webkit'+uc]||el['o'+uc];},normalizeVendorAttribute:function(el,attr){var prefixedVal=ig.getVendorAttribute(el,attr);if(!el[attr]&&prefixedVal){el[attr]=prefixedVal;}},getImagePixels:function(image,x,y,width,height){var canvas=ig.$new('canvas');canvas.width=image.width;canvas.height=image.height;var ctx=canvas.getContext('2d');ig.System.SCALE.CRISP(canvas,ctx);var ratio=ig.getVendorAttribute(ctx,'backingStorePixelRatio')||1;ig.normalizeVendorAttribute(ctx,'getImageDataHD');var realWidth=image.width/ratio,realHeight=image.height/ratio;canvas.width=Math.ceil(realWidth);canvas.height=Math.ceil(realHeight);ctx.drawImage(image,0,0,realWidth,realHeight);return(ratio===1)?ctx.getImageData(x,y,width,height):ctx.getImageDataHD(x,y,width,height);},module:function(name){if(ig._current){throw("Module '"+ig._current.name+"' defines nothing");}
if(ig.modules[name]&&ig.modules[name].body){throw("Module '"+name+"' is already defined");}
ig._current={name:name,requires:[],loaded:false,body:null};ig.modules[name]=ig._current;ig._loadQueue.push(ig._current);return ig;},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig;},defines:function(body){ig._current.body=body;ig._current=null;ig._initDOMReady();},addResource:function(resource){ig.resources.push(resource);},setNocache:function(set){ig.nocache=set?'?'+Date.now():'';},log:function(){},assert:function(condition,msg){},show:function(name,number){},mark:function(msg,color){},_loadScript:function(name,requiredFrom){ig.modules[name]={name:name,requires:[],loaded:false,body:null};ig._waitForOnload++;var path=ig.prefix+ig.lib+name.replace(/\./g,'/')+'.js'+ig.nocache;var script=ig.$new('script');script.type='text/javascript';script.src=path;script.onload=function(){ig._waitForOnload--;ig._execModules();};script.onerror=function(){throw('Failed to load module '+name+' at '+path+' '+'required from '+requiredFrom);};ig.$('head')[0].appendChild(script);},_execModules:function(){var modulesLoaded=false;for(var i=0;i<ig._loadQueue.length;i++){var m=ig._loadQueue[i];var dependenciesLoaded=true;for(var j=0;j<m.requires.length;j++){var name=m.requires[j];if(!ig.modules[name]){dependenciesLoaded=false;ig._loadScript(name,m.name);}
else if(!ig.modules[name].loaded){dependenciesLoaded=false;}}
if(dependenciesLoaded&&m.body){ig._loadQueue.splice(i,1);m.loaded=true;m.body();modulesLoaded=true;i--;}}
if(modulesLoaded){ig._execModules();}
else if(!ig.baked&&ig._waitForOnload==0&&ig._loadQueue.length!=0){var unresolved=[];for(var i=0;i<ig._loadQueue.length;i++){var unloaded=[];var requires=ig._loadQueue[i].requires;for(var j=0;j<requires.length;j++){var m=ig.modules[requires[j]];if(!m||!m.loaded){unloaded.push(requires[j]);}}
unresolved.push(ig._loadQueue[i].name+' (requires: '+unloaded.join(', ')+')');}
throw('Unresolved (circular?) dependencies. '+"Most likely there's a name/path mismatch for one of the listed modules:\n"+
unresolved.join('\n'));}},_DOMReady:function(){if(!ig.modules['dom.ready'].loaded){if(!document.body){return setTimeout(ig._DOMReady,13);}
ig.modules['dom.ready'].loaded=true;ig._waitForOnload--;ig._execModules();}
return 0;},_boot:function(){if(document.location.href.match(/\?nocache/)){ig.setNocache(true);}
ig.ua.pixelRatio=window.devicePixelRatio||1;ig.ua.viewport={width:window.innerWidth,height:window.innerHeight};ig.ua.screen={width:window.screen.availWidth*ig.ua.pixelRatio,height:window.screen.availHeight*ig.ua.pixelRatio};ig.ua.iPhone=/iPhone/i.test(navigator.userAgent);ig.ua.iPhone4=(ig.ua.iPhone&&ig.ua.pixelRatio==2);ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.winPhone;ig.ua.touchDevice=(('ontouchstart'in window)||(window.navigator.msMaxTouchPoints));},_initDOMReady:function(){if(ig.modules['dom.ready']){ig._execModules();return;}
ig._boot();ig.modules['dom.ready']={requires:[],loaded:false,body:null};ig._waitForOnload++;if(document.readyState==='complete'){ig._DOMReady();}
else{document.addEventListener('DOMContentLoaded',ig._DOMReady,false);window.addEventListener('load',ig._DOMReady,false);}}};ig.normalizeVendorAttribute(window,'requestAnimationFrame');if(window.requestAnimationFrame){var next=1,anims={};window.ig.setAnimation=function(callback,element){var current=next++;anims[current]=true;var animate=function(){if(!anims[current]){return;}
window.requestAnimationFrame(animate,element);callback();};window.requestAnimationFrame(animate,element);return current;};window.ig.clearAnimation=function(id){delete anims[id];};}
else{window.ig.setAnimation=function(callback,element){return window.setInterval(callback,1000/60);};window.ig.clearAnimation=function(id){window.clearInterval(id);};}
var initializing=false,fnTest=/xyz/.test(function(){xyz;})?/\bparent\b/:/.*/;window.ig.Class=function(){};var inject=function(prop){var proto=this.prototype;var parent={};for(var name in prop){if(typeof(prop[name])=="function"&&typeof(proto[name])=="function"&&fnTest.test(prop[name])){parent[name]=proto[name];proto[name]=(function(name,fn){return function(){var tmp=this.parent;this.parent=parent[name];var ret=fn.apply(this,arguments);this.parent=tmp;return ret;};})(name,prop[name]);}
else{proto[name]=prop[name];}}};window.ig.Class.extend=function(prop){var parent=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){if(typeof(prop[name])=="function"&&typeof(parent[name])=="function"&&fnTest.test(prop[name])){prototype[name]=(function(name,fn){return function(){var tmp=this.parent;this.parent=parent[name];var ret=fn.apply(this,arguments);this.parent=tmp;return ret;};})(name,prop[name]);}
else{prototype[name]=prop[name];}}
function Class(){if(!initializing){if(this.staticInstantiate){var obj=this.staticInstantiate.apply(this,arguments);if(obj){return obj;}}
for(var p in this){if(typeof(this[p])=='object'){this[p]=ig.copy(this[p]);}}
if(this.init){this.init.apply(this,arguments);}}
return this;}
Class.prototype=prototype;Class.prototype.constructor=Class;Class.extend=window.ig.Class.extend;Class.inject=inject;return Class;};if(window.ImpactMixin){ig.merge(ig,window.ImpactMixin);}})(window);

// lib/impact/impact.js
ig.baked=true;ig.module('impact.impact').requires('dom.ready','impact.loader','impact.system','impact.input','impact.sound').defines(function(){"use strict";ig.main=function(canvasId,gameClass,fps,width,height,scale,loaderClass){ig.system=new ig.System(canvasId,fps,width,height,scale||1);ig.input=new ig.Input();ig.soundManager=new ig.SoundManager();ig.music=new ig.Music();ig.ready=true;var loader=new(loaderClass||ig.Loader)(gameClass,ig.resources);loader.load();};});

// lib/impact/animation.js
ig.baked=true;ig.module('impact.animation').requires('impact.timer','impact.image').defines(function(){"use strict";ig.AnimationSheet=ig.Class.extend({width:8,height:8,image:null,init:function(path,width,height){this.width=width;this.height=height;this.image=new ig.Image(path);}});ig.Animation=ig.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:false,y:false},pivot:{x:0,y:0},frame:0,tile:0,loopCount:0,alpha:1,angle:0,init:function(sheet,frameTime,sequence,stop){this.sheet=sheet;this.pivot={x:sheet.width/2,y:sheet.height/2};this.timer=new ig.Timer();this.frameTime=frameTime;this.sequence=sequence;this.stop=!!stop;this.tile=this.sequence[0];},rewind:function(){this.timer.set();this.loopCount=0;this.tile=this.sequence[0];return this;},gotoFrame:function(f){this.timer.set(this.frameTime*-f);this.update();},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var frameTotal=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(frameTotal/this.sequence.length);if(this.stop&&this.loopCount>0){this.frame=this.sequence.length-1;}
else{this.frame=frameTotal%this.sequence.length;}
this.tile=this.sequence[this.frame];},draw:function(targetX,targetY){var bbsize=Math.max(this.sheet.width,this.sheet.height);if(targetX>ig.system.width||targetY>ig.system.height||targetX+bbsize<0||targetY+bbsize<0){return;}
if(this.alpha!=1){ig.system.context.globalAlpha=this.alpha;}
if(this.angle==0){this.sheet.image.drawTile(targetX,targetY,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y);}
else{ig.system.context.save();ig.system.context.translate(ig.system.getDrawPos(targetX+this.pivot.x),ig.system.getDrawPos(targetY+this.pivot.y));ig.system.context.rotate(this.angle);this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y);ig.system.context.restore();}
if(this.alpha!=1){ig.system.context.globalAlpha=1;}}});});

// lib/impact/entity.js
ig.baked=true;ig.module('impact.entity').requires('impact.animation','impact.impact').defines(function(){"use strict";ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:false,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:false,slopeStanding:{min:(44).toRad(),max:(136).toRad()},init:function(x,y,settings){this.id=++ig.Entity._lastId;this.pos.x=x;this.pos.y=y;ig.merge(this,settings);},addAnim:function(name,frameTime,sequence,stop){if(!this.animSheet){throw('No animSheet to add the animation '+name+' to.');}
var a=new ig.Animation(this.animSheet,frameTime,sequence,stop);this.anims[name]=a;if(!this.currentAnim){this.currentAnim=a;}
return a;},update:function(){this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var mx=this.vel.x*ig.system.tick;var my=this.vel.y*ig.system.tick;var res=ig.game.collisionMap.trace(this.pos.x,this.pos.y,mx,my,this.size.x,this.size.y);this.handleMovementTrace(res);if(this.currentAnim){this.currentAnim.update();}},getNewVelocity:function(vel,accel,friction,max){if(accel){return(vel+accel*ig.system.tick).limit(-max,max);}
else if(friction){var delta=friction*ig.system.tick;if(vel-delta>0){return vel-delta;}
else if(vel+delta<0){return vel+delta;}
else{return 0;}}
return vel.limit(-max,max);},handleMovementTrace:function(res){this.standing=false;if(res.collision.y){if(this.bounciness>0&&Math.abs(this.vel.y)>this.minBounceVelocity){this.vel.y*=-this.bounciness;}
else{if(this.vel.y>0){this.standing=true;}
this.vel.y=0;}}
if(res.collision.x){if(this.bounciness>0&&Math.abs(this.vel.x)>this.minBounceVelocity){this.vel.x*=-this.bounciness;}
else{this.vel.x=0;}}
if(res.collision.slope){var s=res.collision.slope;if(this.bounciness>0){var proj=this.vel.x*s.nx+this.vel.y*s.ny;this.vel.x=(this.vel.x-s.nx*proj*2)*this.bounciness;this.vel.y=(this.vel.y-s.ny*proj*2)*this.bounciness;}
else{var lengthSquared=s.x*s.x+s.y*s.y;var dot=(this.vel.x*s.x+this.vel.y*s.y)/lengthSquared;this.vel.x=s.x*dot;this.vel.y=s.y*dot;var angle=Math.atan2(s.x,s.y);if(angle>this.slopeStanding.min&&angle<this.slopeStanding.max){this.standing=true;}}}
this.pos=res.pos;},draw:function(){if(this.currentAnim){this.currentAnim.draw(this.pos.x-this.offset.x-ig.game._rscreen.x,this.pos.y-this.offset.y-ig.game._rscreen.y);}},kill:function(){ig.game.removeEntity(this);},receiveDamage:function(amount,from){this.health-=amount;if(this.health<=0){this.kill();}},touches:function(other){return!(this.pos.x>=other.pos.x+other.size.x||this.pos.x+this.size.x<=other.pos.x||this.pos.y>=other.pos.y+other.size.y||this.pos.y+this.size.y<=other.pos.y);},distanceTo:function(other){var xd=(this.pos.x+this.size.x/2)-(other.pos.x+other.size.x/2);var yd=(this.pos.y+this.size.y/2)-(other.pos.y+other.size.y/2);return Math.sqrt(xd*xd+yd*yd);},angleTo:function(other){return Math.atan2((other.pos.x+other.size.x/2)-(this.pos.x+this.size.x/2),(other.pos.y+other.size.y/2)-(this.pos.y+this.size.y/2));},angleToCorr:function(other){return Math.atan2((other.pos.y+other.size.y/2)-(this.pos.y+this.size.y/2),(other.pos.x+other.size.x/2)-(this.pos.x+this.size.x/2));},check:function(other){},collideWith:function(other,axis){},ready:function(){}});ig.Entity._lastId=0;ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8};ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3};ig.Entity.checkPair=function(a,b){if(a.checkAgainst&b.type){a.check(b);}
if(b.checkAgainst&a.type){b.check(a);}
if(a.collides&&b.collides&&a.collides+b.collides>ig.Entity.COLLIDES.ACTIVE){ig.Entity.solveCollision(a,b);}};ig.Entity.solveCollision=function(a,b){var weak=null;if(a.collides==ig.Entity.COLLIDES.LITE||b.collides==ig.Entity.COLLIDES.FIXED){weak=a;}
else if(b.collides==ig.Entity.COLLIDES.LITE||a.collides==ig.Entity.COLLIDES.FIXED){weak=b;}
if(a.last.x+a.size.x>b.last.x&&a.last.x<b.last.x+b.size.x){if(a.last.y<b.last.y){ig.Entity.seperateOnYAxis(a,b,weak);}
else{ig.Entity.seperateOnYAxis(b,a,weak);}
a.collideWith(b,'y');b.collideWith(a,'y');}
else if(a.last.y+a.size.y>b.last.y&&a.last.y<b.last.y+b.size.y){if(a.last.x<b.last.x){ig.Entity.seperateOnXAxis(a,b,weak);}
else{ig.Entity.seperateOnXAxis(b,a,weak);}
a.collideWith(b,'x');b.collideWith(a,'x');}};ig.Entity.seperateOnXAxis=function(left,right,weak){var nudge=(left.pos.x+left.size.x-right.pos.x);if(weak){var strong=left===weak?right:left;weak.vel.x=-weak.vel.x*weak.bounciness+strong.vel.x;var resWeak=ig.game.collisionMap.trace(weak.pos.x,weak.pos.y,weak==left?-nudge:nudge,0,weak.size.x,weak.size.y);weak.pos.x=resWeak.pos.x;}
else{var v2=(left.vel.x-right.vel.x)/2;left.vel.x=-v2;right.vel.x=v2;var resLeft=ig.game.collisionMap.trace(left.pos.x,left.pos.y,-nudge/2,0,left.size.x,left.size.y);left.pos.x=Math.floor(resLeft.pos.x);var resRight=ig.game.collisionMap.trace(right.pos.x,right.pos.y,nudge/2,0,right.size.x,right.size.y);right.pos.x=Math.ceil(resRight.pos.x);}};ig.Entity.seperateOnYAxis=function(top,bottom,weak){var nudge=(top.pos.y+top.size.y-bottom.pos.y);if(weak){var strong=top===weak?bottom:top;weak.vel.y=-weak.vel.y*weak.bounciness+strong.vel.y;var nudgeX=0;if(weak==top&&Math.abs(weak.vel.y-strong.vel.y)<weak.minBounceVelocity){weak.standing=true;nudgeX=strong.vel.x*ig.system.tick;}
var resWeak=ig.game.collisionMap.trace(weak.pos.x,weak.pos.y,nudgeX,weak==top?-nudge:nudge,weak.size.x,weak.size.y);weak.pos.y=resWeak.pos.y;weak.pos.x=resWeak.pos.x;}
else if(ig.game.gravity&&(bottom.standing||top.vel.y>0)){var resTop=ig.game.collisionMap.trace(top.pos.x,top.pos.y,0,-(top.pos.y+top.size.y-bottom.pos.y),top.size.x,top.size.y);top.pos.y=resTop.pos.y;if(top.bounciness>0&&top.vel.y>top.minBounceVelocity){top.vel.y*=-top.bounciness;}
else{top.standing=true;top.vel.y=0;}}
else{var v2=(top.vel.y-bottom.vel.y)/2;top.vel.y=-v2;bottom.vel.y=v2;var nudgeX=bottom.vel.x*ig.system.tick;var resTop=ig.game.collisionMap.trace(top.pos.x,top.pos.y,nudgeX,-nudge/2,top.size.x,top.size.y);top.pos.y=resTop.pos.y;var resBottom=ig.game.collisionMap.trace(bottom.pos.x,bottom.pos.y,0,nudge/2,bottom.size.x,bottom.size.y);bottom.pos.y=resBottom.pos.y;}};});

// lib/impact/map.js
ig.baked=true;ig.module('impact.map').defines(function(){"use strict";ig.Map=ig.Class.extend({tilesize:8,width:1,height:1,data:[[]],name:null,init:function(tilesize,data){this.tilesize=tilesize;this.data=data;this.height=data.length;this.width=data[0].length;},getTile:function(x,y){var tx=Math.floor(x/this.tilesize);var ty=Math.floor(y/this.tilesize);if((tx>=0&&tx<this.width)&&(ty>=0&&ty<this.height)){return this.data[ty][tx];}
else{return 0;}},setTile:function(x,y,tile){var tx=Math.floor(x/this.tilesize);var ty=Math.floor(y/this.tilesize);if((tx>=0&&tx<this.width)&&(ty>=0&&ty<this.height)){this.data[ty][tx]=tile;}}});});

// lib/impact/collision-map.js
ig.baked=true;ig.module('impact.collision-map').requires('impact.map').defines(function(){"use strict";ig.CollisionMap=ig.Map.extend({lastSlope:1,tiledef:null,init:function(tilesize,data,tiledef){this.parent(tilesize,data);this.tiledef=tiledef||ig.CollisionMap.defaultTileDef;for(var t in this.tiledef){if(t|0>this.lastSlope){this.lastSlope=t|0;}}},trace:function(x,y,vx,vy,objectWidth,objectHeight){var res={collision:{x:false,y:false,slope:false},pos:{x:x,y:y},tile:{x:0,y:0}};var steps=Math.ceil(Math.max(Math.abs(vx),Math.abs(vy))/this.tilesize);if(steps>1){var sx=vx/steps;var sy=vy/steps;for(var i=0;i<steps&&(sx||sy);i++){this._traceStep(res,x,y,sx,sy,objectWidth,objectHeight,vx,vy,i);x=res.pos.x;y=res.pos.y;if(res.collision.x){sx=0;vx=0;}
if(res.collision.y){sy=0;vy=0;}
if(res.collision.slope){break;}}}
else{this._traceStep(res,x,y,vx,vy,objectWidth,objectHeight,vx,vy,0);}
return res;},_traceStep:function(res,x,y,vx,vy,width,height,rvx,rvy,step){res.pos.x+=vx;res.pos.y+=vy;var t=0;if(vx){var pxOffsetX=(vx>0?width:0);var tileOffsetX=(vx<0?this.tilesize:0);var firstTileY=Math.max(Math.floor(y/this.tilesize),0);var lastTileY=Math.min(Math.ceil((y+height)/this.tilesize),this.height);var tileX=Math.floor((res.pos.x+pxOffsetX)/this.tilesize);var prevTileX=Math.floor((x+pxOffsetX)/this.tilesize);if(step>0||tileX==prevTileX||prevTileX<0||prevTileX>=this.width){prevTileX=-1;}
if(tileX>=0&&tileX<this.width){for(var tileY=firstTileY;tileY<lastTileY;tileY++){if(prevTileX!=-1){t=this.data[tileY][prevTileX];if(t>1&&t<=this.lastSlope&&this._checkTileDef(res,t,x,y,rvx,rvy,width,height,prevTileX,tileY)){break;}}
t=this.data[tileY][tileX];if(t==1||t>this.lastSlope||(t>1&&this._checkTileDef(res,t,x,y,rvx,rvy,width,height,tileX,tileY))){if(t>1&&t<=this.lastSlope&&res.collision.slope){break;}
res.collision.x=true;res.tile.x=t;x=res.pos.x=tileX*this.tilesize-pxOffsetX+tileOffsetX;rvx=0;break;}}}}
if(vy){var pxOffsetY=(vy>0?height:0);var tileOffsetY=(vy<0?this.tilesize:0);var firstTileX=Math.max(Math.floor(res.pos.x/this.tilesize),0);var lastTileX=Math.min(Math.ceil((res.pos.x+width)/this.tilesize),this.width);var tileY=Math.floor((res.pos.y+pxOffsetY)/this.tilesize);var prevTileY=Math.floor((y+pxOffsetY)/this.tilesize);if(step>0||tileY==prevTileY||prevTileY<0||prevTileY>=this.height){prevTileY=-1;}
if(tileY>=0&&tileY<this.height){for(var tileX=firstTileX;tileX<lastTileX;tileX++){if(prevTileY!=-1){t=this.data[prevTileY][tileX];if(t>1&&t<=this.lastSlope&&this._checkTileDef(res,t,x,y,rvx,rvy,width,height,tileX,prevTileY)){break;}}
t=this.data[tileY][tileX];if(t==1||t>this.lastSlope||(t>1&&this._checkTileDef(res,t,x,y,rvx,rvy,width,height,tileX,tileY))){if(t>1&&t<=this.lastSlope&&res.collision.slope){break;}
res.collision.y=true;res.tile.y=t;res.pos.y=tileY*this.tilesize-pxOffsetY+tileOffsetY;break;}}}}},_checkTileDef:function(res,t,x,y,vx,vy,width,height,tileX,tileY){var def=this.tiledef[t];if(!def){return false;}
var lx=(tileX+def[0])*this.tilesize,ly=(tileY+def[1])*this.tilesize,lvx=(def[2]-def[0])*this.tilesize,lvy=(def[3]-def[1])*this.tilesize,solid=def[4];var tx=x+vx+(lvy<0?width:0)-lx,ty=y+vy+(lvx>0?height:0)-ly;if(lvx*ty-lvy*tx>0){if(vx*-lvy+vy*lvx<0){return solid;}
var length=Math.sqrt(lvx*lvx+lvy*lvy);var nx=lvy/length,ny=-lvx/length;var proj=tx*nx+ty*ny;var px=nx*proj,py=ny*proj;if(px*px+py*py>=vx*vx+vy*vy){return solid||(lvx*(ty-vy)-lvy*(tx-vx)<0.5);}
res.pos.x=x+vx-px;res.pos.y=y+vy-py;res.collision.slope={x:lvx,y:lvy,nx:nx,ny:ny};return true;}
return false;}});var H=1/2,N=1/3,M=2/3,SOLID=true,NON_SOLID=false;ig.CollisionMap.defaultTileDef={5:[0,1,1,M,SOLID],6:[0,M,1,N,SOLID],7:[0,N,1,0,SOLID],3:[0,1,1,H,SOLID],4:[0,H,1,0,SOLID],2:[0,1,1,0,SOLID],10:[H,1,1,0,SOLID],21:[0,1,H,0,SOLID],32:[M,1,1,0,SOLID],43:[N,1,M,0,SOLID],54:[0,1,N,0,SOLID],27:[0,0,1,N,SOLID],28:[0,N,1,M,SOLID],29:[0,M,1,1,SOLID],25:[0,0,1,H,SOLID],26:[0,H,1,1,SOLID],24:[0,0,1,1,SOLID],11:[0,0,H,1,SOLID],22:[H,0,1,1,SOLID],33:[0,0,N,1,SOLID],44:[N,0,M,1,SOLID],55:[M,0,1,1,SOLID],16:[1,N,0,0,SOLID],17:[1,M,0,N,SOLID],18:[1,1,0,M,SOLID],14:[1,H,0,0,SOLID],15:[1,1,0,H,SOLID],13:[1,1,0,0,SOLID],8:[H,1,0,0,SOLID],19:[1,1,H,0,SOLID],30:[N,1,0,0,SOLID],41:[M,1,N,0,SOLID],52:[1,1,M,0,SOLID],38:[1,M,0,1,SOLID],39:[1,N,0,M,SOLID],40:[1,0,0,N,SOLID],36:[1,H,0,1,SOLID],37:[1,0,0,H,SOLID],35:[1,0,0,1,SOLID],9:[1,0,H,1,SOLID],20:[H,0,0,1,SOLID],31:[1,0,M,1,SOLID],42:[M,0,N,1,SOLID],53:[N,0,0,1,SOLID],12:[0,0,1,0,NON_SOLID],23:[1,1,0,1,NON_SOLID],34:[1,0,1,1,NON_SOLID],45:[0,1,0,0,NON_SOLID]};ig.CollisionMap.staticNoCollision={trace:function(x,y,vx,vy){return{collision:{x:false,y:false,slope:false},pos:{x:x+vx,y:y+vy},tile:{x:0,y:0}};}};});

// lib/impact/background-map.js
ig.baked=true;ig.module('impact.background-map').requires('impact.map','impact.image').defines(function(){"use strict";ig.BackgroundMap=ig.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:false,tilesetName:'',foreground:false,enabled:true,preRender:false,preRenderedChunks:null,chunkSize:512,debugChunks:false,anims:{},init:function(tilesize,data,tileset){this.parent(tilesize,data);this.setTileset(tileset);},setTileset:function(tileset){this.tilesetName=tileset instanceof ig.Image?tileset.path:tileset;this.tiles=new ig.Image(this.tilesetName);this.preRenderedChunks=null;},setScreenPos:function(x,y){this.scroll.x=x/this.distance;this.scroll.y=y/this.distance;},preRenderMapToChunks:function(){var totalWidth=this.width*this.tilesize*ig.system.scale,totalHeight=this.height*this.tilesize*ig.system.scale;this.chunkSize=Math.min(Math.max(totalWidth,totalHeight),this.chunkSize);var chunkCols=Math.ceil(totalWidth/this.chunkSize),chunkRows=Math.ceil(totalHeight/this.chunkSize);this.preRenderedChunks=[];for(var y=0;y<chunkRows;y++){this.preRenderedChunks[y]=[];for(var x=0;x<chunkCols;x++){var chunkWidth=(x==chunkCols-1)?totalWidth-x*this.chunkSize:this.chunkSize;var chunkHeight=(y==chunkRows-1)?totalHeight-y*this.chunkSize:this.chunkSize;this.preRenderedChunks[y][x]=this.preRenderChunk(x,y,chunkWidth,chunkHeight);}}},preRenderChunk:function(cx,cy,w,h){var tw=w/this.tilesize/ig.system.scale+1,th=h/this.tilesize/ig.system.scale+1;var nx=(cx*this.chunkSize/ig.system.scale)%this.tilesize,ny=(cy*this.chunkSize/ig.system.scale)%this.tilesize;var tx=Math.floor(cx*this.chunkSize/this.tilesize/ig.system.scale),ty=Math.floor(cy*this.chunkSize/this.tilesize/ig.system.scale);var chunk=ig.$new('canvas');chunk.width=w;chunk.height=h;var oldContext=ig.system.context;ig.system.context=chunk.getContext("2d");for(var x=0;x<tw;x++){for(var y=0;y<th;y++){if(x+tx<this.width&&y+ty<this.height){var tile=this.data[y+ty][x+tx];if(tile){this.tiles.drawTile(x*this.tilesize-nx,y*this.tilesize-ny,tile-1,this.tilesize);}}}}
ig.system.context=oldContext;return chunk;},draw:function(){if(!this.tiles.loaded||!this.enabled){return;}
if(this.preRender){this.drawPreRendered();}
else{this.drawTiled();}},drawPreRendered:function(){if(!this.preRenderedChunks){this.preRenderMapToChunks();}
var dx=ig.system.getDrawPos(this.scroll.x),dy=ig.system.getDrawPos(this.scroll.y);if(this.repeat){var w=this.width*this.tilesize*ig.system.scale;dx=(dx%w+w)%w;var h=this.height*this.tilesize*ig.system.scale;dy=(dy%h+h)%h;}
var minChunkX=Math.max(Math.floor(dx/this.chunkSize),0),minChunkY=Math.max(Math.floor(dy/this.chunkSize),0),maxChunkX=Math.ceil((dx+ig.system.realWidth)/this.chunkSize),maxChunkY=Math.ceil((dy+ig.system.realHeight)/this.chunkSize),maxRealChunkX=this.preRenderedChunks[0].length,maxRealChunkY=this.preRenderedChunks.length;if(!this.repeat){maxChunkX=Math.min(maxChunkX,maxRealChunkX);maxChunkY=Math.min(maxChunkY,maxRealChunkY);}
var nudgeY=0;for(var cy=minChunkY;cy<maxChunkY;cy++){var nudgeX=0;for(var cx=minChunkX;cx<maxChunkX;cx++){var chunk=this.preRenderedChunks[cy%maxRealChunkY][cx%maxRealChunkX];var x=-dx+cx*this.chunkSize-nudgeX;var y=-dy+cy*this.chunkSize-nudgeY;ig.system.context.drawImage(chunk,x,y);ig.Image.drawCount++;if(this.debugChunks){ig.system.context.strokeStyle='#f0f';ig.system.context.strokeRect(x,y,this.chunkSize,this.chunkSize);}
if(this.repeat&&chunk.width<this.chunkSize&&x+chunk.width<ig.system.realWidth){nudgeX+=this.chunkSize-chunk.width;maxChunkX++;}}
if(this.repeat&&chunk.height<this.chunkSize&&y+chunk.height<ig.system.realHeight){nudgeY+=this.chunkSize-chunk.height;maxChunkY++;}}},drawTiled:function(){var tile=0,anim=null,tileOffsetX=(this.scroll.x/this.tilesize).toInt(),tileOffsetY=(this.scroll.y/this.tilesize).toInt(),pxOffsetX=this.scroll.x%this.tilesize,pxOffsetY=this.scroll.y%this.tilesize,pxMinX=-pxOffsetX-this.tilesize,pxMinY=-pxOffsetY-this.tilesize,pxMaxX=ig.system.width+this.tilesize-pxOffsetX,pxMaxY=ig.system.height+this.tilesize-pxOffsetY;for(var mapY=-1,pxY=pxMinY;pxY<pxMaxY;mapY++,pxY+=this.tilesize){var tileY=mapY+tileOffsetY;if(tileY>=this.height||tileY<0){if(!this.repeat){continue;}
tileY=(tileY%this.height+this.height)%this.height;}
for(var mapX=-1,pxX=pxMinX;pxX<pxMaxX;mapX++,pxX+=this.tilesize){var tileX=mapX+tileOffsetX;if(tileX>=this.width||tileX<0){if(!this.repeat){continue;}
tileX=(tileX%this.width+this.width)%this.width;}
if((tile=this.data[tileY][tileX])){if((anim=this.anims[tile-1])){anim.draw(pxX,pxY);}
else{this.tiles.drawTile(pxX,pxY,tile-1,this.tilesize);}}}}}});});﻿


// lib/plugins/timeslower.js
ig.baked=true;ig.module('plugins.timeslower').requires('impact.system').defines(function(){Supertimer=ig.Class.extend({target:0,base:0,last:0,init:function(seconds){this.base=Supertimer.time;this.last=Supertimer.time;this.target=seconds||0;},set:function(seconds){this.target=seconds||0;this.base=Supertimer.time;},reset:function(){this.base=Supertimer.time;},tick:function(){var delta=Supertimer.time-this.last;this.last=Supertimer.time;return delta;},delta:function(){return Supertimer.time-this.base-this.target;}});Supertimer._last=0;Supertimer.time=0;Supertimer.maxStep=0.05;Supertimer.step=function(){var current=Date.now();var delta=(current-Supertimer._last)/1000;Supertimer.time+=Math.min(delta,Supertimer.maxStep);Supertimer._last=current;};ig.System.inject({run:function(){ig.Timer.step();Supertimer.step();this.tick=this.clock.tick();this.delegate.run();ig.input.clearPressed();if(this.newGameClass){this.setGameNow(this.newGameClass);this.newGameClass=null;}}});TimeSlower=ig.Class.extend({currentTimeScale:1,timeScaleHolder:1,changedTimer:null,changedTime:0,constantDuration:0,slowingDownDuration:0,returnToNormalDuration:0,slowingDown:false,constant:false,returningToNormal:false,segmentStartValue:0,segmentEndValue:0,update:function(){if(this.slowingDown==true){if(this.changedTimer&&this.changedTimer.delta()<0){ig.Timer.timeScale=this.changedTimer.delta().map(-this.slowingDownDuration,0,1,this.timeScaleHolder);}
else if(this.changedTimer&&this.changedTimer.delta()>=0){this.slowingDown=false;this.constant=true;this.changedTimer.set(this.constantDuration);ig.Timer.timeScale=this.timeScaleHolder;}}
if(this.constant==true){if(this.changedTimer&&this.changedTimer.delta()>=0){this.constant=false;this.returningToNormal=true;this.changedTimer.set(this.returnToNormalDuration);ig.Timer.timeScale=this.timeScaleHolder;}}
if(this.returningToNormal==true){if(this.changedTimer&&this.changedTimer.delta()<0){ig.Timer.timeScale=this.changedTimer.delta().map(-this.returnToNormalDuration,0,this.timeScaleHolder,1);}
else if(this.changedTimer&&this.changedTimer.delta()>=0){ig.Timer.timeScale=1;this.returningToNormal=false;this.constant=false;this.slowingDown=false;}}},alterTimeScale:function(timescale,slowingDownDuration,constantDuration,returnToNormalDuration){if(ig.Timer.timeScale==1){this.timeScaleHolder=timescale;this.slowingDownDuration=slowingDownDuration;this.constantDuration=constantDuration;this.returnToNormalDuration=returnToNormalDuration;this.changedTime=slowingDownDuration;this.changedTimer=new Supertimer(slowingDownDuration);this.slowingDown=true;}}});});

// lib/impact/game.js
ig.baked=true;ig.module('impact.game').requires('impact.impact','impact.entity','impact.collision-map','impact.background-map','plugins.timeslower').defines(function(){"use strict";ig.Game=ig.Class.extend({clearColor:'#000000',gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:ig.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:false,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:false,bActivateTouchControls:false,stats:{kills:0,deaths:0,lives:4,maxLives:4},bulletTime:{current:4,max:4},companions:{current:0,max:2},turrets:{current:4,max:4},enemies:{current:0,max:5},missiles:{current:10,max:10},spawnTime:{min:2,max:7},chanceToSpawnPickups:{min:1,max:5},resetStats:function(difficulty){switch(difficulty){case'EASY':this.stats.kills=0;this.stats.lives=4;this.stats.maxLives=4;this.bulletTime.current=4;this.bulletTime.max=4;this.companions.current=0;this.companions.max=2;this.turrets.current=4;this.turrets.max=4;this.enemies.current=0;this.enemies.max=4;this.bossSpawnKills=15;this.missiles.current=20;this.missiles.max=20;this.spawnTime.min=3;this.spawnTime.max=7;this.chanceToSpawnPickups.min=1;this.chanceToSpawnPickups.max=2
break;case'NORMAL':this.stats.kills=0;this.stats.lives=4;this.stats.maxLives=4;this.bulletTime.current=4;this.bulletTime.max=4;this.companions.current=0;this.companions.max=2;this.turrets.current=4;this.turrets.max=5;this.enemies.current=0;this.enemies.max=5;this.bossSpawnKills=20;this.missiles.current=15;this.missiles.max=15;this.spawnTime.min=2;this.spawnTime.max=5;this.chanceToSpawnPickups.min=1;this.chanceToSpawnPickups.max=3
break;case'HARD':this.stats.kills=0;this.stats.lives=3;this.stats.maxLives=4;this.bulletTime.current=4;this.bulletTime.max=4;this.companions.current=0;this.companions.max=3;this.turrets.current=4;this.turrets.max=4;this.enemies.current=0;this.enemies.max=8;this.bossSpawnKills=40;this.missiles.current=10;this.missiles.max=10;this.spawnTime.min=1;this.spawnTime.max=3;this.chanceToSpawnPickups.min=1;this.chanceToSpawnPickups.max=3
break;}},staticInstantiate:function(){this.sortBy=this.sortBy||ig.Game.SORT.Z_INDEX;ig.game=this;return null;},loadLevel:function(data){this.screen={x:0,y:0};this.entities=[];this.namedEntities={};for(var i=0;i<data.entities.length;i++){var ent=data.entities[i];this.spawnEntity(ent.type,ent.x,ent.y,ent.settings);}
this.sortEntities();this.collisionMap=ig.CollisionMap.staticNoCollision;this.backgroundMaps=[];for(var i=0;i<data.layer.length;i++){var ld=data.layer[i];if(ld.name=='collision'){this.collisionMap=new ig.CollisionMap(ld.tilesize,ld.data);}
else{var newMap=new ig.BackgroundMap(ld.tilesize,ld.data,ld.tilesetName);newMap.anims=this.backgroundAnims[ld.tilesetName]||{};newMap.repeat=ld.repeat;newMap.distance=ld.distance;newMap.foreground=!!ld.foreground;newMap.preRender=!!ld.preRender;newMap.name=ld.name;this.backgroundMaps.push(newMap);}}
for(var i=0;i<this.entities.length;i++){this.entities[i].ready();}},loadLevelDeferred:function(data){this._levelToLoad=data;},getMapByName:function(name){if(name=='collision'){return this.collisionMap;}
for(var i=0;i<this.backgroundMaps.length;i++){if(this.backgroundMaps[i].name==name){return this.backgroundMaps[i];}}
return null;},getEntityByName:function(name){return this.namedEntities[name];},getEntitiesByType:function(type){var entityClass=typeof(type)==='string'?ig.global[type]:type;var a=[];for(var i=0;i<this.entities.length;i++){var ent=this.entities[i];if(ent instanceof entityClass&&!ent._killed){a.push(ent);}}
return a;},spawnEntity:function(type,x,y,settings){var entityClass=typeof(type)==='string'?ig.global[type]:type;if(!entityClass){throw("Can't spawn entity of type "+type);}
var ent=new(entityClass)(x,y,settings||{});this.entities.push(ent);if(ent.name){this.namedEntities[ent.name]=ent;}
return ent;},sortEntities:function(){this.entities.sort(this.sortBy);},sortEntitiesDeferred:function(){this._doSortEntities=true;},removeEntity:function(ent){if(ent.name){delete this.namedEntities[ent.name];}
ent._killed=true;ent.type=ig.Entity.TYPE.NONE;ent.checkAgainst=ig.Entity.TYPE.NONE;ent.collides=ig.Entity.COLLIDES.NEVER;this._deferredKill.push(ent);},run:function(){this.update();this.draw();},update:function(){if(this._levelToLoad){this.loadLevel(this._levelToLoad);this._levelToLoad=null;}
if(this._doSortEntities||this.autoSort){this.sortEntities();this._doSortEntities=false;}
this.updateEntities();this.checkEntities();for(var i=0;i<this._deferredKill.length;i++){this.entities.erase(this._deferredKill[i]);}
this._deferredKill=[];for(var tileset in this.backgroundAnims){var anims=this.backgroundAnims[tileset];for(var a in anims){anims[a].update();}}
if(this.myTimeSlower){this.myTimeSlower.update();}},updateEntities:function(){for(var i=0;i<this.entities.length;i++){var ent=this.entities[i];if(!ent._killed){ent.update();}}},draw:function(){if(this.clearColor){ig.system.clear(this.clearColor);}
this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale;this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;var mapIndex;for(mapIndex=0;mapIndex<this.backgroundMaps.length;mapIndex++){var map=this.backgroundMaps[mapIndex];if(map.foreground){break;}
map.setScreenPos(this.screen.x,this.screen.y);map.draw();}
this.drawEntities();for(mapIndex;mapIndex<this.backgroundMaps.length;mapIndex++){var map=this.backgroundMaps[mapIndex];map.setScreenPos(this.screen.x,this.screen.y);map.draw();}},drawEntities:function(){for(var i=0;i<this.entities.length;i++){this.entities[i].draw();}},checkEntities:function(){var hash={};for(var e=0;e<this.entities.length;e++){var entity=this.entities[e];if(entity.type==ig.Entity.TYPE.NONE&&entity.checkAgainst==ig.Entity.TYPE.NONE&&entity.collides==ig.Entity.COLLIDES.NEVER){continue;}
var checked={},xmin=Math.floor(entity.pos.x/this.cellSize),ymin=Math.floor(entity.pos.y/this.cellSize),xmax=Math.floor((entity.pos.x+entity.size.x)/this.cellSize)+1,ymax=Math.floor((entity.pos.y+entity.size.y)/this.cellSize)+1;for(var x=xmin;x<xmax;x++){for(var y=ymin;y<ymax;y++){if(!hash[x]){hash[x]={};hash[x][y]=[entity];}
else if(!hash[x][y]){hash[x][y]=[entity];}
else{var cell=hash[x][y];for(var c=0;c<cell.length;c++){if(entity.touches(cell[c])&&!checked[cell[c].id]){checked[cell[c].id]=true;ig.Entity.checkPair(entity,cell[c]);}}
cell.push(entity);}}}}}});ig.Game.SORT={Z_INDEX:function(a,b){return a.zIndex-b.zIndex;},POS_X:function(a,b){return(a.pos.x+a.size.x)-(b.pos.x+b.size.x);},POS_Y:function(a,b){return(a.pos.y+a.size.y)-(b.pos.y+b.size.y);}};});

// lib/impact/gaPooling.js
ig.baked=true;ig.module('impact.gaPooling').requires('impact.impact','impact.entity').defines(function(){"use strict";window.ga=(window.ga)?ga:{};Object.defineProperty(Function.prototype,'setupPool',{value:setupPool});Object.defineProperty(Function.prototype,'init',{value:null,configurable:true,writable:true});function setupPool(newPoolSize){if(!(newPoolSize>0))throw('setupPool takes a size > 0 as argument.');this.pool=this.pool||[];this.poolSize=this.poolSize||0;this.pnew=pnew;Object.defineProperty(this.prototype,'pdispose',{value:pdispose});while(this.poolSize<newPoolSize){(new this()).pdispose();}
if(this.poolSize>newPoolSize){this.poolSize=newPoolSize;this.pool.length=newPoolSize;}}
function pnew(){var pnewObj=null;if(this.poolSize!==0){this.poolSize--;pnewObj=this.pool[this.poolSize];this.pool[this.poolSize]=null;}else{pnewObj=new this();}
if(pnewObj.init){pnewObj.init.apply(pnewObj,arguments);}
else this.apply(pnewObj,arguments);return pnewObj;}
function pdispose(){var thisCttr=this.constructor;if(this.dispose)this.dispose();thisCttr.pool[thisCttr.poolSize++]=this;}
ga.autoPoolEntities=function(){var EntityKill=ig.Entity.prototype.kill;ig.Entity.prototype.kill=function(){if(this.pdispose){this.pdispose();}
ig.game.removeEntity(this);};var spawnEntity=ig.Game.prototype.spawnEntity;ig.Game.prototype.spawnEntity=function(type,x,y,settings){if(!type){throw('cannot spawn entity of undefined type');}
type=(typeof(type)==='string')?ig.global[type]:type;var ent=null;if(type.pnew){ent=type.pnew(x,y,settings);ent._killed=false;var pr=ent.__proto__;ent.type=pr.type;ent.checkAgainst=pr.checkAgainst;ent.collides=pr.collides;}else{ent=new(type)(x,y,settings);}
this.entities.push(ent);if(ent.name){this.namedEntities[ent.name]=ent;}
return ent;};};});﻿
﻿


// lib/plugins/texture-atlas.js
ig.baked=true;ig.module('plugins.texture-atlas').requires('impact.animation','impact.image','impact.entity').defines(function(){"use strict";ig.Entity.inject({addTextureAtlasAnim:function(textureAtlas,name,frameTime,sequence,stop,maintainFrameOffset){if(!textureAtlas)
throw('No texture atlas to add the animation from!');if(!name)
throw('No name to call the animation!');var a=new ig.TextureAtlasAnimation(textureAtlas,frameTime,sequence,stop,maintainFrameOffset);this.anims[name]=a;if(!this.currentAnim){this.currentAnim=a;}
return a;}});ig.TextureAtlas=ig.Image.extend({jsonData:null,frameCache:[],load:function(loadCallback){if(this.loaded){if(loadCallback){loadCallback(this.path,true);}
return;}
else if(!this.loaded&&ig.ready){this.loadCallback=loadCallback||null;var url=ig.prefix+(this.path.substr(0,this.path.lastIndexOf('.'))||this.path)+'.txt';var AJAX=null;if(window.XMLHttpRequest){AJAX=new XMLHttpRequest();}else{AJAX=new ActiveXObject("Microsoft.XMLHTTP");}
if(AJAX){AJAX.open('get',url,false);AJAX.send(null);try{this.jsonData=JSON.parse(AJAX.responseText);}catch(error){}}else throw('TextureAtlas Exception: AJAX not supported!');this.data=new Image();this.data.onload=this.onload.bind(this);this.data.onerror=this.onerror.bind(this);this.data.src=ig.prefix+this.path+ig.nocache;}
else{ig.addResource(this);}
ig.Image.cache[this.path]=this;},getFrameData:function(frame){if(typeof this.frameCache[frame]!="undefined")
return this.frameCache[frame];for(var i=0;i<this.jsonData.frames.length;i++){if(this.jsonData.frames[i].filename==frame){this.frameCache[frame]=this.jsonData.frames[i];return this.frameCache[frame];}}
throw('TextureAtlas Exception: frame ['+frame+'] does not exist!');},getWidth:function(){return this.jsonData.meta.size.w;},getHeight:function(){return this.jsonData.meta.size.h;},drawFrame:function(frame,targetX,targetY,maintainFrameOffset,width,height){var frameData=this.getFrameData(frame);var x=targetX;var y=targetY;var w=(width==null)?frameData.frame.w:width;var h=(height==null)?frameData.frame.h:height;if(frameData.trimmed&&maintainFrameOffset){x+=frameData.spriteSourceSize.x;y+=frameData.spriteSourceSize.y;}
this.draw(x,y,frameData.frame.x,frameData.frame.y,w,h);}});ig.TextureAtlasAnimation=ig.Animation.extend({textureAtlas:null,maintainFrameOffset:false,frameData:0,init:function(textureAtlas,frameTime,sequence,stop,maintainFrameOffset){this.textureAtlas=textureAtlas;this.timer=new ig.Timer();this.frameTime=frameTime;this.sequence=sequence;this.frameData=this.textureAtlas.getFrameData(this.sequence[0]);this.stop=!!stop;if(maintainFrameOffset)
this.maintainFrameOffset=maintainFrameOffset;},rewind:function(){this.timer.reset();this.loopCount=0;this.frameData=this.textureAtlas.getFrameData(this.sequence[0]);return this;},update:function(){var frameTotal=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(frameTotal/this.sequence.length);if(this.stop&&this.loopCount>0){this.frame=this.sequence.length-1;}
else{this.frame=frameTotal%this.sequence.length;}
this.frameData=this.textureAtlas.getFrameData(this.sequence[this.frame]);},draw:function(targetX,targetY){var bbsize=Math.max(this.textureAtlas.width,this.textureAtlas.height);var x=targetX;var y=targetY;if(this.frameData.trimmed&&this.maintainFrameOffset){x+=this.frameData.spriteSourceSize.x;y+=this.frameData.spriteSourceSize.y;}
if(x>ig.system.width||y>ig.system.height||x+bbsize<0||y+bbsize<0){return;}
if(this.alpha!=1){ig.system.context.globalAlpha=this.alpha;}
var halfWidth=this.frameData.frame.w/2;var halfHeight=this.frameData.frame.h/2;ig.system.context.save();ig.system.context.translate(ig.system.getDrawPos(x+halfWidth),ig.system.getDrawPos(y+halfHeight));ig.system.context.rotate(this.angle);var scaleX=this.flip.x?-1:1;var scaleY=this.flip.y?-1:1;if(this.flip.x||this.flip.y){ig.system.context.scale(scaleX,scaleY);}
this.textureAtlas.draw(-halfWidth,-halfHeight,this.frameData.frame.x,this.frameData.frame.y,this.frameData.frame.w,this.frameData.frame.h);ig.system.context.restore();if(this.alpha!=1){ig.system.context.globalAlpha=1;}}});ig.TextureAtlasImage=ig.Image.extend({textureAtlas:null,frameName:null,maintainFrameOffset:false,init:function(textureAtlas,frameName,maintainFrameOffset){this.frameName=frameName;this.textureAtlas=textureAtlas;var frameData=this.textureAtlas.getFrameData(frameName);this.width=frameData.frame.w;this.height=frameData.frame.h;},draw:function(targetX,targetY){this.textureAtlas.drawFrame(this.frameName,targetX,targetY);}});ig.TextureAtlasFont=ig.Font.extend({textureAtlas:null,spaceWidth:0,init:function(textureAtlas,kerning,spaceWidth){this.textureAtlas=textureAtlas;this.height=this.textureAtlas.jsonData.meta.lineHeight;this.letterSpacing=(typeof kerning=="undefined")?this.textureAtlas.packedTexture.meta.kerning:kerning;this.spaceWidth=(typeof spaceWidth=="undefined")?this.textureAtlas.packedTexture.meta.spaceWidth:spaceWidth;if(typeof this.spaceWidth=="undefined")
this.spaceWidth=0;},_drawChar:function(c,targetX,targetY){if(c==0)
return this.spaceWidth+this.letterSpacing;var frameData=this.textureAtlas.getFrameData(c+this.firstChar);this.textureAtlas.draw(targetX+frameData.frame.sx,targetY+frameData.frame.sy,frameData.frame.x,frameData.frame.y,frameData.frame.w,frameData.frame.h);return frameData.frame.w+this.letterSpacing;},_widthForLine:function(text){var width=0;var frameData;var charW=0;for(var i=0;i<text.length;i++){if(text.charCodeAt(i)==0)
charW=this.spaceWidth+this.letterSpacing;else{charW=this.textureAtlas.getFrameData(text.charCodeAt(i)).frame.w+this.letterSpacing;}
width+=charW;}
return width;},});});

// lib/plugins/packed-textures.js
ig.baked=true;ig.module('plugins.packed-textures').requires('plugins.texture-atlas').defines(function(){ig.PackedTextures=ig.Class.extend({textureAtlas:null,staticInstantiate:function(ignoredFoo){if(ig.PackedTextures.instance==null){return null;}
else{return ig.PackedTextures.instance;}},init:function(){ig.PackedTextures.instance=this;ig.entitiesTextureAtlas=new ig.TextureAtlas("media/textures/entities.png");ig.screensTextureAtlas=new ig.TextureAtlas("media/textures/screens.png");ig.nokia36WhiteShadowTextureAtlas=new ig.TextureAtlas("media/textures/nokia-36-white-shadow.png");ig.nokia24WhiteShadowTextureAtlas=new ig.TextureAtlas("media/textures/nokia-24-white-shadow.png");},});ig.textureData=new ig.PackedTextures();})﻿
﻿


// lib/plugins/ease-pack.js
ig.baked=true;ig.module('plugins.ease-pack').defines(function(){(window._gsQueue||(window._gsQueue=[])).push(function(){_gsDefine("easing.Back",["easing.Ease"],function(g){var c=window.com.greensock._class,b=function(a,l){var b=c("easing."+a,function(){},!0),d=b.prototype=new g;d.constructor=b;d.getRatio=l;return b},h=function(a,l){var b=c("easing."+a,function(a){this._p1=a||0===a?a:1.70158;this._p2=1.525*this._p1},!0),d=b.prototype=new g;d.constructor=b;d.getRatio=l;d.config=function(a){return new b(a)};return b},n=h("BackOut",function(a){return(a-=1)*a*((this._p1+1)*a+this._p1)+1}),o=h("BackIn",function(a){return a*a*((this._p1+1)*a-this._p1)}),h=h("BackInOut",function(a){return 1>(a*=2)?0.5*a*a*((this._p2+1)*a-this._p2):0.5*((a-=2)*a*((this._p2+1)*a+this._p2)+2)}),p=b("BounceOut",function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375}),q=b("BounceIn",function(a){return(a=1-a)<1/2.75?1-7.5625*a*a:a<2/2.75?1-(7.5625*(a-=1.5/2.75)*a+0.75):a<2.5/2.75?1-(7.5625*(a-=2.25/2.75)*a+0.9375):1-(7.5625*(a-=2.625/2.75)*a+0.984375)}),r=b("BounceInOut",function(a){var b=0.5>a,a=b?1-2*a:2*a-1,a=a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375;return b?0.5*(1-a):0.5*a+0.5}),s=b("CircOut",function(a){return Math.sqrt(1-(a-=1)*a)}),t=b("CircIn",function(a){return-(Math.sqrt(1-a*a)-1)}),u=b("CircInOut",function(a){return 1>(a*=2)?-0.5*(Math.sqrt(1-a*a)-1):0.5*(Math.sqrt(1-(a-=2)*a)+1)}),i=2*Math.PI,j=function(a,b,e){var d=c("easing."+a,function(a,b){this._p1=a||1;this._p2=b||e;this._p3=this._p2/i*(Math.asin(1/this._p1)||0)},!0),a=d.prototype=new g;a.constructor=d;a.getRatio=b;a.config=function(a,b){return new d(a,b)};return d},v=j("ElasticOut",function(a){return this._p1*Math.pow(2,-10*a)*Math.sin((a-this._p3)*i/this._p2)+1},0.3),w=j("ElasticIn",function(a){return-(this._p1*Math.pow(2,10*(a-=1))*Math.sin((a-this._p3)*i/this._p2))},0.3),j=j("ElasticInOut",function(a){return 1>(a*=2)?-0.5*this._p1*Math.pow(2,10*(a-=1))*Math.sin((a-this._p3)*i/this._p2):0.5*this._p1*Math.pow(2,-10*(a-=1))*Math.sin((a-this._p3)*i/this._p2)+1},0.45),x=b("ExpoOut",function(a){return 1-Math.pow(2,-10*a)}),y=b("ExpoIn",function(a){return Math.pow(2,10*(a-1))-0.001}),z=b("ExpoInOut",function(a){return 1>(a*=2)?0.5*Math.pow(2,10*(a-1)):0.5*(2-Math.pow(2,-10*(a-1)))}),m=Math.PI/2,A=b("SineOut",function(a){return Math.sin(a*m)}),B=b("SineIn",function(a){return-Math.cos(a*m)+1}),b=b("SineInOut",function(a){return-0.5*(Math.cos(Math.PI*a)-1)}),f=c("easing.SlowMo",function(a,b,c){null==a?a=0.7:1<a&&(a=1);this._p=1!=a?b||0===b?b:0.7:0;this._p1=(1-a)/2;this._p2=a;this._p3=this._p1+this._p2;this._calcEnd=!0===c},!0),e=f.prototype=new g;e.constructor=f;e.getRatio=function(a){var b=a+(0.5-a)*this._p;return a<this._p1?this._calcEnd?1-(a=1-a/this._p1)*a:b-(a=1-a/this._p1)*a*a*a*b:a>this._p3?this._calcEnd?1-(a=(a-this._p3)/this._p1)*a:b+(a-b)*(a=(a-this._p3)/this._p1)*a*a*a:this._calcEnd?1:b};f.ease=new f(0.7,0.7);e.config=f.config=function(a,b,c){return new f(a,b,c)};var k=c("easing.SteppedEase",function(a){a=a||1;this._p1=1/a;this._p2=a+1},!0),e=k.prototype=new g;e.constructor=k;e.getRatio=function(a){0>a?a=0:1<=a&&(a=0.999999999);return(this._p2*a>>0)*this._p1};e.config=k.config=function(a){return new k(a)};c("easing.Bounce",{easeOut:new p,easeIn:new q,easeInOut:new r},!0);c("easing.Circ",{easeOut:new s,easeIn:new t,easeInOut:new u},!0);c("easing.Elastic",{easeOut:new v,easeIn:new w,easeInOut:new j},!0);c("easing.Expo",{easeOut:new x,easeIn:new y,easeInOut:new z},!0);c("easing.Sine",{easeOut:new A,easeIn:new B,easeInOut:new b},!0);return{easeOut:new n,easeIn:new o,easeInOut:new h}},!0)});window._gsDefine&&_gsQueue.pop()();})

// lib/plugins/tween-lite.js
ig.baked=true;ig.module('plugins.tween-lite').requires('plugins.ease-pack').defines(function(){(function(n){var H=function(a){a=a.split(".");var c=n,b;for(b=0;b<a.length;b++)c[a[b]]=c=c[a[b]]||{};return c},m=H("com.greensock"),q,k,d,C,I,x={},D=function(a,c,b,l){this.sc=x[a]?x[a].sc:[];x[a]=this;this.gsClass=null;this.def=b;var e=c||[],d=[];this.check=function(c){for(var f=e.length,h=0,p;-1<--f;)(p=x[e[f]]||new D(e[f])).gsClass?d[f]=p.gsClass:(h++,c&&p.sc.push(this));if(0===h&&b){c=("com.greensock."+a).split(".");var f=c.pop(),k=H(c.join("."))[f]=this.gsClass=b.apply(b,d);l&&((n.GreenSockGlobals||n)[f]=k,"function"===typeof define&&define.amd?define((n.GreenSockAMDPath?n.GreenSockAMDPath+"/":"")+a.split(".").join("/"),[],function(){return k}):"undefined"!==typeof module&&module.exports&&(module.exports=k));for(f=0;f<this.sc.length;f++)this.sc[f].check(!1)}};this.check(!0)},s=m._class=function(a,c,b){c=c||function(){};new D(a,[],function(){return c},b);return c};n._gsDefine=function(a,c,b,l){return new D(a,c,b,l)};var J=[0,0,1,1],E=[],u=s("easing.Ease",function(a,c,b,l){this._func=a;this._type=b||0;this._power=l||0;this._params=c?J.concat(c):J},!0);d=u.prototype;d._calcEnd=!1;d.getRatio=function(a){if(this._func)return this._params[0]=a,this._func.apply(null,this._params);var c=this._type,b=this._power,l=1===c?1-a:2===c?a:0.5>a?2*a:2*(1-a);1===b?l*=l:2===b?l*=l*l:3===b?l*=l*l*l:4===b&&(l*=l*l*l*l);return 1===c?1-l:2===c?l:0.5>a?l/2:1-l/2};q=["Linear","Quad","Cubic","Quart","Quint"];for(k=q.length;-1<--k;)d=s("easing."+q[k],null,!0),C=s("easing.Power"+k,null,!0),d.easeOut=C.easeOut=new u(null,null,1,k),d.easeIn=C.easeIn=new u(null,null,2,k),d.easeInOut=C.easeInOut=new u(null,null,3,k);s("easing.Strong",m.easing.Power4,!0);m.easing.Linear.easeNone=m.easing.Linear.easeIn;var K=s("events.EventDispatcher",function(a){this._listeners={};this._eventTarget=a||this});d=K.prototype;d.addEventListener=function(a,c,b,l,e){e=e||0;var d=this._listeners[a],j=0,f;null==d&&(this._listeners[a]=d=[]);for(f=d.length;-1<--f;)a=d[f],a.c===c?d.splice(f,1):0===j&&a.pr<e&&(j=f+1);d.splice(j,0,{c:c,s:b,up:l,pr:e})};d.removeEventListener=function(a,c){var b=this._listeners[a],l;if(b)for(l=b.length;-1<--l;)if(b[l].c===c){b.splice(l,1);break}};d.dispatchEvent=function(a){var c=this._listeners[a];if(c)for(var b=c.length,l=this._eventTarget,d;-1<--b;)d=c[b],d.up?d.c.call(d.s||l,{type:a,target:l}):d.c.call(d.s||l)};var z=n.requestAnimationFrame,F=n.cancelAnimationFrame,L=Date.now||function(){return(new Date).getTime()};q=["ms","moz","webkit","o"];for(k=q.length;-1<--k&&!z;)z=n[q[k]+"RequestAnimationFrame"],F=n[q[k]+"CancelAnimationFrame"]||n[q[k]+"CancelRequestAnimationFrame"];s("Ticker",function(a,c){var b=this,l=L(),d=!1!==c&&z,g,j,f,h,p,k=function(){null!=f&&(!d||!F?n.clearTimeout(f):F(f),f=null)},m=function(a){b.time=(L()-l)/1E3;if(!g||b.time>=p||!0===a)b.frame++,p=b.time>p?b.time+h-(b.time-p):b.time+h-0.001,p<b.time+0.001&&(p=b.time+0.001),b.dispatchEvent("tick");!0!==a&&(f=j(m))};K.call(b);this.time=this.frame=0;this.tick=function(){m(!0)};this.fps=function(a){if(!arguments.length)return g;g=a;h=1/(g||60);p=this.time+h;j=0===g?function(){}:!d||!z?function(a){return n.setTimeout(a,1E3*(p-b.time)+1>>0||1)}:z;k();f=j(m)};this.useRAF=function(a){if(!arguments.length)return d;k();d=a;b.fps(g)};b.fps(a);n.setTimeout(function(){d&&!f&&b.useRAF(!1)},1E3)});d=m.Ticker.prototype=new m.events.EventDispatcher;d.constructor=m.Ticker;var r=s("core.Animation",function(a,c){this.vars=c||{};this._duration=this._totalDuration=a||0;this._delay=Number(this.vars.delay)||0;this._timeScale=1;this._active=!0===this.vars.immediateRender;this.data=this.vars.data;this._reversed=!0===this.vars.reversed;if(v){I||(t.tick(),I=!0);var b=this.vars.useFrames?y:v;b.insert(this,b._time);this.vars.paused&&this.paused(!0)}}),t=r.ticker=new m.Ticker;d=r.prototype;d._dirty=d._gc=d._initted=d._paused=!1;d._totalTime=d._time=0;d._rawPrevTime=-1;d._next=d._last=d._onUpdate=d._timeline=d.timeline=null;d._paused=!1;d.play=function(a,c){arguments.length&&this.seek(a,c);this.reversed(!1);return this.paused(!1)};d.pause=function(a,c){arguments.length&&this.seek(a,c);return this.paused(!0)};d.resume=function(a,c){arguments.length&&this.seek(a,c);return this.paused(!1)};d.seek=function(a,c){return this.totalTime(Number(a),!1!==c)};d.restart=function(a,c){this.reversed(!1);this.paused(!1);return this.totalTime(a?-this._delay:0,!1!==c)};d.reverse=function(a,c){arguments.length&&this.seek(a||this.totalDuration(),c);this.reversed(!0);return this.paused(!1)};d.render=function(){};d.invalidate=function(){return this};d._enabled=function(a,c){this._gc=!a;this._active=a&&!this._paused&&0<this._totalTime&&this._totalTime<this._totalDuration;!0!==c&&(a&&null==this.timeline?this._timeline.insert(this,this._startTime-this._delay):!a&&null!=this.timeline&&this._timeline._remove(this,!0));return!1};d._kill=function(){return this._enabled(!1,!1)};d.kill=function(a,c){this._kill(a,c);return this};d._uncache=function(a){for(a=a?this:this.timeline;a;)a._dirty=!0,a=a.timeline;return this};d.eventCallback=function(a,c,b,d){if(null==a)return null;if("on"===a.substr(0,2)){if(1===arguments.length)return this.vars[a];if(null==c)delete this.vars[a];else if(this.vars[a]=c,this.vars[a+"Params"]=b,this.vars[a+"Scope"]=d,b)for(var e=b.length;-1<--e;)"{self}"===b[e]&&(b=this.vars[a+"Params"]=b.concat(),b[e]=this);"onUpdate"===a&&(this._onUpdate=c)}
return this};d.delay=function(a){if(!arguments.length)return this._delay;this._timeline.smoothChildTiming&&this.startTime(this._startTime+a-this._delay);this._delay=a;return this};d.duration=function(a){if(!arguments.length)return this._dirty=!1,this._duration;this._duration=this._totalDuration=a;this._uncache(!0);this._timeline.smoothChildTiming&&0<this._time&&this._time<this._duration&&0!==a&&this.totalTime(this._totalTime*(a/this._duration),!0);return this};d.totalDuration=function(a){this._dirty=!1;return!arguments.length?this._totalDuration:this.duration(a)};d.time=function(a,c){if(!arguments.length)return this._time;this._dirty&&this.totalDuration();a>this._duration&&(a=this._duration);return this.totalTime(a,c)};d.totalTime=function(a,c){if(!arguments.length)return this._totalTime;if(this._timeline){0>a&&(a+=this.totalDuration());if(this._timeline.smoothChildTiming&&(this._dirty&&this.totalDuration(),a>this._totalDuration&&(a=this._totalDuration),this._startTime=(this._paused?this._pauseTime:this._timeline._time)-(!this._reversed?a:this._totalDuration-a)/this._timeScale,this._timeline._dirty||this._uncache(!1),!this._timeline._active))for(var b=this._timeline;b._timeline;)b.totalTime(b._totalTime,!0),b=b._timeline;this._gc&&this._enabled(!0,!1);this._totalTime!==a&&this.render(a,c,!1)}
return this};d.startTime=function(a){if(!arguments.length)return this._startTime;a!==this._startTime&&(this._startTime=a,this.timeline&&this.timeline._sortChildren&&this.timeline.insert(this,a-this._delay));return this};d.timeScale=function(a){if(!arguments.length)return this._timeScale;a=a||1E-6;if(this._timeline&&this._timeline.smoothChildTiming){var c=this._pauseTime||0===this._pauseTime?this._pauseTime:this._timeline._totalTime;this._startTime=c-(c-
this._startTime)*this._timeScale/a}
this._timeScale=a;return this._uncache(!1)};d.reversed=function(a){if(!arguments.length)return this._reversed;a!=this._reversed&&(this._reversed=a,this.totalTime(this._totalTime,!0));return this};d.paused=function(a){if(!arguments.length)return this._paused;a!=this._paused&&this._timeline&&(!a&&this._timeline.smoothChildTiming&&(this._startTime+=this._timeline.rawTime()-this._pauseTime,this._uncache(!1)),this._pauseTime=a?this._timeline.rawTime():null,this._paused=a,this._active=!this._paused&&0<this._totalTime&&this._totalTime<this._totalDuration);this._gc&&(a||this._enabled(!0,!1));return this};m=s("core.SimpleTimeline",function(a){r.call(this,0,a);this.autoRemoveChildren=this.smoothChildTiming=!0});d=m.prototype=new r;d.constructor=m;d.kill()._gc=!1;d._first=d._last=null;d._sortChildren=!1;d.insert=function(a,c){a._startTime=Number(c||0)+a._delay;a._paused&&this!==a._timeline&&(a._pauseTime=a._startTime+(this.rawTime()-a._startTime)/a._timeScale);a.timeline&&a.timeline._remove(a,!0);a.timeline=a._timeline=this;a._gc&&a._enabled(!0,!0);var b=this._last;if(this._sortChildren)for(var d=a._startTime;b&&b._startTime>d;)b=b._prev;b?(a._next=b._next,b._next=a):(a._next=this._first,this._first=a);a._next?a._next._prev=a:this._last=a;a._prev=b;this._timeline&&this._uncache(!0);return this};d._remove=function(a,c){a.timeline===this&&(c||a._enabled(!1,!0),a.timeline=null,a._prev?a._prev._next=a._next:this._first===a&&(this._first=a._next),a._next?a._next._prev=a._prev:this._last===a&&(this._last=a._prev),this._timeline&&this._uncache(!0));return this};d.render=function(a,c){var b=this._first,d;for(this._totalTime=this._time=this._rawPrevTime=a;b;){d=b._next;if(b._active||a>=b._startTime&&!b._paused)b._reversed?b.render((!b._dirty?b._totalDuration:b.totalDuration())-(a-b._startTime)*b._timeScale,c,!1):b.render((a-b._startTime)*b._timeScale,c,!1);b=d}};d.rawTime=function(){return this._totalTime};var h=s("TweenLite",function(a,c,b){r.call(this,c,b);if(null==a)throw"Cannot tween an undefined reference.";this.target=a;this._overwrite=null==this.vars.overwrite?M[h.defaultOverwrite]:"number"===typeof this.vars.overwrite?this.vars.overwrite>>0:M[this.vars.overwrite];if((a instanceof Array||a.jquery)&&"object"===typeof a[0]){this._targets=a.slice(0);this._propLookup=[];this._siblings=[];for(a=0;a<this._targets.length;a++)b=this._targets[a],b.jquery?(this._targets.splice(a--,1),this._targets=this._targets.concat(b.constructor.makeArray(b))):(this._siblings[a]=A(b,this,!1),1===this._overwrite&&1<this._siblings[a].length&&G(b,this,null,1,this._siblings[a]))}else this._propLookup={},this._siblings=A(a,this,!1),1===this._overwrite&&1<this._siblings.length&&G(a,this,null,1,this._siblings);(this.vars.immediateRender||0===c&&0===this._delay&&!1!==this.vars.immediateRender)&&this.render(-this._delay,!1,!0)},!0);d=h.prototype=new r;d.constructor=h;d.kill()._gc=!1;d.ratio=0;d._firstPT=d._targets=d._overwrittenProps=null;d._notifyPluginsOfEnabled=!1;h.version=1.668;h.defaultEase=d._ease=new u(null,null,1,1);h.defaultOverwrite="auto";h.ticker=t;var N=h._plugins={},w=h._tweenLookup={},P=0,Q={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,orientToBezier:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1},M={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},y=r._rootFramesTimeline=new m,v=r._rootTimeline=new m;v._startTime=t.time;y._startTime=t.frame;v._active=y._active=!0;r._updateRoot=function(){v.render((t.time-v._startTime)*v._timeScale,!1,!1);y.render((t.frame-y._startTime)*y._timeScale,!1,!1);if(!(t.frame%120)){var a,c,b;for(b in w){c=w[b].tweens;for(a=c.length;-1<--a;)c[a]._gc&&c.splice(a,1);0===c.length&&delete w[b]}}};t.addEventListener("tick",r._updateRoot);var A=function(a,c,b){var d=a._gsTweenID,e;if(!w[d||(a._gsTweenID=d="t"+P++)])w[d]={target:a,tweens:[]};if(c&&(a=w[d].tweens,a[e=a.length]=c,b))for(;-1<--e;)a[e]===c&&a.splice(e,1);return w[d].tweens},G=function(a,c,b,d,e){var g,j,f;if(1===d||4<=d){a=e.length;for(g=0;g<a;g++)if((f=e[g])!==c)f._gc||f._enabled(!1,!1)&&(j=!0);else if(5===d)break;return j}
var h=c._startTime+1E-10,p=[],k=0,m=0===c._duration,n;for(g=e.length;-1<--g;)if(!((f=e[g])===c||f._gc||f._paused))f._timeline!==c._timeline?(n=n||O(c,0,m),0===O(f,n,m)&&(p[k++]=f)):f._startTime<=h&&f._startTime+f.totalDuration()/f._timeScale+1E-10>h&&((m||!f._initted)&&2E-10>=h-f._startTime||(p[k++]=f));for(g=k;-1<--g;)if(f=p[g],2===d&&f._kill(b,a)&&(j=!0),2!==d||!f._firstPT&&f._initted)f._enabled(!1,!1)&&(j=!0);return j},O=function(a,c,b){for(var d=a._timeline,e=d._timeScale,g=a._startTime;d._timeline;){g+=d._startTime;e*=d._timeScale;if(d._paused)return-100;d=d._timeline}
g/=e;return g>c?g-c:b&&g===c||!a._initted&&2E-10>g-c?1E-10:(g+=a.totalDuration()/a._timeScale/e)>c?0:g-c-1E-10};d._init=function(){this.vars.startAt&&(this.vars.startAt.overwrite=0,this.vars.startAt.immediateRender=!0,h.to(this.target,0,this.vars.startAt));var a,c;this._ease=this.vars.ease instanceof u?this.vars.easeParams instanceof Array?this.vars.ease.config.apply(this.vars.ease,this.vars.easeParams):this.vars.ease:"function"===typeof this.vars.ease?new u(this.vars.ease,this.vars.easeParams):h.defaultEase;this._easeType=this._ease._type;this._easePower=this._ease._power;this._firstPT=null;if(this._targets)for(a=this._targets.length;-1<--a;){if(this._initProps(this._targets[a],this._propLookup[a]={},this._siblings[a],this._overwrittenProps?this._overwrittenProps[a]:null))c=!0}else c=this._initProps(this.target,this._propLookup,this._siblings,this._overwrittenProps);c&&h._onPluginEvent("_onInitAllProps",this);this._overwrittenProps&&null==this._firstPT&&"function"!==typeof this.target&&this._enabled(!1,!1);if(this.vars.runBackwards)for(a=this._firstPT;a;)a.s+=a.c,a.c=-a.c,a=a._next;this._onUpdate=this.vars.onUpdate;this._initted=!0};d._initProps=function(a,c,b,d){var e,g,j,f,h,k;if(null==a)return!1;for(e in this.vars){if(Q[e]){if("onStartParams"===e||"onUpdateParams"===e||"onCompleteParams"===e||"onReverseCompleteParams"===e||"onRepeatParams"===e)if(h=this.vars[e])for(g=h.length;-1<--g;)"{self}"===h[g]&&(h=this.vars[e]=h.concat(),h[g]=this)}else if(N[e]&&(f=new N[e])._onInitTween(a,this.vars[e],this)){this._firstPT=k={_next:this._firstPT,t:f,p:"setRatio",s:0,c:1,f:!0,n:e,pg:!0,pr:f._priority};for(g=f._overwriteProps.length;-1<--g;)c[f._overwriteProps[g]]=this._firstPT;if(f._priority||f._onInitAllProps)j=!0;if(f._onDisable||f._onEnable)this._notifyPluginsOfEnabled=!0}else this._firstPT=c[e]=k={_next:this._firstPT,t:a,p:e,f:"function"===typeof a[e],n:e,pg:!1,pr:0},k.s=!k.f?parseFloat(a[e]):a[e.indexOf("set")||"function"!==typeof a["get"+e.substr(3)]?e:"get"+e.substr(3)](),g=this.vars[e],k.c="number"===typeof g?g-k.s:"string"===typeof g&&"="===g.charAt(1)?parseInt(g.charAt(0)+"1",10)*Number(g.substr(2)):Number(g)||0;k&&k._next&&(k._next._prev=k)}
return d&&this._kill(d,a)?this._initProps(a,c,b,d):1<this._overwrite&&this._firstPT&&1<b.length&&G(a,this,c,this._overwrite,b)?(this._kill(c,a),this._initProps(a,c,b,d)):j};d.render=function(a,c,b){var d=this._time,e,g;if(a>=this._duration){if(this._totalTime=this._time=this._duration,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(e=!0,g="onComplete"),0===this._duration){if(0===a||0>this._rawPrevTime)this._rawPrevTime!==a&&(b=!0);this._rawPrevTime=a}}else if(0>=a){this._totalTime=this._time=0;this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0;if(0!==d||0===this._duration&&0<this._rawPrevTime)g="onReverseComplete",e=this._reversed;0>a?(this._active=!1,0===this._duration&&(0<=this._rawPrevTime&&(b=!0),this._rawPrevTime=a)):this._initted||(b=!0)}else if(this._totalTime=this._time=a,this._easeType){var j=a/this._duration,f=this._easeType,h=this._easePower;if(1===f||3===f&&0.5<=j)j=1-j;3===f&&(j*=2);1===h?j*=j:2===h?j*=j*j:3===h?j*=j*j*j:4===h&&(j*=j*j*j*j);this.ratio=1===f?1-j:2===f?j:0.5>a/this._duration?j/2:1-j/2}else this.ratio=this._ease.getRatio(a/this._duration);if(this._time!==d||b){this._initted||(this._init(),!e&&this._time&&(this.ratio=this._ease.getRatio(this._time/this._duration)));!this._active&&!this._paused&&(this._active=!0);if(0===d&&this.vars.onStart&&(0!==this._time||0===this._duration))c||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||E);for(a=this._firstPT;a;){if(a.f)a.t[a.p](a.c*this.ratio+a.s);else a.t[a.p]=a.c*this.ratio+a.s;a=a._next}
this._onUpdate&&(c||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||E));g&&!this._gc&&(e&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),c||this.vars[g]&&this.vars[g].apply(this.vars[g+"Scope"]||this,this.vars[g+"Params"]||E))}};d._kill=function(a,c){"all"===a&&(a=null);if(null==a&&(null==c||c===this.target))return this._enabled(!1,!1);c=c||this._targets||this.target;var b,d,e,g,h,f,k;if((c instanceof Array||c.jquery)&&"object"===typeof c[0])for(b=c.length;-1<--b;)this._kill(a,c[b])&&(h=!0);else{if(this._targets)for(b=this._targets.length;-1<--b;){if(c===this._targets[b]){g=this._propLookup[b]||{};this._overwrittenProps=this._overwrittenProps||[];d=this._overwrittenProps[b]=a?this._overwrittenProps[b]||{}:"all";break}}else{if(c!==this.target)return!1;g=this._propLookup;d=this._overwrittenProps=a?this._overwrittenProps||{}:"all"}
if(g)for(e in f=a||g,k=a!==d&&"all"!==d&&a!==g&&(null==a||!0!==a._tempKill),f){if(b=g[e]){b.pg&&b.t._kill(f)&&(h=!0);if(!b.pg||0===b.t._overwriteProps.length)b._prev?b._prev._next=b._next:b===this._firstPT&&(this._firstPT=b._next),b._next&&(b._next._prev=b._prev),b._next=b._prev=null;delete g[e]}
k&&(d[e]=1)}}
return h};d.invalidate=function(){this._notifyPluginsOfEnabled&&h._onPluginEvent("_onDisable",this);this._onUpdate=this._overwrittenProps=this._firstPT=null;this._initted=this._active=this._notifyPluginsOfEnabled=!1;this._propLookup=this._targets?{}:[];return this};d._enabled=function(a,c){if(a&&this._gc)if(this._targets)for(var b=this._targets.length;-1<--b;)this._siblings[b]=A(this._targets[b],this,!0);else this._siblings=A(this.target,this,!0);r.prototype._enabled.call(this,a,c);return this._notifyPluginsOfEnabled&&this._firstPT?h._onPluginEvent(a?"_onEnable":"_onDisable",this):!1};h.to=function(a,c,b){return new h(a,c,b)};h.from=function(a,c,b){b.runBackwards=!0;!1!==b.immediateRender&&(b.immediateRender=!0);return new h(a,c,b)};h.fromTo=function(a,c,b,d){d.startAt=b;b.immediateRender&&(d.immediateRender=!0);return new h(a,c,d)};h.delayedCall=function(a,c,b,d,e){return new h(c,0,{delay:a,onComplete:c,onCompleteParams:b,onCompleteScope:d,onReverseComplete:c,onReverseCompleteParams:b,onReverseCompleteScope:d,immediateRender:!1,useFrames:e,overwrite:0})};h.set=function(a,c){return new h(a,0,c)};h.killTweensOf=h.killDelayedCallsTo=function(a,c){for(var b=h.getTweensOf(a),d=b.length;-1<--d;)b[d]._kill(c,a)};h.getTweensOf=function(a){if(null!=a){var c,b,d;if((a instanceof Array||a.jquery)&&"object"===typeof a[0]){c=a.length;for(b=[];-1<--c;)b=b.concat(h.getTweensOf(a[c]));for(c=b.length;-1<--c;){d=b[c];for(a=c;-1<--a;)d===b[a]&&b.splice(c,1)}}else{b=A(a).concat();for(c=b.length;-1<--c;)b[c]._gc&&b.splice(c,1)}
return b}};var B=s("plugins.TweenPlugin",function(a,c){this._overwriteProps=(a||"").split(",");this._propName=this._overwriteProps[0];this._priority=c||0},!0);d=B.prototype;B.version=12;B.API=2;d._firstPT=null;d._addTween=function(a,c,b,d,e,g){var h;if(null!=d&&(h="number"===typeof d||"="!==d.charAt(1)?Number(d)-b:parseInt(d.charAt(0)+"1",10)*Number(d.substr(2))))this._firstPT=a={_next:this._firstPT,t:a,p:c,s:b,c:h,f:"function"===typeof a[c],n:e||c,r:g},a._next&&(a._next._prev=a)};d.setRatio=function(a){for(var c=this._firstPT,b;c;){b=c.c*a+c.s;c.r&&(b=b+(0<b?0.5:-0.5)>>0);if(c.f)c.t[c.p](b);else c.t[c.p]=b;c=c._next}};d._kill=function(a){if(null!=a[this._propName])this._overwriteProps=[];else for(var c=this._overwriteProps.length;-1<--c;)null!=a[this._overwriteProps[c]]&&this._overwriteProps.splice(c,1);for(c=this._firstPT;c;)null!=a[c.n]&&(c._next&&(c._next._prev=c._prev),c._prev?(c._prev._next=c._next,c._prev=null):this._firstPT===c&&(this._firstPT=c._next)),c=c._next;return!1};d._roundProps=function(a,c){for(var b=this._firstPT;b;){if(a[this._propName]||null!=b.n&&a[b.n.split(this._propName+"_").join("")])b.r=c;b=b._next}};h._onPluginEvent=function(a,c){var b=c._firstPT,d;if("_onInitAllProps"===a){for(var e,g,h,f;b;){f=b._next;for(e=g;e&&e.pr>b.pr;)e=e._next;(b._prev=e?e._prev:h)?b._prev._next=b:g=b;(b._next=e)?e._prev=b:h=b;b=f}
b=c._firstPT=g}
for(;b;)b.pg&&"function"===typeof b.t[a]&&b.t[a]()&&(d=!0),b=b._next;return d};B.activate=function(a){for(var c=a.length;-1<--c;)a[c].API===B.API&&(h._plugins[(new a[c])._propName]=a[c]);return!0};if(q=n._gsQueue){for(k=0;k<q.length;k++)q[k]();for(d in x)x[d].def||console.log("Warning: TweenLite encountered missing dependency: com.greensock."+d)}})(window);})﻿


// lib/plugins/menu.js
ig.baked=true;ig.module('plugins.menu').requires('impact.game','impact.font').defines(function(){ig.Game.inject({activeMenu:null,draw:function(){this.parent();if(this.activeMenu)
this.activeMenu.draw();},showMenu:function(view){if(view.draw)
this.activeMenu=view;},hideMenu:function(){this.activeMenu=null;},loadLevel:function(data){this.hideMenu();this.parent(data);}});Menu=ig.Class.extend({menuFont:null,title:null,init:function(title){this.title=title?title:" Menu Title";},draw:function(){this.drawModal();var x=ig.system.width*.5;var y=ig.system.height*.5;if(this.menuFont)
this.menuFont.draw(this.title,x,y,ig.Font.ALIGN.CENTER);},drawModal:function(color){if(!color)color='rgba(0,0,0,0.8)';ig.system.context.fillStyle=color;ig.system.context.fillRect(0,0,ig.system.width*ig.system.scale,ig.system.height*ig.system.scale);}})})

// lib/plugins/Path.js
ig.baked=true;ig.module('plugins.Path').defines(function(){window.ga=window.ga||{};ga.Path=function Path(initialPoints,smoothFactor){this.segments=initialPoints||[];this.segmentsLength=null;this.normalizedSegments=null;this.smoothFactor=smoothFactor||0;this.interpolate=smoothFactor?this._smoothInterpolate:this._linearInterpolate;this.onload=null;this.src=null;return this;};ga.Path.prototype={pushPoint:function(x,y){this.segments.push(x);this.segments.push(y);return this;},lastX:function(){if(!this.segments.length){return undefined;}
return this.segments[this.segments.length-2];},lastY:function(){if(!this.segments.length){return undefined;}
return this.segments[this.segments.length-1];},center:function(x,y){x=x||0;y=y||0;var minX=0,maxX=0;var minY=0,maxY=0;minX=maxX=this.segments[0];minY=maxY=this.segments[1];for(var i=1,len=this.segments.length;i<len;i+=2){var thisX=this.segments[i];var thisY=this.segments[i+1];if(thisX<minX)minX=thisX;if(thisX>maxX)maxX=thisX;if(thisY<minY)minY=thisY;if(thisY>maxY)maxY=thisY;}
this.translate(x-minX-(maxX-minX)/2,y-minY-(maxY-minY)/2);},translate:function(x,y){for(var i=0,len=this.segments.length;i<len;i+=2){this.segments[i]+=x;this.segments[i+1]+=y;}},scale:function(scaleX,scaleY){scaleY=scaleY||scaleX;for(var i=0,len=this.segments.length;i<len;i+=2){this.segments[i]*=scaleX;this.segments[i+1]*=scaleY;}},finalize:function(computeNormalizedSegments){if(!this.segmentsLength)this.buildsegmentsLength();if(computeNormalizedSegments&&!this.normalizedSegments)this.buildnormalizedSegments();},addFunctionPath:function(x1,y1,fn,accuracy){if(this.segments.length<2)throw('at least one point must be defined to add a function path');var path=this.segments;var x0=path[path.length-2],y0=path[path.length-1];var dx=(x1-x0);var dy=(y1-y0);var dst=Math.sqrt(sq(dx)+sq(dy));if(!dst)return;dx/=dst;dy/=dst;var x=x0,y=y0,stepCount=0|(dst/accuracy),stepDone=0;while(stepDone<stepCount){stepDone++;var fnValue=fn(stepDone/stepCount);path.push(x0+stepDone*accuracy*dx-fnValue*dy);path.push(y0+stepDone*accuracy*dy+fnValue*dx);}
return this;},buildSymmetricPath:function(x0,y0,x1,y1){var path=this.segments;var newPath=[];var ux=(x1-x0);var uy=(y1-y0);var dist=Math.sqrt(sq(ux)+sq(uy));ux/=dist;uy/=dist;for(var i=0,len=path.length;i<len;i+=2){var projX=(path[i]-x0)*ux+(path[i+1]-y0)*uy;var projY=-(path[i]-x0)*uy+(path[i+1]-y0)*ux;newPath.push(x0+projX*ux+projY*uy);newPath.push(y0+projX*uy-projY*ux);}
return new ga.Path(newPath,this.smoothFactor);},buildsegmentsLength:function(){var path=this.segments;var segmentsLength=this.segmentsLength?this.segmentsLength:[];for(var i=0,j=0;i<=path.length-4;i+=2,j++){segmentsLength[j]=(Math.sqrt(sq(path[i+2]-path[i])+
sq(path[i+3]-path[i+1])));}
if(segmentsLength.length>(this.segments.length/2))segmentsLength.length=(this.segments.length/2);this.segmentsLength=segmentsLength;return this;},buildnormalizedSegments:function(){var path=this.segments;var normSeg=this.normalizedSegments?this.normalizedSegments:[];var path=this.path;for(var i=0;i<=path.length-4;i+=2){var thisL=this.pathLengths[i>>1];var segX=(path[i+2]-path[i])/thisL;var segY=(path[i+3]-path[i+1])/thisL;normSeg[i]=(segX);normSeg[i+1]=(segY);}
this.normalizedSegments=normSeg;return this;},draw:function(ctx,color){var path=this.segments;ctx.beginPath();ctx.strokeStyle=color;ctx.lineWidth=1;ctx.moveTo(path[0],path[1]);for(var i=2;i<path.length;i+=2){ctx.lineTo(path[i],path[i+1]);}
ctx.stroke();},_linearInterpolate:function(segIndex,ratio,backward,targetPoint){targetPoint.x=Math.ceil(this.segments[segIndex]+
ratio*(this.segments[segIndex+2]-this.segments[segIndex]));targetPoint.y=Math.ceil(this.segments[segIndex+1]+
ratio*(this.segments[segIndex+3]-this.segments[segIndex+1]));},_smoothInterpolate:function(segIndex,ratio,backward,targetPoint){if((!backward&&segIndex>this.length-5)||(backward&&(segIndex<4))){return this._linearInterpolate(segIndex,ratio,targetPoint,backward);}
var nextIndex=backward?-4:4;targetPoint.x=this.segments[segIndex]+
ratio*(this.segments[segIndex+2]-this.segments[segIndex]);targetPoint.y=this.segments[segIndex+1]+
ratio*(this.segments[segIndex+3]-this.segments[segIndex+1]);}};Object.defineProperty(ga.Path.prototype,'length',{get:function(){return this.segments?this.segments.length:0;}});function sq(x){return x*x};});﻿


// lib/plugins/pause.js
ig.baked=true;ig.module('plugins.pause').requires('impact.game','impact.timer').defines(function(){ig.Game.inject({paused:false,pauseDelayTimer:new ig.Timer(),pauseButtonDelay:.2,updateEntities:function(){for(var i=0;ent=this.entities[i];i++){if(!ent._killed&&!this.paused){ent.update();}else if(ent.ignorePause){ent.update();}}},togglePause:function(override){if(this.pauseDelayTimer.delta()>this.pauseButtonDelay){this.paused=override!=null?override:!this.paused;if(!this.paused){this.onResume();}else{this.onPause();}
this.pauseDelayTimer.reset();}},unPause:function(override){if(this.pauseDelayTimer.delta()>this.pauseButtonDelay){this.paused=false;this.pauseDelayTimer.reset();}},onResume:function(){},onPause:function(){}});ig.Entity.inject({ignorePause:false});});﻿


// lib/plugins/parallax.js
ig.baked=true;ig.module('plugins.parallax').requires('impact.image').defines(function(){Parallax=ig.Class.extend({layers:[],screen:{x:0,y:0},init:function(settings){ig.merge(this,settings);},add:function(path,settings){var layer=new ParallaxLayer(path,settings);this.layers.push(layer);},move:function(x){this.screen.x+=(x*ig.system.tick);},draw:function(){for(var i=0;i<this.layers.length;i++){var layer=this.layers[i];var x=-((this.screen.x/layer.distance)%layer.w);if(this.screen.x<=0)x=x-layer.w;layer.x=x;while(layer.x<ig.system.width){layer.draw();layer.x+=layer.w;}
layer.x=x;}}});ParallaxLayer=ig.Class.extend({distance:0,x:0,y:0,w:0,h:0,img:null,init:function(path,settings){if(settings&&settings.distance==0)settings.distance=1;this.img=new ig.Image(path);this.w=this.img.width;this.h=this.img.height;ig.merge(this,settings);},draw:function(){this.img.draw(this.x,this.y);}})});﻿

// lib/plugins/pause-focus.js
ig.baked=true;ig.module('plugins.pause-focus').requires('impact.game').defines(function(){ig.Game.inject({staticInstantiate:function(){window.addEventListener("blur",function(){if(ig.system){ig.music.pause();ig.system.stopRunLoop();ig.system.context.fillStyle='black';var oldAlpha=ig.system.context.globalAlpha;ig.system.context.globalAlpha=0.4;ig.system.context.fillRect(0,0,ig.system.canvas.width*ig.system.scale,ig.system.canvas.height*ig.system.scale);ig.system.context.globalAlpha=oldAlpha;}},false);window.addEventListener("focus",function(){if(ig.system){ig.music.play();ig.system.startRunLoop();}},false);return this.parent();}});});﻿


// lib/plugins/screenshaker.js
ig.baked=true;ig.module('plugins.screenshaker').requires('impact.entity').defines(function(){EntityScreenshaker=ig.Entity.extend({gravityFactor:0,pos:{x:0,y:0},lastPos:{x:0,y:0},maxVel:{x:1000,y:1000},k:650,c:5,m:1,trap:0.3,resetTime:2.0,resetTimer:null,timedShakeTimer:null,timedShakeIntensity:100,init:function(x,y,settings){this.parent(0,0,settings);},update:function(){this.lastPos.x=this.pos.x;this.lastPos.y=this.pos.y;this.accel.x=(-this.k*this.pos.x+-this.c*this.vel.x)/this.m;this.accel.y=(-this.k*this.pos.y+-this.c*this.vel.y)/this.m;this.parent();this.handleMovementTrace(null);if(this.resetTimer&&this.resetTimer.delta()>=0){this.pos.x=0;this.pos.y=0;this.last.x=0;this.last.y=0;this.vel.x=0;this.vel.y=0;this.accel.x=0;this.accel.y=0;this.resetTimer=null;}},draw:function(){},handleMovementTrace:function(result){this.pos.x+=this.vel.x*ig.system.tick;this.pos.y+=this.vel.y*ig.system.tick;},kill:function(){},applyImpulse:function(x,y){this.vel.x-=x;this.vel.y-=y;if(this.resetTimer){this.resetTimer.reset();}
else{this.resetTimer=new ig.Timer(this.resetTime);}}});ScreenShaker=ig.Class.extend({spring:new EntityScreenshaker(),update:function(){if(this.timedShakeTimer){if(this.timedShakeTimer.delta()<=0){var randomAngle=this.randomRange(0,Math.PI*2);this.applyImpulse(this.timedShakeIntensity*Math.cos(randomAngle),this.timedShakeIntensity*Math.sin(randomAngle))}
else{this.timedShakeTimer=null;}}
this.spring.update();},shakeScreen:function(screenPos){screenPos.x=screenPos.x-this.spring.lastPos.x+this.spring.pos.x;screenPos.y=screenPos.y-this.spring.lastPos.y+this.spring.pos.y;},applyImpulse:function(x,y){this.spring.applyImpulse(x,y);},timedShake:function(intensity,time){this.timedShakeIntensity=intensity;this.timedShakeTimer=new ig.Timer(time);},randomRange:function(from,to){return Math.floor(Math.random()*(to-from+1)+from);}});});﻿


// lib/plugins/musicFader.js
ig.baked=true;ig.module('plugins.musicFader').requires('impact.sound').defines(function(){"use strict";ig.Music.inject({_loop:true,crossFade:function(time,name){if(!this.currentTrack){return;}
clearInterval(this._fadeInterval);this.fadeTimer=new ig.Timer(time);this.duration=time;this.nextTrack=name;this._fadeInterval=setInterval(this._crossfadeStep.bind(this),50);},_crossfadeStep:function(){var v=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;if(v<=0.01){this.play(this.nextTrack);this.currentTrack.volume=this._volume;clearInterval(this._fadeInterval);this.fadeIn(this.duration);}
else{this.currentTrack.volume=v;}},fadeIn:function(time){if(!this.currentTrack){return;}
this.currentTrack.volume=0;clearInterval(this._fadeInterval);this.fadeTimer=new ig.Timer(time);this._fadeInterval=setInterval(this._fadeInStep.bind(this),50);},_fadeInStep:function(){var v=this.fadeTimer.delta().map(this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;if(v==1){this.currentTrack.volume=this._volume;clearInterval(this._fadeInterval);}
else{this.currentTrack.volume=v;}},});});

// lib/plugins/impact-tween/entity.js
ig.baked=true;ig.module('plugins.impact-tween.entity').requires('impact.entity').defines(function(){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(el,start){var start=start||0;for(var i=0;i<this.length;++i){if(this[i]===el){return i;}}
return-1;};}
ig.Entity.inject({tweens:[],update:function(){this.parent();if(this.tweens.length>0){var currentTweens=[];for(var i=0;i<this.tweens.length;i++){this.tweens[i].update();if(!this.tweens[i].complete)currentTweens.push(this.tweens[i]);}
this.tweens=currentTweens;}},tween:function(props,duration,settings){var tween=new ig.Tween(this,props,duration,settings);this.tweens.push(tween);return tween;},pauseTweens:function(){for(var i=0;i<this.tweens.length;i++){this.tweens[i].pause();}},resumeTweens:function(){for(var i=0;i<this.tweens.length;i++){this.tweens[i].resume();}},stopTweens:function(doComplete){for(var i=0;i<this.tweens.length;i++){this.tweens[i].stop(doComplete);}}});});

// lib/plugins/impact-tween/tween.js
ig.baked=true;ig.module('plugins.impact-tween.tween').requires('plugins.impact-tween.entity').defines(function(){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(el,start){var start=start||0;for(var i=0;i<this.length;++i){if(this[i]===el){return i;}}
return-1;};}
ig.Tween=ig.Class.extend({_objects:null,valuesStart:[],valuesEnd:[],valuesDelta:[],_elapsed:0,timer:false,started:false,_props:{},_chained:false,duration:0,complete:false,paused:false,easing:null,onComplete:false,delay:0,loop:0,loopCount:-1,loopNum:-1,init:function(obj,properties,duration,settings){this.easing=ig.Tween.Easing.Linear.EaseNone;this.duration=duration;ig.merge(this,settings);this.loopNum=this.loopCount;if(typeof properties=='object'&&properties.constructor===(new Array).constructor){this._props=properties;}else{this._props=[properties];}
if(typeof obj=='object'&&obj.constructor===(new Array).constructor){this._objects=obj;}else{this._objects=[obj];}
for(var i=0;i<this._objects.length;i++){this.valuesStart.push({});this.valuesEnd.push({});this.valuesDelta.push({});}},chain:function(chainObj){this._chained=chainObj;},initEnd:function(prop,from,to){if(typeof(from[prop])!=="object"){to[prop]=from[prop];}else{for(var subprop in from[prop]){if(!to[prop])to[prop]={};this.initEnd(subprop,from[prop],to[prop]);}}},initStart:function(prop,end,from,to){;if(typeof from.tweenInitStart==="function"){return from.tweenInitStart(prop,end,to);}
if(typeof(from[prop])!=="object"){if(typeof(end[prop])!=="undefined")to[prop]=from[prop];}else{for(var subprop in from[prop]){if(!to[prop])to[prop]={};if(typeof(end[prop])!=="undefined")this.initStart(subprop,end[prop],from[prop],to[prop]);}}},start:function(){this.complete=false;this.paused=false;this.loopNum=this.loopCount;this._elapsed=0;this.started=true;this.timer=new ig.Timer();for(var i=0;i<this._objects.length;i++){if(this._objects[i].tweens.indexOf(this)==-1)this._objects[i].tweens.push(this);for(var property in this._props[i]){this.initEnd(property,this._props[i],this.valuesEnd[i]);}
for(var property in this.valuesEnd[i]){this.initStart(property,this.valuesEnd[i],this._objects[i],this.valuesStart[i]);this.initDelta(property,this.valuesDelta[i],this._objects[i],this.valuesEnd[i]);}}},initDelta:function(prop,delta,start,end){if(typeof start.tweenInitDelta==="function"){return start.tweenInitDelta(prop,delta,end);}
if(typeof(end[prop])!=="object"){delta[prop]=end[prop]-start[prop];}else{for(var subprop in end[prop]){if(!delta[prop])delta[prop]={};this.initDelta(subprop,delta[prop],start[prop],end[prop]);}}},propUpdate:function(prop,obj,start,delta,value){if(typeof obj.tweenPropUpdate==="function"){return obj.tweenPropUpdate(prop,start,delta,value);}
if(typeof(start[prop])!=="object"){if(typeof start[prop]!="undefined"){obj[prop]=start[prop]+delta[prop]*value;}else{obj[prop]=obj[prop];}}else{for(var subprop in start[prop]){this.propUpdate(subprop,obj[prop],start[prop],delta[prop],value);}}},propSet:function(prop,from,to){if(typeof to.tweenPropSet==="function"){return to.tweenPropSet(prop,from);}
if(typeof(from[prop])!=="object"){to[prop]=from[prop];}else{for(subprop in from[prop]){if(!to[prop])to[prop]={};this.propSet(subprop,from[prop],to[prop]);}}},update:function(){if(!this.started)return false;if(this.delay){if(this.timer.delta()<this.delay)return;this.delay=0;this.timer.reset();}
if(this.paused||this.complete)return false;var elapsed=(this.timer.delta()+this._elapsed)/this.duration;elapsed=elapsed>1?1:elapsed;var value=this.easing(elapsed);for(var i=0;i<this._objects.length;i++){for(var property in this.valuesDelta[i]){this.propUpdate(property,this._objects[i],this.valuesStart[i],this.valuesDelta[i],value);}
if(elapsed>=1){if(this.loopNum==0||!this.loop){this.complete=true;if(this.onComplete)this.onComplete();if(this._chained)this._chained.start();return false;}else if(this.loop==ig.Tween.Loop.Revert){for(var property in this.valuesStart[i]){this.propSet(property,this.valuesStart[i],this._objects[i]);}
this._elapsed=0;this.timer.reset();if(this.loopNum!=-1)this.loopNum--;}else if(this.loop==ig.Tween.Loop.Reverse){var _start={},_end={},_delta={};ig.merge(_start,this.valuesEnd[i]);ig.merge(_end,this.valuesStart[i]);ig.merge(this.valuesStart[i],_start);ig.merge(this.valuesEnd[i],_end);for(var property in this.valuesEnd[i]){this.initDelta(property,this.valuesDelta[i],this._objects[i],this.valuesEnd[i]);}
this._elapsed=0;this.timer.reset();if(this.loopNum!=-1)this.loopNum--;}}}},pause:function(){this.paused=true;this._elapsed+=this.timer.delta();},resume:function(){this.paused=false;this.timer.reset();},stop:function(doComplete){if(doComplete){this.paused=false;this.complete=false;this.loop=false;this._elapsed+=this.duration;this.update();}
this.complete=true;},rewind:function(){var loop=this.loop;this.complete=false;this.paused=false;this.loopNum=-1;this.loop=ig.Tween.Loop.Revert;this.update();this.loop=loop;}});ig.Tween.Loop={Revert:1,Reverse:2};ig.Tween.Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};ig.Tween.Easing.Linear.EaseNone=function(k){return k;};ig.Tween.Easing.Quadratic.EaseIn=function(k){return k*k;};ig.Tween.Easing.Quadratic.EaseOut=function(k){return-k*(k-2);};ig.Tween.Easing.Quadratic.EaseInOut=function(k){if((k*=2)<1)return 0.5*k*k;return-0.5*(--k*(k-2)-1);};ig.Tween.Easing.Cubic.EaseIn=function(k){return k*k*k;};ig.Tween.Easing.Cubic.EaseOut=function(k){return--k*k*k+1;};ig.Tween.Easing.Cubic.EaseInOut=function(k){if((k*=2)<1)return 0.5*k*k*k;return 0.5*((k-=2)*k*k+2);};ig.Tween.Easing.Quartic.EaseIn=function(k){return k*k*k*k;};ig.Tween.Easing.Quartic.EaseOut=function(k){return-(--k*k*k*k-1);}
ig.Tween.Easing.Quartic.EaseInOut=function(k){if((k*=2)<1)return 0.5*k*k*k*k;return-0.5*((k-=2)*k*k*k-2);};ig.Tween.Easing.Quintic.EaseIn=function(k){return k*k*k*k*k;};ig.Tween.Easing.Quintic.EaseOut=function(k){return(k=k-1)*k*k*k*k+1;};ig.Tween.Easing.Quintic.EaseInOut=function(k){if((k*=2)<1)return 0.5*k*k*k*k*k;return 0.5*((k-=2)*k*k*k*k+2);};ig.Tween.Easing.Sinusoidal.EaseIn=function(k){return-Math.cos(k*Math.PI/2)+1;};ig.Tween.Easing.Sinusoidal.EaseOut=function(k){return Math.sin(k*Math.PI/2);};ig.Tween.Easing.Sinusoidal.EaseInOut=function(k){return-0.5*(Math.cos(Math.PI*k)-1);};ig.Tween.Easing.Exponential.EaseIn=function(k){return k==0?0:Math.pow(2,10*(k-1));};ig.Tween.Easing.Exponential.EaseOut=function(k){return k==1?1:-Math.pow(2,-10*k)+1;};ig.Tween.Easing.Exponential.EaseInOut=function(k){if(k==0)return 0;if(k==1)return 1;if((k*=2)<1)return 0.5*Math.pow(2,10*(k-1));return 0.5*(-Math.pow(2,-10*(k-1))+2);};ig.Tween.Easing.Circular.EaseIn=function(k){return-(Math.sqrt(1-k*k)-1);};ig.Tween.Easing.Circular.EaseOut=function(k){return Math.sqrt(1---k*k);};ig.Tween.Easing.Circular.EaseInOut=function(k){if((k/=0.5)<1)return-0.5*(Math.sqrt(1-k*k)-1);return 0.5*(Math.sqrt(1-(k-=2)*k)+1);};ig.Tween.Easing.Elastic.EaseIn=function(k){var s,a=0.1,p=0.4;if(k==0)return 0;if(k==1)return 1;if(!p)p=0.3;if(!a||a<1){a=1;s=p/4;}
else s=p/(2*Math.PI)*Math.asin(1/a);return-(a*Math.pow(2,10*(k-=1))*Math.sin((k-s)*(2*Math.PI)/p));};ig.Tween.Easing.Elastic.EaseOut=function(k){var s,a=0.1,p=0.4;if(k==0)return 0;if(k==1)return 1;if(!p)p=0.3;if(!a||a<1){a=1;s=p/4;}
else s=p/(2*Math.PI)*Math.asin(1/a);return(a*Math.pow(2,-10*k)*Math.sin((k-s)*(2*Math.PI)/p)+1);};ig.Tween.Easing.Elastic.EaseInOut=function(k){var s,a=0.1,p=0.4;if(k==0)return 0;if(k==1)return 1;if(!p)p=0.3;if(!a||a<1){a=1;s=p/4;}
else s=p/(2*Math.PI)*Math.asin(1/a);if((k*=2)<1)return-0.5*(a*Math.pow(2,10*(k-=1))*Math.sin((k-s)*(2*Math.PI)/p));return a*Math.pow(2,-10*(k-=1))*Math.sin((k-s)*(2*Math.PI)/p)*0.5+1;};ig.Tween.Easing.Back.EaseIn=function(k){var s=1.70158;return k*k*((s+1)*k-s);};ig.Tween.Easing.Back.EaseOut=function(k){var s=1.70158;return(k=k-1)*k*((s+1)*k+s)+1;};ig.Tween.Easing.Back.EaseInOut=function(k){var s=1.70158*1.525;if((k*=2)<1)return 0.5*(k*k*((s+1)*k-s));return 0.5*((k-=2)*k*((s+1)*k+s)+2);};ig.Tween.Easing.Bounce.EaseIn=function(k){return 1-ig.Tween.Easing.Bounce.EaseOut(1-k);};ig.Tween.Easing.Bounce.EaseOut=function(k){if((k/=1)<(1/2.75)){return 7.5625*k*k;}else if(k<(2/2.75)){return 7.5625*(k-=(1.5/2.75))*k+0.75;}else if(k<(2.5/2.75)){return 7.5625*(k-=(2.25/2.75))*k+0.9375;}else{return 7.5625*(k-=(2.625/2.75))*k+0.984375;}};ig.Tween.Easing.Bounce.EaseInOut=function(k){if(k<0.5)return ig.Tween.Easing.Bounce.EaseIn(k*2)*0.5;return ig.Tween.Easing.Bounce.EaseOut(k*2-1)*0.5+0.5;};});﻿
﻿


// lib/game/entities/object-homingMissile.js
ig.baked=true;ig.module('game.entities.object-homingMissile').requires('impact.entity','impact.sound').defines(function(){EntityHomingMissile=ig.Entity.extend({animSheet:new ig.AnimationSheet('media/textures/plasma_g.png',66,35),speed:400,offset:{x:25,y:10},size:{x:25,y:12},vel:{x:200,y:0},maxVel:{x:9999,y:9999},bulletCount:1,turnFactor:0.04,dmg:6,nearestTarget:null,type:ig.Entity.TYPE.C,checkAgainst:ig.Entity.TYPE.B,collides:ig.Entity.COLLIDES.NEVER,lifeTime:4,init:function(x,y,settings){var noArgs=(arguments.length==0);this.parent(x,y,settings);this.addAnim('idle',0.5,[0]);this.bulletCount=(settings&&settings.bulletCount)?settings.bulletCount:0;ig.game.missiles.current--;this.lifeTimer=new ig.Timer(this.lifeTime);},draw:function(){this.parent();},drawDebugLines:function(){var ctx=ig.system.context;ctx.beginPath();ctx.strokeStyle='yellow';ctx.moveTo(this.pos.x,this.pos.y);ctx.lineTo(this.nearestTarget.pos.x,this.nearestTarget.pos.y);ctx.stroke();ctx.closePath();},update:function(){this.parent();this.killIfOffScreen();this.getTargets();this.modifyVelocity();this.killWhenLifeTimerExpires()},killWhenLifeTimerExpires:function(){if(this.lifeTimer&&this.lifeTimer.delta()>0)
this.kill();},getTargets:function(){var targets=ig.game.getEntitiesByType(EntityBaseEnemy);var sqMinDistanceFoundSoFar=9999;var target=null;var dx=0,dy=0;for(var i=0,len=targets.length;i<len;i++){target=targets[i];if(target===EntityActorEnemySpawner){continue;}
dx=target.x-this.x;dx*=dx;dy=target.y-this.y;dy*=dy;dy+=dx;if(dy<sqMinDistanceFoundSoFar){sqMinDistanceFoundSoFar=dy;this.nearestTarget=target;}}
this.nearestTarget=target;},modifyVelocity:function(){if(this.nearestTarget===null){return;}
var desiredAngle=this.angleToCorr(this.nearestTarget);var currentAngle=this.getVelAngle();var angleDiff=this.getAngleDifference(desiredAngle,currentAngle);this.vel.x=Math.cos(desiredAngle)*this.speed;this.vel.y=Math.sin(desiredAngle)*this.speed;this.currentAnim.angle=desiredAngle;},getVelAngle:function(){var angle=Math.atan2(this.vel.y,this.vel.x);return angle;},getAngleDifference:function(targetAngle,currentAngle){var rem=(targetAngle-currentAngle)%2*Math.PI;if(rem>Math.PI){rem-=2*Math.PI;}},killIfOffScreen:function(){if(this.pos.x>ig.system.width+50||this.pos.y>ig.system.height+50||this.pos.x<-50||this.pos.y<-50){this.kill();}},check:function(other){if(other instanceof EntityBaseEnemy){other.receiveDamage(this.dmg,this);this.spawnParticles();this.kill();}},spawnParticles:function(){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.grey,this.particleCnt,this.size.x);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.green,this.particleCnt,this.size.x);}});});

// lib/game/entities/base-player.js
ig.baked=true;ig.module('game.entities.base-player').requires('impact.entity','game.entities.object-homingMissile').defines(function(){EntityBasePlayer=ig.Entity.extend({type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.B,collides:ig.Entity.COLLIDES.PASSIVE,invincible:false,shotFreq:0.085,compRespawnDelay:2,turretRespawnDelay:1,receiveDamage:function(value,from){if(this.invincible||!this.visible){return;}
this.parent(value,from);},spawnCompanion:function(){if(ig.input.pressed('spawnCompanion')){if(ig.game.companions.current<ig.game.companions.max&&this.compSpawnTimer.delta()>this.compRespawnDelay){ig.game.spawnEntity(EntityCompanion,this.pos.x+6,this.pos.y-9);this.compSpawnTimer.reset();}}},spawnTurret:function(){if(ig.input.pressed('spawnTurret')){if(ig.game.turrets.current>0&&this.turretSpawnTimer.delta()>this.turretRespawnDelay){ig.game.spawnEntity(EntityTurret,this.pos.x+6,this.pos.y-9);this.turretSpawnTimer.reset();}}},makeInvincible:function(){this.invincible=true;this.invincibleTimer.reset();},drawBulletTimeText:function(){if(this.bulletTimeTimer){var d2=-this.bulletTimeTimer.delta();var a2=d2>1.7?d2.map(2,1.7,0,1):(d2<1?d2:1);var xs2=ig.system.width/2;var ys2=ig.system.height/3+(d2<1?Math.cos(1-d2).map(1,0,0,250):0);this.font.alpha=Math.max(a2,0);this.font.draw('Bullet Time!',xs2,ys2,ig.Font.ALIGN.CENTER);this.font.alpha=1;this.bCanBulletTime=false;if(d2<0){this.bulletTimeTimer=null;}}},drawBossText:function(){if(this.bossTextTimer){var d2=-this.bossTextTimer.delta();var a2=d2>4.7?d2.map(2,4.7,0,1):(d2<1?d2:1);var xs2=ig.system.width/2;var ys2=ig.system.height/3+(d2<1?Math.cos(1-d2).map(1,0,0,250):0);this.font.alpha=Math.max(a2,0);this.font.draw('WARNING! Boss Approaching!',xs2,ys2+30,ig.Font.ALIGN.CENTER);this.font.alpha=1;if(d2<0){this.bossTextTimer=null;}}},drawUI:function(){if(this.livesRemainingTimer){var d2=-this.livesRemainingTimer.delta();var a2=d2>2.7?d2.map(2,2.7,0,1):(d2<1?d2:1);var xs2=ig.system.width/2;var ys2=ig.system.height/3+(d2<1?Math.cos(1-d2).map(1,0,0,250):0);this.font.alpha=Math.max(a2,0);if(ig.game.stats.lives>1){this.font.draw(ig.game.stats.lives+' Ships Remaining',xs2,ys2,ig.Font.ALIGN.CENTER);}else{this.font.draw(ig.game.stats.lives+' Ship Remaining',xs2,ys2,ig.Font.ALIGN.CENTER);}
this.font.alpha=1;if(d2<0){this.livesRemainingTimer=null;}}},collisionDetection:function(){if(this.pos.x<0){this.pos.x=0;}else if(this.pos.x>ig.system.width){this.pos.x=ig.system.width;}
if(this.pos.y<=10){this.pos.y=+10;}else if(this.pos.y>=ig.system.height-15){this.pos.y=ig.system.height-15;}},handleDesktopInput:function(){if(ig.input.state('left')){this.vel.x=-this.speed;}else if(ig.input.state('right')){this.vel.x=this.speed;}else{this.vel.x=0;}
if(ig.input.state('up')){this.vel.y=-this.speed;}else if(ig.input.state('down')){this.vel.y=this.speed;}else{this.vel.y=0;}
var isShooting=ig.input.state('shoot');if(isShooting&&this.lastShootTimer.delta()>0){this.shoot();this.lastShootTimer.set(this.shotFreq);}
if(ig.input.pressed('slowTime')){ig.game.slowTime();}
if(ig.input.pressed('shootMissile')){this.shootMissile();}},shootMissile:function(){if(ig.game.missiles.current>0){ig.game.spawnEntity((EntityHomingMissile),this.pos.x,this.pos.y);SoundSource.missileLaunch.play();}}});});﻿
﻿


// lib/game/entities/object-playerBullet.js
ig.baked=true;ig.module('game.entities.object-playerBullet').requires('impact.entity','impact.sound').defines(function(){EntityPlayerBullet=ig.Entity.extend({image:new ig.Image('media/textures/plasma_g.png'),speed:{x:6900,y:1000},size:{x:8,y:6},offset:{x:20,y:16},friction:{x:0,y:15},bulletCount:1,speedModifier:5,dmg:1,type:ig.Entity.TYPE.C,checkAgainst:ig.Entity.TYPE.B,collides:ig.Entity.COLLIDES.NEVER,init:function(x,y,settings){var noArgs=(arguments.length==0);this.parent(x,y,settings);this.bulletCount=(settings&&settings.bulletCount)?settings.bulletCount:0;this.vel.x=this.speed.x;this.vel.y=Math.sin(this.angle*2)*this.speed.y;timeShift=Math.random()*100;},draw:function(){ig.system.context.save();ig.system.context.translate(this.pos.x-ig.game._rscreen.x,this.pos.y-ig.game._rscreen.y);ig.system.context.drawImage(this.image.data,-this.offset.x,-this.offset.y);ig.system.context.restore();},update:function(){this.parent();this.pos.x+=this.vel.x*ig.system.tick*this.speedModifier;this.pos.y+=this.vel.y*ig.system.tick/2;if(this.pos.x>ig.system.width+50||this.pos.y>ig.system.height+50||this.pos.x<-50||this.pos.y<-50){this.kill();}},check:function(other){if(other instanceof EntityBaseEnemy){other.receiveDamage(this.dmg,this);this.kill();}}});});

// lib/game/entities/actor-companion.js
ig.baked=true;ig.module('game.entities.actor-companion').requires('game.entities.base-player','game.entities.object-playerBullet').defines(function(){EntityCompanion=ig.Entity.extend({animSheet:new ig.AnimationSheet('media/textures/playerShip.png',44,50),size:{x:20,y:20},offset:{x:20,y:16},friction:{x:800,y:800},maxVel:{x:300,y:300},angle:-Math.PI/2,speed:200,health:9000,respawnDelay:1.5,rotationSpeed:0.10,shotFreq:0.1,type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',60,[0]);this.addAnim('shoot',0.05,[1,2],true);this.lastShootTimer=new ig.Timer(0);SoundSource.miniShipSpawn.play();ig.game.companions.current++;},update:function(){if(this.currentAnim.loopCount>0){this.currentAnim=this.anims.idle;}
this.parent();this.collisionDetection();this.handleDesktopInput();this.parental=ig.game.player;var x=(this.parental.pos.x+this.parental.size.x/2)+Math.cos(this.angle)*70;var y=(this.parental.pos.y+this.parental.size.y/2)+Math.sin(this.angle)*70;this.pos.x=x;this.pos.y=y;this.angle+=this.rotationSpeed;},collisionDetection:function(){if(this.pos.x<0){this.pos.x=0;}else if(this.pos.x>ig.system.width){this.pos.x=ig.system.width;}
if(this.pos.y<0){this.pos.y=0;}else if(this.pos.y>ig.system.height){this.pos.y=ig.system.height;}},handleDesktopInput:function(){var isShooting=ig.input.state('shoot');if(isShooting&&this.lastShootTimer.delta()>0){this.shoot();this.lastShootTimer.set(this.shotFreq);}},shoot:function(){this.currentAnim=this.anims.shoot.rewind();var angle=-Math.PI/2+Math.random()*0.03-0.01;ig.game.spawnEntity(EntityPlayerBullet,this.pos.x-1,this.pos.y-1,{angle:angle});},kill:function(){ig.game.companions.current--;SoundSource.miniShipKill.play();this.spawnParticles();this.parent();},spawnParticles:function(){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.grey,50,this.size.x);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.red,50,this.size.x);}});});﻿
﻿
﻿


// lib/plugins/imageblender.js
ig.baked=true;ig.module('plugins.imageblender').requires('impact.image').defines(function(){ig.Image.inject({onload:function(event){this.parent(event);var hashIndex=this.path.indexOf("#");if(hashIndex!==-1){this.convertToCanvas();var ctx=this.data.getContext("2d");var imgData=ctx.getImageData(0,0,this.data.width,this.data.height);var src=imgData.data;var sA,dA=1,len=src.length;var sRA,sGA,sBA,dA2,demultiply;var dRA=parseInt(this.path.substr(hashIndex+1,2),16)/255;var dGA=parseInt(this.path.substr(hashIndex+3,2),16)/255;var dBA=parseInt(this.path.substr(hashIndex+5,2),16)/255;for(var px=0;px<len;px+=4){sA=src[px+3]/255;dA2=(sA+dA-sA*dA);sRA=src[px]/255*sA;sGA=src[px+1]/255*sA;sBA=src[px+2]/255*sA;demultiply=255/dA2;src[px]=(sRA*dRA+dRA*(1-sA))*demultiply;src[px+1]=(sGA*dGA+dGA*(1-sA))*demultiply;src[px+2]=(sBA*dBA+dBA*(1-sA))*demultiply;}
ctx.putImageData(imgData,0,0);}},convertToCanvas:function(){if(this.data.getContext){return;}
var orig=ig.$new('canvas');orig.width=this.width;orig.height=this.height;orig.getContext('2d').drawImage(this.data,0,0,this.width,this.height,0,0,this.width,this.height);this.data=orig;}});});﻿
﻿


// lib/game/entities/base-enemyBullet.js
ig.baked=true;ig.module('game.entities.base-enemyBullet').requires('impact.entity','impact.sound').defines(function(){window.EntityBaseEnemyBullet=ig.Entity.extend({type:ig.Entity.TYPE.C,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.PASSIVE,rotation:1,rotationSpeed:12,lifeTime:4,init:function(x,y,settings){this.parent(x,y,settings);this.lifeTimer=new ig.Timer(this.lifeTime);},draw:function(){var ctx=ig.system.context;ctx.save();ctx.translate(ig.system.getDrawPos(this.pos.x+this.size.x/2),ig.system.getDrawPos(this.pos.y+this.size.y/2));ctx.drawImage(this.image.data,-this.size.x/2,-this.size.y/2);ctx.restore();},update:function(){this.parent();if(this.pos.x>ig.system.width+50||this.pos.y>ig.system.height+50||this.pos.x<-50||this.pos.y<-50){this.kill();}
this.killWhenLifeTimerExpires();},check:function(other){if(other instanceof EntityActorPlayer){other.receiveDamage(1,this);this.kill();}},killWhenLifeTimerExpires:function(){if(this.lifeTimer&&this.lifeTimer.delta()>0)
this.kill();}});});

// lib/game/entities/object-enemyBulletBlue.js
ig.baked=true;ig.module('game.entities.object-enemyBulletBlue').requires('game.entities.base-enemyBullet').defines(function(){window.EntityObjectEnemyBulletBlue=EntityBaseEnemyBullet.extend({image:new ig.Image('media/textures/plasma_b.png'),speed:600,speedModifier:4.5,size:{x:6,y:2},offset:{x:46,y:46},lifeTime:4,init:function(x,y,settings){this.parent(x,y,settings);this.vel.x=-this.speed;this.lifeTimer=new ig.Timer(this.lifeTime);},update:function(){this.parent();this.pos.x+=this.vel.x*this.speedModifier*ig.system.tick;this.pos.y+=this.vel.y*this.speedModifier*ig.system.tick;}});});﻿


// lib/game/entities/object-enemyBulletGreen.js
ig.baked=true;ig.module('game.entities.object-enemyBulletGreen').requires('game.entities.base-enemyBullet').defines(function(){"use strict";window.EntityObjectEnemyBulletGreen=EntityBaseEnemyBullet.extend({size:{x:20,y:20},image:new ig.Image('media/textures/neon_bullet_b.png'),speed:120,rotation:1,rotationSpeed:10,draw:function(){var ctx=ig.system.context;ctx.save();ctx.translate(ig.system.getDrawPos(this.pos.x+this.size.x/2),ig.system.getDrawPos(this.pos.y+this.size.y/2));ctx.rotate(this.rotation);ctx.drawImage(this.image.data,-this.size.x/2,-this.size.y/2);ctx.restore();},update:function(){this.parent();this.vel.x=Math.cos(this.angle)*this.speed;this.vel.y=Math.sin(this.angle)*this.speed;this.pos.x+=this.vel.x*ig.system.tick;this.pos.y+=this.vel.y*ig.system.tick;this.rotation+=this.rotationSpeed*ig.system.tick;}});});

// lib/game/entities/object-enemyBulletPurple.js
ig.baked=true;ig.module('game.entities.object-enemyBulletPurple').requires('game.entities.base-enemyBullet').defines(function(){window.EntityObjectEnemyBulletPurple=EntityBaseEnemyBullet.extend({image:new ig.Image('media/textures/plasma_b.png'),speed:250,speedModifier:2.5,size:{x:6,y:2},offset:{x:46,y:46},update:function(){this.parent();this.vel.x=Math.cos(this.angle)*this.speed;this.vel.y=Math.sin(this.angle)*this.speed;this.pos.x+=this.vel.x*ig.system.tick;this.pos.y+=this.vel.y*ig.system.tick;}});});

// lib/game/entities/base-enemy.js
ig.baked=true;ig.module('game.entities.base-enemy').requires('impact.entity','plugins.imageblender','game.entities.object-enemyBulletBlue','game.entities.object-enemyBulletGreen','game.entities.object-enemyBulletPurple').defines(function(){EntityBaseEnemy=EntityFollower.extend({health:8,hitOtherDmg:10,speedModifier:1.1,kamikazeSpeed:-325,kamikazeVelocity:-350,particleCount:15,particleKillCount:20,xModifier:150,maxVel:{x:400,y:400},type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.PASSIVE,reloadTime:3,angle:Math.PI/2,fireOffset:10,radius:{},bullets:{},_angle:{},_distance:{},_entityBullet:{},init:function(x,y,settings){this.parent(x,y,settings);ig.game.enemies.current++;},update:function(){this.parent();this.collisionDetection();this.player=ig.game.player;if(this.pos.x>ig.system.width+50||this.pos.y>ig.system.height+250||this.pos.x<-50||this.pos.y<-50){this.killedByScreen();}},kill:function(){this.spawnParticlesOnDeath();SoundSource.explode.play();this.lootDrop();ig.game.enemies.current--;ig.game.stats.kills++;this.parent();},check:function(other){other.receiveDamage(this.hitOtherDmg,this);},receiveDamage:function(value,from){this.parent(value,from);if(this.health>1){SoundSource.hit.play();}},lootDrop:function(){var rndNum=this.randomFromTo(1,ig.game.chanceToSpawnPickups.max);if(rndNum>ig.game.chanceToSpawnPickups.min){var rndDropNum=this.randomFromTo(1,4);switch(rndDropNum){case 1:if(ig.game.companions.current<ig.game.companions.max){ig.game.spawnEntity(EntityObjectPuMiniShip,this.pos.x,this.pos.y);}
break;case 2:if(ig.game.bulletTime.current<ig.game.bulletTime.max){ig.game.spawnEntity(EntityObjectPickupBulletTime,this.pos.x,this.pos.y);}
break;case 3:if(ig.game.turrets.current<ig.game.turrets.max){ig.game.spawnEntity(EntityObjectPickupTurret,this.pos.x,this.pos.y);}
break;case 4:if(ig.game.missiles.current<ig.game.missiles.max){ig.game.spawnEntity(EntityObjectPickupMissile,this.pos.x,this.pos.y);}
break;default:break}}},shootBullets:function(xOffset,yOffset){if(this.shootTimer.delta()>0){var centerX=this.pos.x+this.size.x/2;var centerY=this.pos.y+this.size.y/2;if(xOffset){var OffsetX=xOffset}else{var OffsetX=0;}
if(yOffset){var OffsetY=yOffset}else{var OffsetY=0;}
var xPos=centerX+OffsetX;var yPos=centerY+OffsetY;var inc=this._increase/(this.bullets-1);var a=this._angle*180/Math.PI;for(var i=0;i<this.bullets;i++){var angle=a*Math.PI/180;ig.game.spawnEntity(this._entityBullet,xPos,yPos,{angle:angle});a+=inc;}
this.shootTimer.set(this.reloadTime);}},collisionDetection:function(){if(this.pos.x>ig.system.width){this.pos.x=ig.system.width;}
if(this.pos.y<=10){this.pos.y=+10;}else if(this.pos.y>=ig.system.height-30){this.pos.y=ig.system.height-30;}},randomFromTo:function(from,to){return Math.floor(Math.random()*(to-from+1)+from);},spawnParticlesOnDeath:function(){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.red,this.particleKillCount,this.size.x);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.grey,this.particleKillCount,this.size.x);},randomizeMovements:function(){var rndNum=this.randomFromTo(1,10);this.moveTimer.reset();switch(rndNum){case 1:this.stop();break;case 2:this.moveToPlayer();break;case 3:this.moveFromPlayer();break;case 4:this.moveForward();break;case 5:this.backup();break;case 6:this.moveToPlayer();break;case 7:this.moveToPlayer();break;case 8:this.moveForward();break;case 9:this.moveForward();break;case 10:this.moveForward();break;default:this.moveForward();break;}},moveToPlayer:function(){var angle=this.angleToCorr(this.player);var angleX=Math.cos(angle);var angleY=Math.sin(angle);this.vel.x=angleX*-this.kamikazeSpeed;this.vel.y=angleY*-this.kamikazeSpeed;},moveFromPlayer:function(){var angle=this.angleToCorr(this.player);var angleX=-Math.cos(angle);var angleY=-Math.sin(angle);this.vel.x=angleX*-this.kamikazeSpeed;this.vel.y=angleY*-this.kamikazeSpeed;},backup:function(){this.vel.x=+50;},stop:function(){this.vel.x=0;},moveForward:function(){this.vel.x=this.kamikazeVelocity+this.xModifier;}});});﻿


// lib/game/entities/actor-enemyKamikaze.js
ig.baked=true;ig.module('game.entities.actor-enemyKamikaze').requires('game.entities.base-enemy').defines(function(){EntityActorEnemyKamikaze=EntityBaseEnemy.extend({animSheet:new ig.AnimationSheet('media/textures/actor-enemyKamikaze-lg.png',63.3,50),size:{x:30,y:30},offset:{x:+16,y:+14},friction:{x:150,y:0},health:5,speedModifier:2.5,xModifier:-60,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('fly',0.1,[0,1,2,3,4,5,6,7]);this.tween({pos:{x:900}},2.5,{easing:ig.Tween.Easing.Sinusoidal.EaseOut}).start();},update:function(){this.parent();this.vel.x=this.kamikazeVelocity+this.xModifier;if(this.distanceTo(this.player)<500){var angle=this.angleToCorr(this.player);var angleX=Math.cos(angle);var angleY=Math.sin(angle);this.vel.x=angleX*-this.kamikazeSpeed;this.vel.y=angleY*-this.kamikazeSpeed;}
if(this.distanceTo(this.player)<300){this.vel.x=this.vel.x*this.speedModifier;}
if(this.pos.x+3<this.player.pos.x){this.vel.x=this.kamikazeSpeed;}},receiveDamage:function(value,from){this.parent(value,from);if(this.health>1){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.yellow,this.particleKillCount,this.size.x);}}});});﻿
﻿


// lib/game/entities/actor-enemySpinShip.js
ig.baked=true;ig.module('game.entities.actor-enemySpinShip').requires('game.entities.base-enemy').defines(function(){EntityActorEnemySpinShip=EntityBaseEnemy.extend({animSheet:new ig.AnimationSheet('media/textures/actor-enemyKamikaze-lg.png',63.3,50),size:{x:30,y:30},offset:{x:+16,y:+14},friction:{x:150,y:0},health:7,shootTimer:null,firingTimer:1.3,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('fly',0.1,[0,1,2,3,4,5,6,7]);this.shootTimer=new ig.Timer(this.firingTimer);this.tween({pos:{x:ig.system.width-200}},2,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();},update:function(){this.parent();this.vel.x=this.kamikazeVelocity;if(this.player.pos.x+750>this.pos.x){if(this.shootTimer.delta()>0){this.shootBullets();}}
this.pursuePlayer();this.speedBurst();},shootBullets:function(){this.bulletx=this.pos.x+24;this.bullety=this.pos.y+44;ig.game.spawnEntity(EntityObjectEnemyBulletBlue,this.pos.x-1,this.pos.y-10);ig.game.spawnEntity(EntityObjectEnemyBulletBlue,this.pos.x-1,this.pos.y+10);this.shootTimer.reset();},pursuePlayer:function(){if(this.distanceTo(this.player)<450){var angle=this.angleToCorr(this.player);var x=Math.cos(angle);var y=Math.sin(angle);this.vel.x=x*-this.kamikazeSpeed;this.vel.y=y*-this.kamikazeSpeed;}},speedBurst:function(){if(this.pos.x+3<this.player.pos.x){this.vel.x=this.kamikazeSpeed;}},receiveDamage:function(value,from){this.parent(value,from);if(this.health>1){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.grey,this.particleKillCount,this.size.x);}}});});

// lib/game/entities/actor-enemyKamikazeComp.js
ig.baked=true;ig.module('game.entities.actor-enemyKamikazeComp').requires('game.entities.base-enemy','game.entities.actor-enemySpinShip').defines(function(){EntityActorEnemyKamikazeComp=EntityBaseEnemy.extend({animSheet:new ig.AnimationSheet('media/textures/actor-enemyKamikaze-lg.png#f9ff49',63.3,50),size:{x:30,y:30},offset:{x:+16,y:+14},friction:{x:150,y:0},health:7,speedModifier:2.5,xModifier:-60,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('fly',0.1,[0,1,2,3,4,5,6,7]);this.gun=ig.game.spawnEntity(EntityActorEnemySpinShip,this.pos.x-80,this.pos.y+80);this.gun=ig.game.spawnEntity(EntityActorEnemySpinShip,this.pos.x-80,this.pos.y-80);},update:function(){this.parent();this.vel.x=this.kamikazeVelocity;this.slowMoveToPlayer();this.zoomToPlayer();},zoomToPlayer:function(){if(this.distanceTo(this.player)<300){this.vel.x=this.vel.x*this.speedModifier;}
if(this.pos.x+3<this.player.pos.x){this.vel.x=this.kamikazeSpeed;}},slowMoveToPlayer:function(){if(this.distanceTo(this.player)<500){var angle=this.angleToCorr(this.player);var angleX=Math.cos(angle);var angleY=Math.sin(angle);this.vel.x=angleX*-this.kamikazeSpeed;this.vel.y=angleY*-this.kamikazeSpeed;}},receiveDamage:function(value,from){this.parent(value,from);if(this.health>1){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.grey,this.particleKillCount,this.size.x);}}});});﻿


// lib/game/entities/actor-enemyChomper.js
ig.baked=true;ig.module('game.entities.actor-enemyChomper').requires('game.entities.base-enemy').defines(function(){EntityActorEnemyChomper=EntityBaseEnemy.extend({animSheet:new ig.AnimationSheet('media/textures/chomper-lg.png',47,40),size:{x:24,y:20},offset:{x:+8,y:+10},friction:{x:150,y:0},speed:600,health:9,shootTimer:null,moveTimer:null,initTimer:null,newSpawnTimer:null,xModifier:100,initTime:2,shootDist:600,moveDist:1000,name:'enemyOrb',init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('fly',0.1,[0,1,2,1,0]);this.initTimer=new ig.Timer(this.initTime);this.shootTimer=new ig.Timer(this.randomFromTo(3,5));this.moveTimer=new ig.Timer(this.randomFromTo(2,4));this.newSpawnTimer=new ig.Timer(3);this.startAngle=this.ownAngle;this._angle=this.currentAnim.angle+3;this._increase=30;this.bullets=3;this.radius=3;this._entityBullet=EntityObjectEnemyBulletPurple;},update:function(){this.parent();this.handleMovement();this.shoot();},receiveDamage:function(value,from){this.parent(value,from);if(this.health>1){this.spawnParticles();}},shoot:function(){if(this.distanceTo(ig.game.player)<this.shootDist){this.shootBullets();}},handleMovement:function(){if(this.distanceTo(ig.game.player)>this.moveDist){this.moveToPlayer();}else{if(this.moveTimer.delta()>0){this.randomizeMovements();}}},spawnParticles:function(){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.yellow,this.particleKillCount,this.size.x);}});});﻿


// lib/game/entities/actor-enemyOrbBlue.js
ig.baked=true;ig.module('game.entities.actor-enemyOrbBlue').requires('game.entities.base-enemy').defines(function(){EntityActorEnemyOrbBlue=EntityBaseEnemy.extend({animSheet:new ig.AnimationSheet('media/textures/actor-enemyOrb.png#e2a6f5',30,30),size:{x:24,y:24},offset:{x:+2,y:+4},friction:{x:150,y:0},speed:600,health:7,shootTimer:null,moveTimer:null,initTimer:null,xModifier:100,initTime:2,shootDist:600,moveDist:1000,init:function(x,y,settings){this.parent(x,y,settings);this.tween({pos:{x:ig.system.width-400}},2,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();this.addAnim('fly',0.1,[0,1,2,3,4,3,2,1]);this.initTimer=new ig.Timer(this.initTime);this.shootTimer=new ig.Timer(this.randomFromTo(2,5.5));this.moveTimer=new ig.Timer(this.randomFromTo(1.5,4));this.startAngle=this.ownAngle;this._angle=241;this._increase=180;this.bullets=6;this.radius=5;this._entityBullet=EntityObjectEnemyBulletGreen;},update:function(){this.parent();this.parental=ig.game.enemySpawner;this.handleMovement();this.shoot();},receiveDamage:function(value,from){this.parent(value,from);if(this.health>1){ig.game.fragmentSpawner.spawn(this.pos.x,this.pos.y,FragmentSpawner.green,this.particleKillCount,this.size.x);}},shoot:function(){if(this.distanceTo(ig.game.player)<this.shootDist){this.shootBullets();}},handleMovement:function(){if(this.distanceTo(ig.game.player)>this.moveDist){this.moveToPlayer();}else{if(this.moveTimer.delta()>0){this.randomizeMovements();}}}});});﻿
﻿


// lib/game/entities/object-healthbar.js
ig.baked=true;ig.module('game.entities.object-healthbar').requires('impact.game','impact.entity','impact.background-map').defines(function(){EntityHealthBar=ig.Entity.extend({size:{x:32,y:5},animSheet:new ig.AnimationSheet('media/textures/HealthBar.png',32,5),Unit:0,init:function(x,y,settings){this.addAnim('Full',1,[0]);this.addAnim('Ninety',1,[1]);this.addAnim('Eighty',1,[2]);this.addAnim('Seventy',1,[3]);this.addAnim('Sixty',1,[4]);this.addAnim('Fifty',1,[5]);this.addAnim('Fourty',1,[6]);this.addAnim('Thirty',1,[7]);this.addAnim('Twenty',1,[8]);this.addAnim('Ten',1,[9]);this.addAnim('NearDeath',1,[10]);this.parent(x,y,settings);this.zIndex=6;},update:function(){this.pos.x=this.Unit.pos.x;this.pos.y=this.Unit.pos.y;if(this.Unit.health==this.Unit.MaxHealth){this.currentAnim=this.anims.Full;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.9)&&this.Unit.health<this.Unit.MaxHealth){this.currentAnim=this.anims.Ninety;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.8)&&this.Unit.health<(this.Unit.MaxHealth*.9)){this.currentAnim=this.anims.Eighty;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.7)&&this.Unit.health<(this.Unit.MaxHealth*.8)){this.currentAnim=this.anims.Seventy;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.6)&&this.Unit.health<(this.Unit.MaxHealth*.7)){this.currentAnim=this.anims.Sixty;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.5)&&this.Unit.health<(this.Unit.MaxHealth*.6)){this.currentAnim=this.anims.Fifty;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.4)&&this.Unit.health<(this.Unit.MaxHealth*.5)){this.currentAnim=this.anims.Fourty;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.3)&&this.Unit.health<(this.Unit.MaxHealth*.4)){this.currentAnim=this.anims.Thirty;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.2)&&this.Unit.health<(this.Unit.MaxHealth*.3)){this.currentAnim=this.anims.Twenty;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.1)&&this.Unit.health<(this.Unit.MaxHealth*.2)){this.currentAnim=this.anims.Ten;}
else if(this.Unit.health>0&&this.Unit.health<(this.Unit.MaxHealth*.1)){this.currentAnim=this.anims.NearDeath;}
else if(this.Unit.health<=0){this.kill();}}});});﻿


// lib/game/entities/object-healthbar-boss.js
ig.baked=true;ig.module('game.entities.object-healthbar-boss').requires('impact.game','impact.entity').defines(function(){EntityHealthBarBoss=ig.Entity.extend({size:{x:58,y:352},animSheet:new ig.AnimationSheet('media/textures/health-bar.png',58,352),Unit:0,init:function(x,y,settings){this.addAnim('Full',1,[0]);this.addAnim('Ninety',1,[1]);this.addAnim('Eighty',1,[2]);this.addAnim('Seventy',1,[3]);this.addAnim('Sixty',1,[4]);this.addAnim('Fifty',1,[5]);this.addAnim('Fourty',1,[6]);this.addAnim('Thirty',1,[7]);this.addAnim('Twenty',1,[8]);this.addAnim('Ten',1,[9]);this.addAnim('NearDeath',1,[10]);this.parent(x,y,settings);this.zIndex=6;this.tween({pos:{x:ig.system.width-96,y:96}},2,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();},update:function(){this.parent();if(this.Unit.health==this.Unit.MaxHealth){this.currentAnim=this.anims.Full;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.9)&&this.Unit.health<this.Unit.MaxHealth){this.currentAnim=this.anims.Ninety;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.8)&&this.Unit.health<(this.Unit.MaxHealth*.9)){this.currentAnim=this.anims.Eighty;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.7)&&this.Unit.health<(this.Unit.MaxHealth*.8)){this.currentAnim=this.anims.Seventy;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.6)&&this.Unit.health<(this.Unit.MaxHealth*.7)){this.currentAnim=this.anims.Sixty;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.5)&&this.Unit.health<(this.Unit.MaxHealth*.6)){this.currentAnim=this.anims.Fifty;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.4)&&this.Unit.health<(this.Unit.MaxHealth*.5)){this.currentAnim=this.anims.Fourty;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.3)&&this.Unit.health<(this.Unit.MaxHealth*.4)){this.currentAnim=this.anims.Thirty;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.2)&&this.Unit.health<(this.Unit.MaxHealth*.3)){this.currentAnim=this.anims.Twenty;}
else if(this.Unit.health>=(this.Unit.MaxHealth*.1)&&this.Unit.health<(this.Unit.MaxHealth*.2)){this.currentAnim=this.anims.Ten;}
else if(this.Unit.health>0&&this.Unit.health<(this.Unit.MaxHealth*.1)){this.currentAnim=this.anims.NearDeath;}
else if(this.Unit.health<=0){this.kill();}}});});

// lib/game/entities/actor-enemyBoss.js
ig.baked=true;ig.module('game.entities.actor-enemyBoss').requires('game.entities.base-enemy','game.entities.object-healthbar','game.entities.object-healthbar-boss').defines(function(){window.EntityActorEnemyBoss=EntityBaseEnemy.extend({animSheet:new ig.AnimationSheet('media/textures/animBossShipLg.png',248,362),destroyPorts:new ig.Image('media/textures/destroy-ports.png'),deathBlow:new ig.Image('media/textures/death-blow1.png'),name:'Boss',size:{x:80,y:140},offset:{x:140,y:110},vel:{x:-71,y:0},health:150,MaxHealth:150,bHasStopped:false,bWPExposed:false,canTakeDmg:false,shootTimer:null,moveTimer:null,animTimer:null,pullTimer:null,turRespawnTimer:null,newSpawnTimer:null,deathBlowTimer:null,lastHeardTimer:null,deathBlowTime:3,turrRespawnTime:6,animTime:4,xModifier:100,initTime:2,shootSpeed:0.1,rotation:1.4,rotTime:1,spawnTime:3,rotateTime:1,pullTime:2.2,pullVel:130,particleCnt:40,animSpeed:0.3,shakeVel:40,shakeTime:1,stopPos:300,pullPlayerDist:800,statTurretsArr:[],rotTurretsArr:[],WPArr:[],bSpawnWeakPt:true,bSpawnRot:true,bSpawnStat:true,bPulling:false,bCanCreateHealth:false,bHasDrawHealth:false,bSpawnAddRotTur:true,bCanDrawDeathBlow:false,bCreateDBTimer:true,isFilling:false,wasFilling:false,healthBars:null,type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.NEVER,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',0.1,[0]),true;this.animTimer=new ig.Timer(this.animTime);this.shootTimer=new ig.Timer(this.randomFromTo(3,5));this.moveTimer=new ig.Timer(this.randomFromTo(2,4));this.newSpawnTimer=new ig.Timer(this.spawnTime);this.lastShootTimer=new ig.Timer(0);this.rotateTimer=new ig.Timer(this.rotateTime);this.pullTimer=new ig.Timer(this.pullTime);this.lastHeardTimer=new ig.Timer(0.009);ig.game.boss=this;this.pos.y=ig.system.height/3;ig.music.crossFade(1.8,'bossMusic');this._angle=-500;this._increase=60;this.bullets=4
this.radius=10;this._entityBullet=EntityObjectEnemyBulletGreen;},update:function(){this.parent();this.parental=ig.game.enemySpawner;if(this.pos.x+this.stopPos<=this.parental.pos.x){this.vertMovement();this.checkAnims();this.checkHealth();this.checkCanTakeDmg();this.checkCanWPTakeDmg();this.checkBounds();this.bHasStopped=true}},createHealthBar:function(){if(this.bCanCreateHealth===true&&this.bHasDrawHealth===false){this.bCanCreateHealth=false;this.bHasDrawHealth=true;this.healthBars=ig.game.spawnEntity(EntityHealthBarBoss,0,0,{Unit:this});window.SoundSource.blastoff.play();}},draw:function(){this.parent();this.drawDestroyPorts();this.drawDeathBlowText();},drawDestroyPorts:function(){if(!this.bHasStopped){this.destroyPorts.draw(this.pos.x-380,this.pos.y-120)}},drawDeathBlowText:function(){if(this.deathBlowTimer){var d2=-this.deathBlowTimer.delta();var a2=d2>1.7?d2.map(2,1.7,0,1):(d2<1?d2:1);this.deathBlow.alpha=Math.max(a2,0);this.deathBlow.draw(this.pos.x-280,this.pos.y-120)
this.deathBlow.alpha=1;if(d2<0){this.deathBlowTimer=null;this.bCreateDBTimer=false;}}},checkHealth:function(){if(this.health<=150){this.checkSpawnStatTurrets();this.checkSpawnWeakPoints();this.checkSpawnRotTurrets();}if(this.health===110){ig.game.screenShaker.timedShake(this.shakeVel,this.shakeTime);}if(this.health<=110){this.pullPlayer()
this.checkSpawnRotTurrets();}if(this.health===70){ig.game.screenShaker.timedShake(this.shakeVel,this.shakeTime);}if(this.health<=70){this.shootBullets(-90,-14);}if(this.health===50){ig.game.screenShaker.timedShake(this.shakeVel,this.shakeTime);}if(this.health<=30){this.spawnAddRotTurrets();ig.game.screenShaker.timedShake(this.shakeVel,this.shakeTime);}if(this.health<=0){this.kill();}},vertMovement:function(){if(this.moveTimer.delta()>0){this.moveToPlayer();this.moveTimer.reset();}},checkBounds:function(){if(this.pos.x<=ig.system.width/.4){this.vel.x=0;}if(this.pos.y>=ig.system.height-280){this.pos.y=ig.system.height-280;}if(this.pos.y<=140){this.pos.y=140;}},checkSpawnStatTurrets:function(){if(this.bSpawnStat){this.statTurrets=ig.game.getEntitiesByType(EntityStatTurret);if(this.statTurrets.length===0){var topStatTur=this.statTurretsArr.push(ig.game.spawnEntity(EntityStatTurret,this.pos.x,this.pos.y,{xOffset:-140,yOffset:-26,shotDir:'up'}));var bottomStatTur=this.statTurretsArr.push(ig.game.spawnEntity(EntityStatTurret,this.pos.x,this.pos.y,{xOffset:-138,yOffset:160,shotDir:'down'}));}
this.bSpawnStat=false;}},checkSpawnRotTurrets:function(){if(this.bSpawnRot){this.rotTurrets=ig.game.getEntitiesByType(EntityRotTurret);if(this.rotTurrets.length===0){this.rotTurretsArr.push(ig.game.spawnEntity(EntityRotTurret,this.pos.x,this.pos.y,{yOffset:200,xOffset:-80,shotDir:'down'}));this.rotTurretsArr.push(ig.game.spawnEntity(EntityRotTurret,this.pos.x,this.pos.y,{yOffset:-200,xOffset:-80,shotDir:'down',rotAngle:'-'}));}
this.bSpawnRot=false;}},checkSpawnWeakPoints:function(){if(this.bSpawnWeakPt){this.entityWeakPoints=ig.game.getEntitiesByType(EntityWeakPoint);if(this.entityWeakPoints.length===0){var topWP=this.WPArr.push(ig.game.spawnEntity(EntityWeakPoint,this.pos.x,this.pos.y,{xOffset:0,yOffset:-97}));var centerWP=this.WPArr.push(ig.game.spawnEntity(EntityWeakPoint,this.pos.x,this.pos.y,{xOffset:-64,yOffset:+30}));var bottomWP=this.WPArr.push(ig.game.spawnEntity(EntityWeakPoint,this.pos.x,this.pos.y,{xOffset:0,yOffset:+156}));}}
this.bSpawnWeakPt=false;},spawnAddRotTurrets:function(){if(this.bspawnAddRotTur){this.rotTurretsArr.push(ig.game.spawnEntity(EntityRotTurret,this.pos.x,this.pos.y,{yOffset:200,xOffset:-80,shotDir:'down'}));this.rotTurretsArr.push(ig.game.spawnEntity(EntityRotTurret,this.pos.x,this.pos.y,{yOffset:-200,xOffset:-80,shotDir:'down',rotAngle:'-'}));}
this.bspawnAddRotTur=false;},checkAnims:function(){if(!this.bWPExposed&&this.animTimer.delta()>0){this.currentAnim=this.addAnim('opening',this.animSpeed,[0,1,2,3,4],true);this.bWPExposed=true;this.animTimer.set(this.animTime);}
if(this.bWPExposed&&this.animTimer.delta()>0){this.currentAnim=this.addAnim('closing',this.animSpeed,[4,3,2,1,0],true);this.bWPExposed=false;this.animTimer.set(this.animTime);}},checkCanTakeDmg:function(){var length=ig.game.getEntitiesByType(EntityWeakPoint).length;if(length==0){this.canTakeDmg=true;this.type=ig.Entity.TYPE.B;this.bCanCreateHealth=true;this.createHealthBar();this.bCanDrawDeathBlow=true;if(this.bCanDrawDeathBlow===true&&this.bCreateDBTimer===true){if(!this.deathBlowTimer){this.deathBlowTimer=new ig.Timer(this.deathBlowTime);}}}},checkCanWPTakeDmg:function(){for(var i=0;i<this.WPArr.length;i++){if(this.bWPExposed===true){this.WPArr[i].canTakeDmg=true;}else{this.WPArr[i].canTakeDmg=false;}}},pullPlayer:function(){if(this.distanceTo(ig.game.player)<this.pullPlayerDist){if(!this.bPulling&&this.pullTimer.delta()>0){this.bPulling=true;ig.game.screenShaker.timedShake(25,this.pullTime);this.pullTimer.reset();}if(this.bPulling&&this.pullTimer.delta()>0){this.bPulling=false;this.pullTimer.reset();}
if(ig.game.player.pos.x>this.pos.x){this.bPulling=false;}}
if(this.bPulling){ig.game.player.vel.x=this.pullVel;}else{ig.game.player.vel.x=ig.game.player.vel.x;}},receiveDamage:function(value,from){if(this.canTakeDmg===false){return;}else{this.parent(value,from);if(this.health>1){this.spawnParticles();}}},spawnParticles:function(){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.grey,this.particleCnt,this.size.x);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.red,this.particleCnt,this.size.x);},kill:function(){ig.game.mode=window.RType.MODE.GAME_OVER;ig.game.createGameOverScreen();this.parent();}});EntityStatTurret=EntityBaseEnemy.extend({animSheet:new ig.AnimationSheet('media/textures/actor-playerShip-invis.png',24,24),font:new ig.Font('media/fonts/xfinFont.png'),size:{x:20,y:20},offset:{x:0,y:0},friction:{x:800,y:800},maxVel:{x:300,y:300},angle:-Math.PI/2,speed:200,health:12,respawnDelay:2,shootFreq:0.35,rotation:1.4,rotDist:0.4,shotLength:1.9,particleCnt:30,lifeTimer:null,xOffset:null,yOffset:null,shotDir:'up',type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.C,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',60,[0]);this.addAnim('shoot',0.05,[3,2,1,0],true);this.lastShootTimer=new ig.Timer(0);this.shotDir=settings.shotDir||'up';this.xOffset=settings.xOffset||this.xOffset;this.yOffset=settings.yOffset||this.yOffset;},update:function(){if(this.currentAnim.loopCount>0){this.currentAnim=this.anims.idle;}
this.parent();this.parental=ig.game.boss;this.pos.x=this.parental.pos.x+this.xOffset;this.pos.y=this.parental.pos.y+this.yOffset;this.adjShootAngle();},adjShootAngle:function(){if((0|(ig.Timer.time*1))&1){this.currentAnim.angle-=this.rotation*ig.system.tick;if(this.shotDir==='up'){this.checkShoot();}}else{this.currentAnim.angle+=this.rotation*ig.system.tick;if(this.shotDir==='down'){this.checkShoot();}}},checkShoot:function(){var isShooting=true;if(isShooting&&this.lastShootTimer.delta()>0){this.shoot();this.lastShootTimer.set(this.shootFreq);}},receiveDamage:function(value,from){this.parent(value,from);if(this.health>1){this.spawnParticles();}},shoot:function(){ig.game.spawnEntity(EntityEnemyTurretBullet,this.pos.x,this.pos.y,{angle:this.currentAnim.angle});},kill:function(){this.spawnParticles();ig.game.screenShaker.timedShake(50,1);window.SoundSource.teleport.play();this.parent();},spawnParticles:function(){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.grey,this.particleCnt,this.size.x);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.blue,this.particleCnt,this.size.x);}});EntityRotTurret=EntityBaseEnemy.extend({animSheet:new ig.AnimationSheet('media/textures/chomper-lg.png',47,40),size:{x:24,y:20},offset:{x:+8,y:+10},font:new ig.Font('media/fonts/xfinFont.png'),bulletImage:new ig.Image('media/textures/plasma_b_R.png'),friction:{x:800,y:800},maxVel:{x:300,y:300},angle:-Math.PI/2,speed:200,health:10,respawnDelay:2,shootFreq:1,rotSpeed:.03,lifeTimer:null,radius:100,shotDir:'up',rotAngle:'+',xOffset:null,yOffset:null,particleCnt:30,type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.C,init:function(x,y,settings){this.parent(x,y,settings);this.lastShootTimer=new ig.Timer(0);this.addAnim('fly',0.1,[0,1,2,1,0]);this.xOffset=settings.xOffset||this.xOffset;this.yOffset=settings.yOffset||this.yOffset;this.shotDir=settings.shotDir||this.shotDir;this.rotAngle=settings.rotAngle||this.rotAngle;this.radius=settings.radius||this.radius;this.bulletImage=settings.bulletImage||this.bulletImage;},update:function(){this.parent();this.parental=ig.game.boss;this.checkShoot();var x=(this.parental.pos.x+this.parental.size.x/2)+Math.cos(this.angle)*this.radius;var y=(this.parental.pos.y+this.parental.size.y/2)+Math.sin(this.angle)*this.radius;this.pos.x=x+this.xOffset;this.pos.y=y+this.yOffset;this.setRotAngle();},setRotAngle:function(rotAngle){if(this.rotAngle==='+'){this.angle=this.angle+=this.rotSpeed;}else{this.angle=this.angle-=this.rotSpeed;}},checkShoot:function(){var isShooting=true;if(isShooting&&this.lastShootTimer.delta()>0){this.shoot();this.lastShootTimer.set(this.shootFreq);}},shoot:function(){ig.game.spawnEntity(EntityEnemyTurretBullet,this.pos.x,this.pos.y+9,{angle:-this.currentAnim.angle,image:this.bulletImage});},kill:function(){this.spawnParticles();ig.game.screenShaker.timedShake(50,1);window.SoundSource.teleport.play();this.parent();},spawnParticles:function(){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.grey,this.particleCnt,this.size.x);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.yellow,this.particleCnt,this.size.x);},receiveDamage:function(value,from){this.parent(value,from);if(this.health>1){this.spawnParticles();window.SoundSource.hit.play();}}});EntityWeakPoint=EntityBaseEnemy.extend({size:{x:38,y:80},xOffset:null,yOffset:null,health:8,MaxHealth:8,canTakeDmg:true,type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.C,collides:ig.Entity.COLLIDES.NEVER,init:function(x,y,settings){this.parent(x,y,settings);this.xOffset=settings.xOffset||this.xOffset;this.yOffset=settings.yOffset||this.yOffset;ig.game.spawnEntity(EntityHealthBar,this.pos.x,this.pos.y,{Unit:this});},update:function(){this.parent();this.parental=ig.game.boss;this.pos.x=this.parental.pos.x+this.xOffset;this.pos.y=this.parental.pos.y+this.yOffset;},kill:function(){this.spawnParticles();SoundSource.teleport.play();ig.game.screenShaker.applyImpulse(150,300);this.parent();},receiveDamage:function(value,from){if(this.canTakeDmg===false){return;}
this.parent(value,from);if(this.health>1){this.spawnParticles();SoundSource.hit.play();}},spawnParticles:function(){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.grey,this.particleCnt,this.size.x);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.blue,this.particleCnt,this.size.x);}});EntityEnemyTurretBullet=ig.Entity.extend({image:new ig.Image('media/textures/bossRoundBulletSingle.png'),speed:{x:5800,y:300},size:{x:30,y:30},offset:{x:0,y:0},friction:{x:0,y:15},speedModifier:5,angle:null,type:ig.Entity.TYPE.C,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.PASSIVE,init:function(x,y,settings){var noArgs=(arguments.length==0);this.parent(x,y,settings);this.vel.x=Math.cos(this.angle)*this.speed.x;this.vel.y=Math.sin(this.angle)*this.speed.y;this.bulletCount=(settings&&settings.bulletCount)?settings.bulletCount:0;this.image=(settings&&settings.image)?settings.image:new ig.Image('media/textures/bossRoundBulletSingle.png');},draw:function(){ig.system.context.save();ig.system.context.translate(this.pos.x-ig.game._rscreen.x,this.pos.y-ig.game._rscreen.y);ig.system.context.rotate(-this.angle);ig.system.context.drawImage(this.image.data,-this.offset.x,-this.offset.y);ig.system.context.restore();},update:function(){this.parent();this.pos.x-=this.vel.x*ig.system.tick*this.speedModifier;this.pos.y+=this.vel.y*ig.system.tick/2;if(this.pos.x>ig.system.width+50||this.pos.y>ig.system.height+50||this.pos.x<-50||this.pos.y<-50){this.kill();}},check:function(other){if(other instanceof EntityActorPlayer){other.receiveDamage(1,this);this.kill();}}});});

// lib/plugins/PathFollower.js
ig.baked=true;ig.module('plugins.PathFollower').requires('plugins.Path').defines(function(){window.ga=window.ga||{};ga.pathFollowerDefaultParameters={path:null,pathSpeed:40,loopCount:0,onPathEnd:null,computeAngle:false,shift:null};ga.PathFollower=function(parameters){var err=null;if(!parameters.path){err=' path parameter cannot be null or undefined';}
if(!err&&(parameters.path.length<4)||(parameters.path.length&1)){err=' path length must be even and >=4';}
if(err)throw('error in PathFollower :'+err);for(var p in ga.pathFollowerDefaultParameters){this[p]=parameters[p]||ga.pathFollowerDefaultParameters[p];}
this.path.finalize(!!this.shift);this.x=this.path[0];this.y=this.path[0];this.angle=0;this.ended=false;this._pathIndex=0;this._ratio=0;return this;};ga.PathFollower.prototype={move:function(dt){if(this.ended){return;}
var distance=Math.abs(dt*this.pathSpeed);var sign=(this.pathSpeed>0)?2:-2;var thisSegLength=0,remainingthisSegLength=0;var segmentsLength=this.path.segmentsLength;while(distance>0){thisSegLength=segmentsLength[this._pathIndex>>1];if(sign>0){if(this._ratio==0)remainingthisSegLength=thisSegLength;else remainingthisSegLength=(1-this._ratio)*thisSegLength;}else{if(this._ratio==1)remainingthisSegLength=thisSegLength;else remainingthisSegLength=this._ratio*thisSegLength;}
if(remainingthisSegLength<distance){distance-=remainingthisSegLength;this._ratio=(sign>0)?0:1;if((sign<0&&this._pathIndex==0)||(sign>0&&this._pathIndex==this.path.length-4)){if(this.onPathEnd){this.onPathEnd.call(null,this,this.loopCount>0?this.loopCount-1:this.loopCount);}
if(!this.loopCount){this.ended=true;return};if(this.loopCount>0)this.loopCount--;this.pathSpeed=-this.pathSpeed;this._ratio=(this.pathSpeed>0)?0:1;sign=(this.pathSpeed>0)?2:-2;continue;}
this._pathIndex+=sign;}else{var _ratio=distance/thisSegLength;this._ratio+=(sign>0)?_ratio:-_ratio;break;}}
this.path.interpolate(this._pathIndex,this._ratio,(sign<0),tempPoint);this.x=tempPoint.x;this.y=tempPoint.y;if(this.adjustAngle){this.angle=Math.atan2((this.path[this._pathIndex+3]-this.path[this._pathIndex+1]),(this.path[this._pathIndex+2]-this.path[this._pathIndex]));}
if(this.shift){this.x+=this.shift.x*this.normalizedSegments[this._pathIndex+1];this.y+=this.shift.y*this.normalizedSegments[this._pathIndex];}},drawPath:function(ctx,color){this.path.draw(ctx,color);}};var tempPoint={x:0,y:0};function sq(x){return x*x};});

// lib/game/entities/actor-follower.js
ig.baked=true;ig.module('game.entities.actor-follower').requires('impact.entity','plugins.Path','plugins.PathFollower').defines(function(){EntityfollowerParameters={path:null,pathSpeed:0,loop:0,rank:0,spawnDelay:0,followScreen:false,relativeTo:null,onPathEnd:null,adjustAngle:false,shift:null,createFollower:false};var followerParameters={};EntityFollower=ig.Entity.extend({path:null,pathSpeed:0,loop:0,rank:0,spawnDelay:0,followScreen:false,relativeTo:null,onPathEnd:null,adjustAngle:false,shift:null,createFollower:false,_finalType:0,_finalCheckAgainst:0,_finalCollides:0,_oldDraw:null,_spawnTimer:null,_pathFollower:null,init:function(x,y,settings){this.parent(x,y,settings);if(this.createFollower===true){if(settings.spawnDelay){this._hide();this._spawnTimer=new ig.Timer(this.spawnDelay);}
followerParameters={};for(var p in ga.pathFollowerDefaultParameters){followerParameters[p]=settings[p]||ga.pathFollowerDefaultParameters[p];}
followerParameters.pathSpeed=followerParameters.pathSpeed*1e-3;if(settings.adjustAngle){followerParameters.computeAngle=settings.adjustAngle}
var onPathEnd=null;if(settings.onPathEnd){onPathEnd=function(pthfllwr,remloopCount){settings.onPathEnd(this,remloopCount)};followerParameters.onPathEnd=onPathEnd;}
this._pathFollower=new ga.PathFollower(followerParameters);this.pos.x=this._pathFollower.x;this.pos.y=this._pathFollower.y;}},update:function(){if(this.createFollower===true){if(this._spawnTimer){if(this._spawnTimer.delta()<0)return;this._show();this._spawnTimer=null;}
if(this._pathFollower.ended){this.killedByScreen();return;}
this._pathFollower.move(ig.system.tick*1e3);this.pos.x=this._pathFollower.x;this.pos.y=this._pathFollower.y;this.parent();}else{this.parent();}},draw:function(){if(this.createFollower===true){this.parent();}else{this.parent();}},drawDebugLines:function(){this._pathFollower.drawPath(ig.system.context,'#FEA');},drawFollower:function(){var ctx=ig.system.context;ctx.save();ctx.scale(ig.system.scale,ig.system.scale);ctx.fillStyle='#FEA';ctx.fillRect(this.pos.x,this.pos.y,this.size.x,this.size.y);ctx.restore();},_hide:function(){this._oldDraw=this.draw;this._finalType=this.type;this._finalCheckAgainst=this.checkAgainst;this._finalCollides=this.collides;this.draw=voidFunction;this.type=ig.Entity.TYPE.NONE;this.checkAgainst=ig.Entity.TYPE.NONE;this.collides=ig.Entity.COLLIDES.NEVER;},_show:function(){this._killed=false;this.draw=this._oldDraw;this.type=this._finalType;this.checkAgainst=this._finalCheckAgainst;this.collides=this._finalCollides;},killedByScreen:function(){ig.game.enemies.current--;ig.game.removeEntity(this);}});function voidFunction(){};});

// lib/game/entities/actor-testFollower.js
ig.baked=true;ig.module('game.entities.actor-testFollower').requires('game.entities.base-enemy').defines(function(){EntityTestFollower=EntityBaseEnemy.extend({animSheet:new ig.AnimationSheet('media/textures/actor-enemyOrb.png',30,30),size:{x:24,y:24},offset:{x:+2,y:+4},friction:{x:150,y:0},speed:600,health:9,shootTimer:null,moveTimer:null,initTimer:null,newSpawnTimer:null,xModifier:100,initTime:2,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('fly',0.1,[0,1,2,3,4,3,2,1]);this.initTimer=new ig.Timer(this.initTime);this.shootTimer=new ig.Timer(this.randomFromTo(1,3));this.newSpawnTimer=new ig.Timer(3);this.startAngle=this.ownAngle;this._angle=-500;this._increase=60;this.bullets=3;this.radius=10;this._entityBullet=EntityObjectEnemyBulletGreen;},update:function(){this.parent();this.shootBullets();},receiveDamage:function(value,from){this.parent(value,from);if(this.health>1){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.yellow,this.particleKillCount,this.size.x);}}});});

// lib/game/entities/actor-enemySpawner.js
ig.baked=true;ig.module('game.entities.actor-enemySpawner').requires('game.entities.base-enemy','game.entities.actor-enemyKamikaze','game.entities.actor-enemyKamikazeComp','game.entities.actor-enemyChomper','game.entities.actor-enemyOrbBlue','game.entities.actor-enemyBoss','game.entities.actor-follower','game.entities.actor-testFollower').defines(function(){EntityActorEnemySpawner=EntityBaseEnemy.extend({animSheet:new ig.AnimationSheet('media/textures/pu_BulletTime.png',18,17),startPosition:null,spawnTimer:null,bossEndTimer:null,health:90000,canSpawnEnemies:true,bCanSpawnBoss:true,name:'enemySpawner',size:{x:1,y:1},init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',60,[0]);ig.game.enemies.current--;this.spawnTimer=new ig.Timer(this.randomFromTo(ig.game.spawnTime.min,ig.game.spawnTime.max));this.randomSpawnLocY=this.randomFromTo(ig.system.height-20,ig.system.height/20);this.initTimer=new ig.Timer(3);},update:function(){this.setPosition();this.checkBoss();if(this.spawnTimer.delta()>0&&!this.initTimer){this.spawnEnemy();}
this.enemiesAlwaysOnScreen();this.removeInitTimer();},setPosition:function(){this.parent=ig.game.player;this.pos.x=ig.system.width+50;this.pos.y=ig.system.height/2;},removeInitTimer:function(){if(this.initTimer&&this.initTimer.delta()>0){this.initTimer=null;}},spawnEnemy:function(){if(ig.game.enemies.current<ig.game.enemies.max){var rndNum=this.randomFromTo(1,11);if(ig.game.stats.kills<ig.game.bossSpawnKills){switch(rndNum){case 1:ig.game.spawnEntity(EntityActorEnemyOrbBlue,this.pos.x,this.randomSpawnLocY);this.spawnTimer.reset();break;case 2:ig.game.spawnEntity(EntityActorEnemyChomper,this.pos.x,this.randomSpawnLocY);this.spawnTimer.reset();break;case 3:ig.game.spawnEntity(EntityActorEnemyKamikaze,this.pos.x,this.randomSpawnLocY);this.spawnTimer.reset();break;case 4:ig.game.spawnEntity(EntityActorEnemyKamikazeComp,this.pos.x,this.randomSpawnLocY);this.spawnTimer.reset();break;case 5:ig.game.createPathOne();this.spawnTimer.reset();break;case 6:ig.game.createPathTwo();this.spawnTimer.reset();break;case 7:ig.game.createPathThree();this.spawnTimer.reset();break;case 8:ig.game.createPathFour();this.spawnTimer.reset();break;case 9:ig.game.createPathFive();this.spawnTimer.reset();break;case 10:ig.game.spawnEntity(EntityActorEnemyKamikazeComp,this.pos.x,this.randomSpawnLocY);this.spawnTimer.reset();break;case 11:ig.game.spawnEntity(EntityActorEnemyKamikazeComp,this.pos.x,this.randomSpawnLocY);this.spawnTimer.reset();break;default:this.spawnTimer.reset();break;}}else{this.canSpawnEnemies=false;}}},enemiesAlwaysOnScreen:function(){if(!this.initTimer){var enemies=ig.game.getEntitiesByType(EntityBaseEnemy);if(enemies.length===1&&this.canSpawnEnemies===true){this.spawnEnemy();}}},receiveDamage:function(value){return;},wipeRemainingEnemies:function(){var allEnemies=ig.game.getEntitiesByType(EntityBaseEnemy);if(allEnemies.length>0){for(var i=0;i<allEnemies.length;i++){ig.game.removeEntity(allEnemies[i]);}}},checkBoss:function(){if(ig.game.stats.kills>=ig.game.bossSpawnKills){var allBosses=ig.game.getEntitiesByType(EntityActorEnemyBoss);if(allBosses.length===0&&this.bCanSpawnBoss===true){this.wipeRemainingEnemies();this.spawnBoss();}}},spawnBoss:function(){ig.game.spawnEntity(EntityActorEnemyBoss,this.pos.x,this.pos.y);this.bCanSpawnBoss=false;}});});﻿
﻿


// lib/game/entities/object-turretBullet.js
ig.baked=true;ig.module('game.entities.object-turretBullet').requires('impact.entity','impact.sound').defines(function(){EntityTurretBullet=ig.Entity.extend({image:new ig.Image('media/textures/plasma_g.png'),speed:{x:5800,y:1000},size:{x:8,y:6},offset:{x:20,y:16},friction:{x:0,y:15},speedModifier:5,type:ig.Entity.TYPE.C,checkAgainst:ig.Entity.TYPE.B,collides:ig.Entity.COLLIDES.PASSIVE,init:function(x,y,settings){this.parent(x,y,settings);var noArgs=(arguments.length==0);this.vel.x=Math.cos(this.angle)*this.speed.x;this.vel.y=Math.sin(this.angle)*this.speed.y;},draw:function(){ig.system.context.save();ig.system.context.translate(this.pos.x-ig.game._rscreen.x,this.pos.y-ig.game._rscreen.y);ig.system.context.rotate(this.angle);ig.system.context.drawImage(this.image.data,-this.offset.x,-this.offset.y);ig.system.context.restore();},update:function(){this.parent();this.pos.x+=this.vel.x*ig.system.tick*this.speedModifier;this.pos.y+=this.vel.y*ig.system.tick/2;if(this.pos.x>ig.system.width+50||this.pos.y>ig.system.height+50||this.pos.x<-50||this.pos.y<-50){this.kill();}},check:function(other){if(other instanceof EntityBaseEnemy){other.receiveDamage(1,this);this.kill();}}});});

// lib/game/entities/actor-turret.js
ig.baked=true;ig.module('game.entities.actor-turret').requires('game.entities.base-player','game.entities.object-turretBullet').defines(function(){EntityTurret=ig.Entity.extend({animSheet:new ig.AnimationSheet('media/textures/playerShip.png',44,50),font:new ig.Font('media/fonts/xfinFont.png'),size:{x:20,y:20},offset:{x:20,y:16},friction:{x:800,y:800},maxVel:{x:300,y:300},angle:-Math.PI/2,speed:200,health:9000,respawnDelay:2,shootSpeed:0.03,rotation:1.4,lifeTime:7,lifeTimer:null,type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',60,[0]);this.addAnim('shoot',0.05,[0,1],true);this.lastShootTimer=new ig.Timer(0);this.lifeTimer=new ig.Timer(this.lifeTime);SoundSource.miniShipSpawn.play();ig.game.turrets.current--;},update:function(){if(this.currentAnim.loopCount>0){this.currentAnim=this.anims.idle;}
this.parent();this.collisionDetection();this.checkShoot();if((0|(ig.Timer.time*1.5))&1){this.currentAnim.angle-=this.rotation*ig.system.tick;}else{this.currentAnim.angle+=this.rotation*ig.system.tick;}
if(this.lifeTimer.delta()>0){this.kill();}},collisionDetection:function(){if(this.pos.x<0){this.pos.x=0;}else if(this.pos.x>ig.system.width){this.pos.x=ig.system.width;}
if(this.pos.y<0){this.pos.y=0;}else if(this.pos.y>ig.system.height){this.pos.y=ig.system.height;}},checkShoot:function(){var isShooting=true;if(isShooting&&this.lastShootTimer.delta()>0){this.shoot();this.lastShootTimer.set(this.shootSpeed);}},shoot:function(){this.currentAnim=this.anims.shoot.rewind();ig.game.spawnEntity(EntityTurretBullet,this.pos.x-1,this.pos.y-1,{angle:this.currentAnim.angle});},kill:function(){ig.game.turrets.current--;var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.grey,80,this.size.x,2);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.red,80,this.size.x,2);SoundSource.miniShipKill.play();this.parent();}});});

// lib/game/entities/actor-player.js
ig.baked=true;ig.module('game.entities.actor-player').requires('game.entities.base-player','game.entities.actor-companion','game.entities.actor-enemySpawner','game.entities.actor-turret').defines(function(){EntityActorPlayer=EntityBasePlayer.extend({animSheet:new ig.AnimationSheet('media/textures/playerShip.png',44,50),font:new ig.Font('media/fonts/xfinFont.png'),boxAroundPlayer:new ig.Image('media/textures/box-around-player.png'),size:{x:20,y:20},offset:{x:20,y:16},friction:{x:800,y:600},angle:-Math.PI/2,speed:320,health:1,particleCnt:100,slowMoDelay:3,bBossText:false,pu_BT_TextTimer:null,pu_BT_TurretTimer:null,pu_Life_TextTimer:null,turretSpawnTimer:null,compSpawnTimer:null,invincible:true,invincibleTimer:null,invincibleDelay:2.5,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',60,[0]);this.addAnim('shoot',0.05,[0,1],true);ig.game.player=this;this.lastShootTimer=new ig.Timer(0);this.compSpawnTimer=new ig.Timer(0);this.turretSpawnTimer=new ig.Timer(0);this.tween({pos:{x:300}},1.5,{easing:ig.Tween.Easing.Sinusoidal.EaseOut}).start();this.invincibleTimer=new ig.Timer();this.initTimer=new ig.Timer(2.5);SoundSource.miniShipSpawn.play();this.makeInvincible();this.livesRemainingTimer=new ig.Timer(3);this.bossTextTimer=new ig.Timer();this.slowMoTimer=new ig.Timer(0);},draw:function(){this.setAlpha();this.parent();this.drawBulletTimeText();this.drawUI();this.drawBossText();this.draw_pu_BU_Text();this.draw_pu_Life_Text();this.draw_pu_Turret_Text();this.drawRespawnBox();},setAlpha:function(){this.currentAnim.alpha=(this.invincible)?0:1;if(this.invincible){this.currentAnim.alpha=(((10*this.invincibleTimer.delta()/this.invincibleDelay)%1)>0.5?0.5:1);}},update:function(){this.parent();this.checkAnims();this.handleDesktopInput();this.collisionDetection();this.spawnCompanion();this.spawnTurret();this.checkInvincible();this.checkDrawBossText();},checkInvincible:function(){if(this.invincibleTimer.delta()>this.invincibleDelay){this.invincible=false;this.visible=true;this.currentAnim.alpha-1;}},checkAnims:function(){if(this.currentAnim.loopCount>0){this.currentAnim=this.anims.idle;}},checkDrawBossText:function(){if(ig.game.stats.kills+5===ig.game.bossSpawnKills&&this.bBossText==false){this.bossTextTimer=new ig.Timer(5);this.bBossText=true;}},drawRespawnBox:function(){if(this.initTimer){var d2=-this.initTimer.delta();var a2=d2>2.7?d2.map(2,2.7,0,1):(d2<1?d2:1);this.font.alpha=Math.max(a2,0);this.font.draw('Player',this.pos.x+10,this.pos.y-70,ig.Font.ALIGN.CENTER);this.font.alpha=1;if(d2<0){this.initTimer=null;}}},draw_pu_BU_Text:function(){if(this.pu_BT_TextTimer){var d2=-this.pu_BT_TextTimer.delta();var a2=d2>2.7?d2.map(2,2.7,0,1):(d2<1?d2:1);var xs2=ig.system.width/2;var ys2=ig.system.height/3+(d2<1?Math.cos(1-d2).map(1,0,0,250):0);this.font.alpha=Math.max(a2,0);this.font.draw('Bullet Time picked up!',xs2,ys2,ig.Font.ALIGN.CENTER);this.font.alpha=1;if(d2<0){this.pu_BT_TextTimer=null;}}},draw_pu_Life_Text:function(){if(this.pu_Life_TextTimer){var d2=-this.pu_Life_TextTimer.delta();var a2=d2>2.7?d2.map(2,2.7,0,1):(d2<1?d2:1);var xs2=ig.system.width/2;var ys2=ig.system.height/3+(d2<1?Math.cos(1-d2).map(1,0,0,250):0);this.font.alpha=Math.max(a2,0);this.font.draw('One Up!',xs2,ys2,ig.Font.ALIGN.CENTER);this.font.alpha=1;if(d2<0){this.pu_Life_TextTimer=null;}}},draw_pu_Turret_Text:function(){if(this.pu_BT_TurretTimer){var d2=-this.pu_BT_TurretTimerdelta();var a2=d2>2.7?d2.map(2,2.7,0,1):(d2<1?d2:1);var xs2=ig.system.width/2;var ys2=ig.system.height/3+(d2<1?Math.cos(1-d2).map(1,0,0,250):0);this.font.alpha=Math.max(a2,0);this.font.draw('Turret Acquired!',xs2,ys2,ig.Font.ALIGN.CENTER);this.font.alpha=1;if(d2<0){this.pu_BT_TurretTimerr=null;}}},shoot:function(){SoundSource.shoot.play();this.currentAnim=this.anims.shoot.rewind();var angle=-Math.PI/2+Math.random()*0.03-0.01;ig.game.spawnEntity(EntityPlayerBullet,this.pos.x-1,this.pos.y+6,{angle:angle});},kill:function(){this.onDeath();this.parent();this.spawnParticles();},spawnParticles:function(){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.grey,this.particleCnt,this.size.x);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.red,this.particleCnt,this.size.x);},onDeath:function(){ig.game.stats.deaths++;ig.game.stats.lives--;ig.game.screenShaker.applyImpulse(400,700);this.killAllCompanions();if(ig.game.stats.lives<=0){ig.game.mode=window.RType.MODE.GAME_OVER;ig.game.createGameOverScreen();}
else{this.respawn();this.livesRemainingTimer=new ig.Timer(2);}},killAllCompanions:function(){var companions=ig.game.getEntitiesByType(EntityCompanion);for(var i=0;i<companions.length;i++){companions[i].kill();}
var turrets=ig.game.getEntitiesByType(EntityTurret);for(var i=0;i<turrets.length;i++){turrets[i].kill();}},respawn:function(){ig.game.spawnEntity(EntityActorPlayer,10,ig.system.height/2);}});});﻿


// lib/game/entities/object-pu-bulletTime.js
ig.baked=true;ig.module('game.entities.object-pu-bulletTime').requires('impact.entity','impact.sound').defines(function(){EntityObjectPickupBulletTime=ig.Entity.extend({animSheet:new ig.AnimationSheet('media/textures/pu_BulletTime.png',42,41),font:new ig.Font('media/fonts/xfinFont.png'),size:{x:30,y:30},vel:{x:-75,y:0},health:100000,speed:-75,type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.PASSIVE,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',.1,[0]);},update:function(){this.parent();if(this.pos.x>ig.system.width+50||this.pos.y>ig.system.height+50||this.pos.x<-50||this.pos.y<-50){this.kill();}
if((0|(ig.Timer.time*.3))&1){this.vel.y=65;}else{this.vel.y=-65;}},draw:function(){this.parent();if((0|(ig.Timer.time*1.5))&1){this.font.draw('Bullet Time!',this.pos.x+22,this.pos.y-20,ig.Font.ALIGN.CENTER);}else{return;}},check:function(other){other.receiveDamage(0,this);if(ig.game.bulletTime.current<ig.game.bulletTime.max){ig.game.bulletTime.current++;this.pickup_sfx.play();SoundSource.pickup.play();ig.game.player.pu_BT_TextTimer=new ig.Timer(3);}
this.kill();}});});﻿


// lib/game/entities/object-pu-miniship.js
ig.baked=true;ig.module('game.entities.object-pu-miniship').requires('impact.entity','impact.sound','game.entities.actor-player').defines(function(){EntityObjectPuMiniShip=ig.Entity.extend({animSheet:new ig.AnimationSheet('media/textures/PickupMiniShip.png',34,35),font:new ig.Font('media/fonts/xfinFont.png'),size:{x:30,y:30},vel:{x:-60,y:0},health:100000,speed:-75,type:ig.Entity.TYPE.C,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.PASSIVE,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',.1,[0]);},update:function(){this.parent();this.player=ig.game.player;if(this.pos.x>ig.system.width+50||this.pos.y>ig.system.height+50||this.pos.x<-50||this.pos.y<-50){this.kill();}
if((0|(ig.Timer.time*.3))&1){this.vel.y=65;}else{this.vel.y=-65;}},draw:function(){this.parent();if((0|(ig.Timer.time*1.5))&1){this.font.draw('Mini-ship!',this.pos.x+16,this.pos.y-28,ig.Font.ALIGN.CENTER);}else{return}},check:function(other){other.receiveDamage(0,this);if(ig.game.companions.current<ig.game.companions.max){ig.game.spawnEntity(EntityCompanion,ig.game.player.pos.x,ig.game.player.y);}
this.kill();}});});﻿


// lib/game/entities/object-pu-life.js
ig.baked=true;ig.module('game.entities.object-pu-life').requires('impact.entity','impact.sound','game.entities.actor-player').defines(function(){EntityObjectPulife=ig.Entity.extend({animSheet:new ig.AnimationSheet('media/ui/Ship-Lifebar-PU.png',28,28),size:{x:30,y:30},vel:{x:-30,y:0},health:100000,speed:-75,type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.PASSIVE,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',.1,[0,1,2,1]);},update:function(){this.parent();this.player=ig.game.player;if(this.pos.x>ig.system.width+50||this.pos.y>ig.system.height+50||this.pos.x<-50||this.pos.y<-50){this.kill();}
if((0|(ig.Timer.time*.3))&1){this.vel.y=65;}else{this.vel.y=-65;}},draw:function(){this.parent();if((0|(ig.Timer.time*1.5))&1){this.font.draw('Extra Ship!',this.pos.x+22,this.pos.y-20,ig.Font.ALIGN.CENTER);}else{return;}},check:function(other){other.receiveDamage(0,this);if(ig.game.stats.lives<ig.game.stats.maxLives){ig.game.stats.lives++;SoundSource.pickup.play();ig.game.player.pu_Life_TextTimer=new ig.Timer(2);}
this.kill();}});});

// lib/game/entities/object-pu-missile.js
ig.baked=true;ig.module('game.entities.object-pu-missile').requires('impact.entity','impact.sound','game.entities.actor-player').defines(function(){EntityObjectPickupMissile=ig.Entity.extend({animSheet:new ig.AnimationSheet('media/textures/missile-pickup.png',40,41),font:new ig.Font('media/fonts/xfinFont.png'),size:{x:30,y:30},offset:{x:8,y:5},vel:{x:-60,y:0},health:100000,speed:-75,type:ig.Entity.TYPE.C,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.PASSIVE,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',.1,[0]);},update:function(){this.parent();this.player=ig.game.player;if(this.pos.x>ig.system.width+50||this.pos.y>ig.system.height+50||this.pos.x<-50||this.pos.y<-50){this.kill();}
if((0|(ig.Timer.time*.3))&1){this.vel.y=65;}else{this.vel.y=-65;}},draw:function(){this.parent();if((0|(ig.Timer.time*1.5))&1){this.font.draw('Missiles!',this.pos.x+16,this.pos.y-28,ig.Font.ALIGN.CENTER);}else{return}},check:function(other){other.receiveDamage(0,this);if(ig.game.missiles.current<ig.game.missiles.max){ig.game.missiles.current+=5;if(ig.game.missiles.current>ig.game.missiles.max){ig.game.missiles.current=ig.game.missiles.max;}}
this.kill();}});});﻿


// lib/game/entities/object-pu-turret.js
ig.baked=true;ig.module('game.entities.object-pu-turret').requires('impact.entity','impact.sound').defines(function(){EntityObjectPickupTurret=ig.Entity.extend({animSheet:new ig.AnimationSheet('media/textures/pu_BulletTime.png',42,41),font:new ig.Font('media/fonts/xfinFont.png'),size:{x:30,y:30},vel:{x:-75,y:0},health:100000,speed:-75,type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.PASSIVE,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',.1,[0]);},update:function(){this.parent();this.checkBounds();if((0|(ig.Timer.time*.3))&1){this.vel.y=65;}else{this.vel.y=-65;}},draw:function(){this.parent();if((0|(ig.Timer.time*1.5))&1){this.font.draw('Turret!',this.pos.x+22,this.pos.y-20,ig.Font.ALIGN.CENTER);}else{return;}},check:function(other){other.receiveDamage(0,this);if(ig.game.turrets.current<ig.game.turrets.max){ig.game.turrets.current++;SoundSource.pickup.play();ig.game.player.pu_BT_TextTimer=new ig.Timer(3);}
this.kill();},checkBounds:function(){if(this.pos.x>ig.system.width+50||this.pos.y>ig.system.height+50||this.pos.x<-50||this.pos.y<-50){this.kill();}},});});

// lib/game/entities/object-fragmentSpawner.js
ig.baked=true;ig.module('game.entities.object-fragmentSpawner').requires('impact.entity').defines(function(){"use strict";var ParticlesImages=ig.Class.extend({init:function(){},blue:new ig.Image('media/textures/particlesBlue1.png'),yellow:new ig.Image('media/textures/particlesYellow1.png'),red:new ig.Image('media/textures/particlesRed1.png'),green:new ig.Image('media/textures/particlesGreen1.png'),grey:new ig.Image('media/textures/particlesGrey1.png')});window.FragmentSpawner=ig.Class.extend({defaultCount:10,init:function(maxParticleCount){this.colors=[];var myImages=new ParticlesImages();for(var p in myImages){FragmentSpawner[p]=this.colors.length;this.colors.push(myImages[p].data);}
function getGameTime(){return ig.Timer.time*1e3;};this._jSparkle=new ga.JSparkle(Fragment,maxParticleCount,ig.system.context,getGameTime);this.update=this._jSparkle.update.bind(this._jSparkle);this.draw=this._jSparkle.draw.bind(this._jSparkle);},spawn:function(x,y,colorIndex,_count,_radialDistance,_circleCount,_circleDelay){_count=_count||this.defaultCount;_circleCount=_circleCount||1;_circleDelay=_circleDelay||34;_radialDistance=_radialDistance||6;var colorImage=this.colors[colorIndex];x-=colorImage.width>>1;y-=colorImage.height>>1;this._jSparkle.spawn(_count,x,y,colorImage,_radialDistance,_circleCount,_circleDelay);}});function Fragment(){this.x=0;this.y=0;this.velX=0;this.velY=0;this.image=null;this.birthTime=0;this.deathTime=0;this.fadeTime=0;this.fadeRatio=0;}
var defaultFadeDuration=800;Fragment.prototype={dt:0,currentTime:0,drawContext:null,maxVelocityNorm:0.500,defaultLifeDuration:1500,defaultFadeDuration:defaultFadeDuration,__defaultFadeDurationInverse:1/defaultFadeDuration,previousAlpha:0,__screenX:0,__screenY:0,update:function(){this.x+=this.dt*this.velX;this.y+=this.dt*this.velY;if(this.currentTime>=this.fadeTime){this.fadeRatio=(this.deathTime-this.currentTime)*this.__defaultFadeDurationInverse;}else this.fadeRatio=1;},draw:function(){this.drawContext.globalAlpha=this.fadeRatio;this.drawContext.drawImage(this.image,0|(0.5+this.x-this.__screenX),0|(0.5+this.y-this.__screenY));},preDraw:function(){this.__screenX=ig.game.screen.x;this.__screenY=ig.game.screen.y;this.previousAlpha=this.drawContext.globalAlpha;},postDraw:function(){this.drawContext.globalAlpha=this.previousAlpha;},spawn:function(particleLoopBuffer,firstIndex,count,currentTime,x,y,image,radialDistance,circleCount,circleDelay){var index=firstIndex,length=particleLoopBuffer.length,particle=null,angleStep=circleCount*2*Math.PI/count,baseAngle=0,angle=0,thisVel=0,thisAngle=0,circleIndex=0,rand=0,pIndex=0,thisCos=0,thisSin=0;var pointPerCircle=0|(count/circleCount);while(count--){particle=particleLoopBuffer[index];particle.image=image;rand=Math.random();thisVel=(0.3+0.7*rand)*this.maxVelocityNorm;thisAngle=baseAngle+(0.1+0.9*rand)*angleStep;thisCos=Math.cos(thisAngle);thisSin=Math.sin(thisAngle);particle.velX=thisVel*thisCos;particle.velY=thisVel*thisSin;particle.x=x+radialDistance*thisCos*(1+0.25*rand);particle.y=y+radialDistance*thisSin*(1+0.25*rand);if(circleIndex>0){particle.birthTime=currentTime+circleIndex*circleDelay;particle.deathTime=particle.birthTime+this.defaultLifeDuration;}else{particle.birthTime=0;particle.deathTime=currentTime+this.defaultLifeDuration;}
particle.fadeTime=particle.deathTime-this.defaultFadeDuration;baseAngle+=angleStep;pIndex++;if(pIndex==pointPerCircle)circleIndex++;{index++;}
if(index==length){index=0;};}}};var getDrawPos=function(x){return 0|(x+0.5);};});﻿

// lib/game/screens/start-screen.js
ig.baked=true;ig.module('game.screens.start-screen').requires('impact.game','plugins.texture-atlas').defines(function(){StartScreen=ig.Game.extend({clickDelay:1,currentPageBackground:null,backgroundObj:{x:0,y:0},playerObj:{x:0,y:0},logoObj:{x:0,y:0},logoMaskObj:{x:0,y:0},backgroundMaskBObj:{x:0,y:0},startBlinkTimer:new ig.Timer(),showStartText:false,animationDone:false,screens:["background-image.png"],currentScreen:0,logoTween:null,splashScreenTextures:null,init:function(){this.splashScreenTextures=ig.screensTextureAtlas;this.setupTweens();this.animateIntoIn(this.animationIntroInComplete);ig.music.add(this.stage39Music,'stage39Music');ig.music.play('stage39Music');},setupTweens:function(){var logoData=this.splashScreenTextures.getFrameData("title.png").frame;this.page0Img=this.splashScreenTextures.getFrameData("background-image.png").frame;this.backgroundObj.x=(ig.system.width-(this.page0Img.w-53))*.5;this.backgroundObj.y=(ig.system.height-this.page0Img.h)*.5;if(this.ad&&ig.system.height<=786)
this.backgroundObj.y=10;this.logoObj.x=ig.system.width+300;this.logoObj.y=ig.system.height-300;this.logoTween=TweenLite.fromTo(this.logoObj,.5,{x:this.logoObj.x,y:this.logoObj.y},{x:this.backgroundObj.x+this.page0Img.w-logoData.w-50,y:this.backgroundObj.y+this.page0Img.h-logoData.h-15,delay:0,ease:Strong.easeOut});this.logoTween.pause();this.backgroundMaskBObj.x=this.backgroundObj.x;this.backgroundMaskBObj.y=this.backgroundObj.y-70;this.backgroundMaskBObj.w=755;this.backgroundMaskBObj.h=600;this.backrgoundMaskTween=TweenLite.fromTo(this.backgroundMaskBObj,1,{y:this.backgroundMaskBObj.y},{y:ig.system.height,ease:Quart.easeInOut});this.backrgoundMaskTween.pause();},showScreen:function(index){if(index>=this.screens.length){index=0;}
this.currentScreen=index;this.activeBGImg=this.screens[this.currentScreen];},animateIntoIn:function(callback){this.mode="animateIntroIn";this.logoTween.play();this.showScreen(0);this.animateMaskDown(.3,this.animationComplete);},animateIntroOut:function(callback){this.mode="animateIntroOut";this.animationDone=this.showStartText=false;this.backrgoundMaskTween.reverse().delay(.1);this.logoTween.reverse().delay(.4).eventCallback("onReverseComplete",this.animationComplete);},animateMaskUp:function(delay,callback){this.backrgoundMaskTween.reverse().delay(delay).eventCallback("onReverseComplete",callback);},animateMaskDown:function(delay,callback){this.backrgoundMaskTween.play().delay(delay).eventCallback("onComplete",callback);},animateNextPage:function(){if(ig.game.showScreen)
ig.game.showScreen(ig.game.currentScreen+1);},animationComplete:function(){switch(ig.game.mode){case"animateIntroIn":ig.game.animationDone=true;break;case"animateIntroOut":ig.game.gotoNextScreen();break;}},gotoNextScreen:function(){ig.system.setGame(InstructionsScreen);},update:function(){if(ig.input.pressed(Bindings.click)&&this.animationDone){this.onStart();}
this.parent();if(this.animationDone)
this.showStartText=Math.round(this.startBlinkTimer.delta())%2?true:false;var delay=ig.game.currentScreen==0?this.screenDelay*.5:this.screenDelay;if(ig.input.pressed(Bindings.enter)){this.onStart();}
if(typeof(controller)!="undefined"){var state=controller.getState();if(state.connected){if(state.start||state.a){this.onStart();}}}else{}},onStart:function(){this.animateIntroOut(this.animationInrtoOutComplete);},draw:function(){this.parent();this.splashScreenTextures.drawFrame(this.activeBGImg,this.backgroundObj.x,this.backgroundObj.y);ig.system.context.fillRect(this.backgroundMaskBObj.x,this.backgroundMaskBObj.y,this.backgroundMaskBObj.w,this.backgroundMaskBObj.h);if(this.showStartText){var txtImg=(this.currentScreen==0)?"start-text.png":"instructions-text.png";var txtFrame=this.splashScreenTextures.getFrameData(txtImg).frame;this.splashScreenTextures.drawFrame(txtImg,this.backgroundObj.x+this.page0Img.w-(txtFrame.w+50),this.backgroundObj.y+25);}
this.splashScreenTextures.drawFrame("background-mask.png",this.backgroundObj.x-25,this.logoObj.y-30);this.splashScreenTextures.drawFrame("title.png",this.logoObj.x,this.logoObj.y);ig.system.context.fillRect(this.backgroundObj.x+this.backgroundObj.width,this.backgroundObj.y-100,this.backgroundMaskBObj.w,this.backgroundMaskBObj.h);}});})

// lib/game/UI/PlayerInfoLeft.js
ig.baked=true;ig.module('game.UI.PlayerInfoLeft').requires('impact.entity','impact.sound').defines(function(){PlayerInfoLeft=ig.Entity.extend({font:new ig.Font('media/fonts/04b03_16.font.png'),lifeSprite:new ig.Image('media/ui/Ship-lifebar.png'),transTextBG_left:new ig.Image('media/ui/transTextBG_Lg1.png'),bulletTimeSprite:new ig.Image('media/ui/BulletTimeDisplayBar1.png'),hudOffsetX:20,hudOffsetY:20,init:function(x,y,settings){this.parent(x,y,settings);this.tween({pos:{x:40}},2,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();},draw:function(){this.parent();var xPos=this.pos.x+this.hudOffsetX;var yPos=this.pos.y+this.hudOffsetY;var missiles=ig.game.missiles.current;this.transTextBG_left.draw(xPos-14,yPos-18);this.font.draw("Lives",this.pos.x+this.hudOffsetX+8,yPos-6);for(var i=0;i<ig.game.stats.lives;i++){this.lifeSprite.draw(((this.lifeSprite.width+1)*i)+xPos+6,yPos+10);}
this.font.draw("Bullet Time",xPos+8,this.hudOffsetY+26);for(var i=0;i<ig.game.bulletTime.current;i++){this.bulletTimeSprite.draw(((this.bulletTimeSprite.width+4)*i)+xPos+9,yPos+44);}
this.font.draw("Turrets",xPos+8,this.hudOffsetY+58);for(var i=0;i<ig.game.turrets.current;i++){this.bulletTimeSprite.draw(((this.bulletTimeSprite.width+4)*i)+xPos+9,yPos+74);}
this.font.draw("Missiles:"+missiles,xPos+8,this.hudOffsetY+90);}});});

// lib/game/UI/PlayerInfoRight.js
ig.baked=true;ig.module('game.UI.PlayerInfoRight').requires('impact.entity','impact.sound').defines(function(){PlayerInfoRight=ig.Entity.extend({font:new ig.Font('media/fonts/04b03_16.font.png'),transTextBG_Lg:new ig.Image('media/ui/transTextBG_Lg.png'),hudOffsetY:20,init:function(x,y,settings){this.parent(x,y,settings);this.tween({pos:{x:ig.system.width-160}},2,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();},draw:function(){this.parent();var xPos=this.pos.x;var yPos=this.pos.y+this.hudOffsetY;var killsUntillBoss=-ig.game.stats.kills+ig.game.bossSpawnKills;this.transTextBG_Lg.draw(xPos-9,yPos-13);this.font.draw("Current Score",xPos+6,yPos-4);this.font.draw(ig.game.stats.kills*100,xPos+6,yPos+10);this.font.draw("Kills untill boss",xPos+6,this.hudOffsetY+29);this.font.draw(killsUntillBoss,xPos+6,yPos+43);}});});

// lib/game/UI/warningText.js
ig.baked=true;ig.module('game.UI.warningText').requires('impact.entity','impact.sound').defines(function(){WarningText=ig.Entity.extend({animSheet:new ig.AnimationSheet('media/ui/Warning.png',537,87),init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('idle',0.2,[0,1,2,3,4,5,6],true);this.tween({pos:{x:ig.system.width/2}},2,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();},draw:function(){this.parent();this.pos.x+=ig.system.width/2;this.pos.y+=ig.system.height/2;}});});

// lib/game/UI/gameOverScreen.js
ig.baked=true;ig.module('game.UI.gameOverScreen').requires('impact.entity','impact.sound').defines(function(){EntitygameOverScreen=ig.Entity.extend({screenImage:new ig.Image('media/ui/developersScreen.png'),name:'Game Over Screen',isMarkedForDeath:false,finishTimer:null,hasFocus:true,init:function(x,y,settings){this.parent(x,y,settings);this.tween({pos:{y:50}},3,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();ig.music.crossFade(.5,'clearMusic');},draw:function(){this.parent();var xPos=this.pos.x+0;var yPos=this.pos.y+0;this.screenImage.draw(xPos,yPos);},update:function(){this.parent();if(this.isMarkedForDeath===true){this.tweenOut();this.createFinishTimerAndKill();this.hasFocus=false;}},createFinishTimerAndKill:function(){if(this.finishTimer===null){this.finishTimer=new ig.Timer(2);}
if(this.finishTimer&&this.finishTimer.delta()>0){this.kill();}}});});﻿


// lib/game/UI/instructionScreen.js
ig.baked=true;ig.module('game.UI.instructionScreen').requires('impact.entity','impact.sound').defines(function(){EntityInstructionScreen=ig.Entity.extend({screenImage:new ig.Image('media/ui/instructionsScreen.png'),name:'Instructions Screen',isMarkedForDeath:false,finishTimer:null,hasFocus:true,init:function(x,y,settings){this.parent(x,y,settings);this.tween({pos:{x:120}},2,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();},draw:function(){this.parent();var xPos=this.pos.x+0;var yPos=this.pos.y+0;this.screenImage.draw(xPos,yPos);},update:function(){this.parent();if(this.isMarkedForDeath===true){this.tweenOut();this.createFinishTimerAndKill();this.hasFocus=false;}},createFinishTimerAndKill:function(){if(this.finishTimer===null){this.finishTimer=new ig.Timer(2);this.createLogo();}
if(this.finishTimer&&this.finishTimer.delta()>0){this.kill();}},createLogo:function(){var logo=ig.game.getEntityByName('Logo');if(!logo){ig.game.spawnEntity(EntitySuperRawrTypeLogo,ig.system.width/2-210,-400);}},tweenOut:function(){this.tween({pos:{x:-1500}},3,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();}});});

// lib/game/UI/developersScreen.js
ig.baked=true;ig.module('game.UI.developersScreen').requires('impact.entity','impact.sound').defines(function(){EntityDevelopersScreen=ig.Entity.extend({screenImage:new ig.Image('media/ui/developersScreen.png'),name:'Developers Screen',isMarkedForDeath:false,finishTimer:null,hasFocus:true,clearColor:'rgba(0,0,0,0.9)',init:function(x,y,settings){this.parent(x,y,settings);this.tween({pos:{x:120}},2,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();},draw:function(){this.parent();var xPos=this.pos.x+0;var yPos=this.pos.y+0;this.screenImage.draw(xPos,yPos);},update:function(){this.parent();if(this.isMarkedForDeath===true){this.tweenOut();this.createFinishTimerAndKill();this.hasFocus=false;}},createFinishTimerAndKill:function(){if(this.finishTimer===null){this.finishTimer=new ig.Timer(2);this.createLogo();}
if(this.finishTimer&&this.finishTimer.delta()>0){this.kill();}},createLogo:function(){var logo=ig.game.getEntityByName('Logo');if(!logo){ig.game.spawnEntity(EntitySuperRawrTypeLogo,ig.system.width/2-210,-400);}},tweenOut:function(){this.tween({pos:{x:-1500}},3,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();}});});

// lib/game/menus.js
ig.baked=true;ig.module('game.menus').requires('impact.font','game.UI.instructionScreen','game.UI.developersScreen').defines(function(){"use strict";window.MenuItem=ig.Class.extend({getText:function(){return'none'},left:function(){},right:function(){},ok:function(){},click:function(){ig.system.canvas.style.cursor='auto';this.ok();}});window.Menu=ig.Class.extend({clearColor:null,name:null,font:new ig.Font('media/fonts/xfinFont.png'),fontSelected:new ig.Font('media/fonts/xfinFont-blue-sel.png'),current:0,itemClasses:[],items:[],init:function(){this.y=ig.system.height/4+160;for(var i=0;i<this.itemClasses.length;i++){this.items.push(new this.itemClasses[i]());}},update:function(){if(ig.input.pressed('up')){this.current--;}
if(ig.input.pressed('down')){this.current++;}
this.current=this.current.limit(0,this.items.length-1);if(ig.input.pressed('left')){this.items[this.current].left();}
if(ig.input.pressed('right')){this.items[this.current].right();}
var margin=ig.ua.mobile?this.font.height/2:0;var ys=this.y;var xs=ig.system.width/2;var hoverItem=null;for(var i=0;i<this.items.length;i++){var item=this.items[i];var w=this.font.widthForString(item.getText())/2+margin;if(ig.input.mouse.x>xs-w&&ig.input.mouse.x<xs+w&&ig.input.mouse.y>ys-margin&&ig.input.mouse.y<ys+this.font.height+margin){hoverItem=item;this.current=i;}
ys+=this.font.height+20;}
if(hoverItem){ig.system.canvas.style.cursor='pointer';if(ig.input.pressed('shoot')||ig.input.pressed('enter')){hoverItem.click();}}else{ig.system.canvas.style.cursor='auto';}
if(ig.input.pressed('shoot')||ig.input.pressed('enter')){this.items[this.current].ok();}},draw:function(){if(this.clearColor){ig.system.context.fillStyle=this.clearColor;ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);}
var xs=ig.system.width/2;var ys=this.y;if(this.name){this.font.draw(this.name,xs,ys-160,ig.Font.ALIGN.CENTER);}
for(var i=0;i<this.items.length;i++){var t=this.items[i].getText();if(i==this.current){this.fontSelected.draw(t,xs,ys,ig.Font.ALIGN.CENTER);}else{this.font.draw(t,xs,ys,ig.Font.ALIGN.CENTER);}
ys+=this.font.height+20;}}});window.MenuItemSoundVolume=MenuItem.extend({getText:function(){return'Sound Volume: < '+(ig.soundManager.volume*100).round()+'% >';},left:function(){ig.soundManager.volume=(ig.soundManager.volume-0.1).limit(0,1);},right:function(){ig.soundManager.volume=(ig.soundManager.volume+0.1).limit(0,1);},click:function(){if(ig.input.mouse.x>336){this.right();}else{this.left();}}});window.MenuItemMusicVolume=MenuItem.extend({getText:function(){return'Music Volume: < '+(ig.music.volume*100).round()+'% >';},left:function(){ig.music.volume=(ig.music.volume-0.1).limit(0,1);},right:function(){ig.music.volume=(ig.music.volume+0.1).limit(0,1);},click:function(){if(ig.input.mouse.x>336){this.right();}else{this.left();}}});window.MenuItemEasyMode=MenuItem.extend({getText:function(){return'Play Easy Mode';},ok:function(){ig.game.difficulty='EASY';ig.game.setGame();}});window.MenuItemNormalMode=MenuItem.extend({getText:function(){return'Play Normal Mode';},ok:function(){ig.game.difficulty='NORMAL';ig.game.setGame();}});window.MenuItemHardMode=MenuItem.extend({getText:function(){return'Play Hard Mode';},ok:function(){ig.game.difficulty='HARD';ig.game.setGame();}});window.MenuItemResume=MenuItem.extend({getText:function(){return'Resume';},ok:function(){ig.game.toggleMenu();}});window.MenuItemRestart=MenuItem.extend({getText:function(){return'Restart Game';},ok:function(){ig.game.setTitle();}});window.MenuItemBlank=MenuItem.extend({getText:function(){return'';}});window.MenuItemPlay=MenuItem.extend({getText:function(){return'Start Game!';},ok:function(){ig.game.setGame();}});window.MenuItemTitleptionsMenu=MenuItem.extend({getText:function(){return'Options';},ok:function(){ig.game.toggleMenu();}});window.MenuItemInstructionScreen=MenuItem.extend({getText:function(){return'Instructions';},ok:function(){var instructionsScreen=ig.game.getEntityByName('Instructions Screen');if(!instructionsScreen){ig.game.spawnEntity(EntityInstructionScreen,-1000,0);ig.game.mode=window.RType.MODE.INSTRUCTIONS_SCREEN;}else{instructionsScreen.isMarkedForDeath=true;ig.game.mode=window.RType.MODE.TITLE;}}});window.DevelopersScreen=MenuItem.extend({getText:function(){return'Credits';},ok:function(){var developersScreen=ig.game.getEntityByName('Developers Screen');if(!developersScreen){ig.game.spawnEntity(EntityDevelopersScreen,-1000,0);ig.game.mode=window.RType.MODE.INSTRUCTIONS_SCREEN;}else{developersScreen.isMarkedForDeath=true;ig.game.mode=window.RType.MODE.TITLE;}}});window.PauseMenu=Menu.extend({name:'Menu',clearColor:'rgba(0,0,0,0.9)',init:function(){this.itemClasses.push(MenuItemSoundVolume);this.itemClasses.push(MenuItemMusicVolume);this.itemClasses.push(MenuItemResume);this.itemClasses.push(MenuItemRestart);this.parent();ig.game.isPaused;}});window.OptionsMenu=Menu.extend({init:function(){this.itemClasses.push(MenuItemSoundVolume);this.itemClasses.push(MenuItemMusicVolume);this.itemClasses.push(DevelopersScreen);this.itemClasses.push(MenuItemResume);this.parent();},update:function(){this.parent();var developersScreen=ig.game.getEntityByName('Developers Screen');if(developersScreen&&developersScreen.hasFocus===true){if(ig.input.pressed('up')){this.current=2;}
if(ig.input.pressed('down')){this.current=2;}}}});window.TitleMenu=Menu.extend({init:function(){this.itemClasses.push(MenuItemEasyMode);this.itemClasses.push(MenuItemNormalMode);this.itemClasses.push(MenuItemHardMode);this.itemClasses.push(MenuItemTitleptionsMenu);this.itemClasses.push(MenuItemInstructionScreen);this.parent();},update:function(){this.parent();var instructionsScreen=ig.game.getEntityByName('Instructions Screen');if(instructionsScreen&&instructionsScreen.hasFocus===true){if(ig.input.pressed('up')){this.current=4;}
if(ig.input.pressed('down')){this.current=4;}}}});});﻿
﻿


// lib/game/JSparkle.js
ig.baked=true;ig.module('game.JSparkle').defines(function(){(function(){window.ga=window.ga||{};ga.JSparkle=function(ParticleCtor,maxParticleCnt,drawContext,_getTime){if(!(maxParticleCnt>=1)){throw('JSparkle ctor error : Particle Count must be >=1');}
if(arguments.length<3){throw('JSparkle ctor error : constructor takes at least 3 parameters.');}
this._ParticleCtor=ParticleCtor;this._particleProto=ParticleCtor.prototype;this._batchSpawnCallback=ParticleCtor.prototype.spawn;ParticleCtor.prototype.drawContext=drawContext;this.particleLoopBuffer=new Array(maxParticleCnt);for(var i=0;i<maxParticleCnt;i++){this.particleLoopBuffer[i]=new ParticleCtor();}
this.firstParticleIndex=0;this.lastParticleIndex=-1;this.currentCount=0;this._drawContext=drawContext;this._preDraw=null;this._postDraw=null;this.getTime=_getTime||window.performance.now.bind(performance);this.dt=1;this.dtAvg=16;this.lastUpdateTime=0;var firstParticle=this.particleLoopBuffer[0];this._handleDeath=(firstParticle.deathTime!==undefined);this._handleBirth=(firstParticle.birthTime!==undefined);this.emiters=[];this._nextEmiterId=1;this._displayStats=false;this._displayStatsX=0;this._displayStatsY=0;this._displayStatsScale=1;this._measureUpdateDraw=false;this._drawDuration=this._drawDurationAvg=0;this._updateDuration=this._updateDurationAvg=0;this._lastRunTime=0;this.drawContext=null;this._boundRunLoop=null;this._runLoopTime=0;};var __callbackArgumentsArray=[null,0,0,0];ga.JSparkle.prototype={spawn:function spawn(cnt){var length=this.particleLoopBuffer.length;if(!(cnt>0)||(this.currentCount==length))return 0;if(cnt>length-this.currentCount)cnt=length-this.currentCount;var batchStartIndex=(this.lastParticleIndex+1);if(batchStartIndex==length)batchStartIndex=0;this.lastParticleIndex=(this.lastParticleIndex+cnt);if(this.lastParticleIndex>=length)this.lastParticleIndex-=length;this.currentCount+=cnt;if(arguments.length>1){__callbackArgumentsArray[0]=this.particleLoopBuffer;__callbackArgumentsArray[1]=batchStartIndex;__callbackArgumentsArray[2]=cnt;__callbackArgumentsArray[3]=this.getTime();for(var i=1,l=arguments.length;i<l;i++){__callbackArgumentsArray[i+3]=arguments[i];}
if(__callbackArgumentsArray.length>l+3)__callbackArgumentsArray.length=l+3;this._batchSpawnCallback.apply(this._particleProto,__callbackArgumentsArray);}else{this._batchSpawnCallback.call(this._particleProto,this.particleLoopBuffer,batchStartIndex,cnt,this.getTime());}
return cnt;},getMaxCount:function getMaxCount(){return this.particleLoopBuffer.length;},getCurrentCount:function getCurrentCount(){return this.currentCount;},clearSpawned:function clearSpawned(){this.currentCount=0;this.firstParticleIndex=0;this.lastParticleIndex=-1;},autoSpawn:function autoSpawn(timeInterval,particleCount){var nextEmitTime=this.getTime()+timeInterval;var asEmitController=isFunction(particleCount)?function(currentTime){if(currentTime<nextEmitTime){return 0;}
nextEmitTime=currentTime+timeInterval;return particleCount();}:function(currentTime){if(currentTime<nextEmitTime){return 0}
nextEmitTime=currentTime+timeInterval;return particleCount;};if(arguments.length==2){return this.emit(asEmitController);}
else{var args=Array.prototype.slice.call(arguments,1);args[0]=asEmitController;return this.emit.apply(this,args);}},emit:function emit(emitControler){var emitArguments=(arguments.length>1)?Array.prototype.slice.call(arguments):null;if(emitArguments){emitArguments[0]=0;}
var containsFunction=false;for(var i=1;i<arguments.length;i++){if(isFunction(arguments[i])){containsFunction=true;break;}}
this.emiters.push({emitController:emitControler,emitArguments:emitArguments,containsFunction:containsFunction,id:this._nextEmiterId});var currId=this._nextEmiterId++;return currId;},cancelAutoSpawn:function(autoSpawnId){this.removeEmiter(autoSpawnId);},cancelEmit:function(emiterId){var i=0,emiters=this.emiters;if(!emiters.length)return false;for(i=0;i<emiters.length;i++)if(emiters[i].id==emiterId)break;if(i==emiters.length)return false;for(;i<this.emiters.length-1;i++)this.emiters[i]=this.emiters[i+1];this.emiters.length--;return true;},setStatisticsDisplay:function setStatisticsDisplay(shouldDisplay,x,y,scale){this._displayStats=shouldDisplay;this._displayStatsX=x||0;this._displayStatsY=y||0;this._displayStatsScale=scale||1;},update:function update(dt,currentTime){if(!(dt&&currentTime)){if(!this.lastUpdateTime){currentTime=(currentTime||this.getTime());dt=16;}
else{currentTime=this.getTime();dt=(currentTime-this.lastUpdateTime);}
this.lastUpdateTime=currentTime;}
if(this._displayStats){this.dt=dt;}
if(this.emiters.length)this._handleEmit(currentTime);if(!this.currentCount)return;var particleLoopBuffer=this.particleLoopBuffer;var index=this.firstParticleIndex;var count=this.currentCount;var length=particleLoopBuffer.length;var thisParticle=null;var deadCount=0;if(this._handleDeath){while(count--){if(currentTime<particleLoopBuffer[index].deathTime){break;}
deadCount++;index++;if(index==length){index=0;}}
this.currentCount-=deadCount;if(this.currentCount==0){this.firstParticleIndex=0;this.lastParticleIndex=-1;return;}
this.firstParticleIndex=index;count=this.currentCount;}
this._particleProto.dt=dt;this._particleProto.currentTime=currentTime;if(this._handleDeath){while(count--){thisParticle=particleLoopBuffer[index];if(!(currentTime>=thisParticle.deathTime)&&!(currentTime<thisParticle.birthTime)){thisParticle.update();}
index++;if(index==length)index=0;}}else{while(count--){particleLoopBuffer[index].update();index++;if(index==length)index=0;}}},draw:function draw(_currentTime){var count=this.currentCount;if(!count)return;var particleLoopBuffer=this.particleLoopBuffer;var index=this.firstParticleIndex;var length=particleLoopBuffer.length;var thisParticle=null;_currentTime=_currentTime||this.getTime();if(this._particleProto.preDraw)this._particleProto.preDraw();while(count--){thisParticle=particleLoopBuffer[index];if(!(_currentTime>=thisParticle.deathTime)&&!(_currentTime<thisParticle.birthTime)){thisParticle.draw();}
index++;if(index==length)index=0;}
if(this._particleProto.postDraw)this._particleProto.postDraw();if(this._displayStats){this.displayStats(this._displayStatsX,this._displayStatsY,this._displayStatsScale);}},resize:function resize(newSize){var particleLoopBuffer=this.particleLoopBuffer;var length=particleLoopBuffer.length;if((!(newSize>1))||newSize==length){return}
var isLooping=this.currentCount&&(this.firstParticleIndex>this.lastParticleIndex);if(isLooping){var index=this.firstParticleIndex;var lastIndex=this.firstParticleIndex;var newArray=new Array(newSize);var newIndex=0;if(this.currentCount>=newSize){index=(index+(this.currentCount-newSize))%length;this.currentCount=newSize;}
do{newArray[newIndex]=particleLoopBuffer[index];newIndex++;if(newIndex==newSize){break}
index++;if(index==length){index=0}}while(index!=lastIndex);this.particleLoopBuffer=particleLoopBuffer=newArray;this.firstParticleIndex=0;this.lastParticleIndex=this.currentCount-1;}
if(newSize<length){if((!this.currentCount)||this.currentCount&&this.lastParticleIndex<newSize){this.particleLoopBuffer.length=newSize;return;}
if(this.currentCount>=newSize){var index=(this.firstParticleIndex+(this.currentCount-newSize))%length,i2=0;do{particleLoopBuffer[i2++]=particleLoopBuffer[index++];}while(index!=newSize);this.currentCount=newSize;}else{var index=this.firstParticleIndex,i2=0,swp=null;for(;index<=this.lastParticleIndex;index++,i2++){swp=particleLoopBuffer[i2];particleLoopBuffer[i2]=particleLoopBuffer[index];particleLoopBuffer[index]=swp;}}
this.firstParticleIndex=0;this.lastParticleIndex=this.currentCount-1;this.particleLoopBuffer.length=newSize;return;}else{for(var i=length;i<newSize;i++){particleLoopBuffer[i]=new this._ParticleCtor();}}},startRunLoop:function startRunLoop(_runLoopPreDraw,_runLoopPostDraw){this._lastRealTime=performance.now()-16;this._boundRunLoop=this._runLoop.bind(this);this._preDraw=_runLoopPreDraw;this._postDraw=_runLoopPostDraw;this._runLoopTime=1;this.getTime=(function(){return this._runLoopTime;}).bind(this);requestAnimationFrame(this._boundRunLoop);},stopRunLoop:function stopRunLoop(){if(!this._drawContext)return;this._drawContext=null;},_runLoop:function _runLoop(){if(!this._drawContext)return;var now=performance.now(),interval=now-this._lastRealTime;requestAnimationFrame(this._boundRunLoop);if(interval>14){if(interval>100){interval=16;}
this._lastRealTime=now;if(this._preDraw)this._preDraw(this._drawContext);this.draw(this._runLoopTime);if(this._postDraw)this._postDraw(this._drawContext);this.update(interval,this._runLoopTime);this._runLoopTime+=interval;}},displayStats:function displayStats(x,y,scale){x=x||0;y=y||0;scale=scale||1;var ctx=this._drawContext;ctx.save();ctx.translate(x,y);ctx.scale(scale,scale);this.dtAvg=this.dtAvg*0.95+this.dt*0.05;ctx.globalAlpha=0.5;ctx.fillStyle='#00A';ctx.fillRect(4,4,114,40);ctx.globalAlpha=1;ctx.font="bold 12px Arial";ctx.fillStyle='#fff';ctx.fillText('fps              : '+(1000/this.dt).toFixed(2),10,20);ctx.fillText('fps avg       : '+(1000/this.dtAvg).toFixed(2),10,36);if(!this.measureUpdateDraw){var oldUpdate=this.update;this.update=function(){var st=performance.now();oldUpdate.apply(this,arguments);this._updateDuration=performance.now()-st;};var oldDraw=this.draw;this.draw=function(){var st=performance.now();oldDraw.apply(this,arguments);this._drawDuration=performance.now()-st;};this.measureUpdateDraw=true;}
this._drawDurationAvg=this._drawDurationAvg*0.95+this._drawDuration*0.05;this._updateDurationAvg=this._updateDurationAvg*0.95+this._updateDuration*0.05;ctx.globalAlpha=0.5;ctx.fillStyle='#00A';ctx.fillRect(4,52,114,70);ctx.globalAlpha=1;ctx.font="bold 12px Arial";ctx.fillStyle='#fff';ctx.fillText('draw           : '+(this._drawDuration).toFixed(2),10,68);ctx.fillText('update        : '+(this._updateDuration).toFixed(2),10,84);ctx.fillText('draw avg    : '+(this._drawDurationAvg).toFixed(2),10,100);ctx.fillText('update avg : '+(this._updateDurationAvg).toFixed(2),10,116);ctx.globalAlpha=0.5;ctx.fillStyle='#00A';ctx.fillRect(4,128,114,56);ctx.globalAlpha=1;ctx.fillStyle='#fff';var length=this.particleLoopBuffer.length;ctx.fillText(this.currentCount+' / '+length,24,148);ctx.fillStyle='#4B4';ctx.fillRect(10,160,100,8);ctx.fillStyle='#B44';if(this.firstParticleIndex<this.lastParticleIndex){ctx.fillRect(10+100*this.firstParticleIndex/length,160,100*this.currentCount/length,8);}else{ctx.fillRect(10,160,100*this.lastParticleIndex/length,8);ctx.fillRect(10+100*this.firstParticleIndex/length,160,(100-100*this.firstParticleIndex/length),8);}
ctx.restore();},_handleEmit:function(currentTime){var ei=0,len=0;var emiters=this.emiters;var killedCount=0;for(ei=0,len=emiters.length;ei<len;ei++){var thisEmiter=emiters[ei];var partCount=thisEmiter.emitController(currentTime);if(partCount==0){continue}
if(partCount==-1){emiters[ei]=null;killedCount++;continue;}
var thisArguments=thisEmiter.emitArguments;if(!thisArguments){this.spawn(partCount);}else{thisArguments[0]=partCount;if(thisEmiter.containsFunction){thisArguments=thisArguments.slice();for(var i=0;i<thisArguments.length;i++){if(isFunction(thisArguments[i]))thisArguments[i]=thisArguments[i].call(this._particleProto)}}
this.spawn.apply(this,thisArguments);}}
if(killedCount){emiters.removeNull();}},_measureScreenFps:function _measureScreenFps(MeasureDoneCallback){var startMeasureTime=0;var measure=function(){if(!startMeasureTime){startMeasureTime=performance.now();requestAnimationFrame(measure);return;}
var screenFps=performance.now()-startMeasureTime;MeasureDoneCallback(screenFps);};requestAnimationFrame(measure);}};TypicalParticleCtor=function(){this.x=0;this.y=0;this.vx=0;this.vy=0;this.colorIndex=0;this.birthTime=0;this.deathTime=0;};TypicalParticleCtor.prototype={dt:0,currentTime:0,drawContext:null,gravity:9.8,colors:['#FEF','#FED','#EDE','#EEF'],update:function(){this.x+=this.vx*this.dt;this.y+=this.vy*this.dt;},draw:function(){this.drawContext.fillRect(this.x,this.y,1,1);},spawn:function(particleLoopBuffer,firstIndex,count,currentTime,x,y,colorIndex){var index=firstIndex;var length=particleLoopBuffer.length;var particle=null;while(count--){particle=particleLoopBuffer[index];particle.x=x+10*Math.random();particle.y=y+10*Math.random();particle.color=this.colors[colorIndex];index++;if(index==length){index=0};}},preDraw:function(){this._previous_globalCompositeOperation=this.drawContext.globalCompositeOperation;this.drawContext.globalCompositeOperation='lighter';},postDraw:function(){this.drawContext.globalCompositeOperation=this._previous_globalCompositeOperation;},_previous_globalCompositeOperation:null};function isFunction(e){return(typeof e=='function');}
Object.defineProperty(Function.prototype,'setOnPrototype',{value:function(o){for(var p in o){this.prototype[p]=o[p]}}});var removeNull=function(){var nullCount=0;var length=this.length;for(var i=0,len=this.length;i<len;i++){if(!this[i]){nullCount++}}
if(!nullCount){return this}
if(nullCount==length){this.length=0;return this}
var idest=0,isrc=length-1;length-=nullCount;while(true){while(!this[isrc]){isrc--;nullCount--;}
if(!nullCount){break}
while(this[idest]){idest++}
this[idest]=this[isrc];if(!(--nullCount)){break}
idest++;isrc--;}
this.length=length;return this;};Object.defineProperty(Array.prototype,'removeNull',{value:removeNull});var w=window,foundRequestAnimationFrame=w.requestAnimationFrame||w.webkitRequestAnimationFrame||w.msRequestAnimationFrame||w.mozRequestAnimationFrame||w.oRequestAnimationFrame||function(cb){setTimeout(cb,1000/60);};window.requestAnimationFrame=foundRequestAnimationFrame;if(!window.performance){window.performance={};};var p=window.performance;window.performance.now=p.now||p.webkitNow||p.msNow||p.mozNow||Date.now||function(){return+new Date()};})();});

// lib/game/StarField.js
ig.baked=true;ig.module('game.StarField').requires('game.JSparkle').defines(function(){window.ga=window.ga||{};ga.particles=ga.particles||{};ga.particles.Star=function(){this.x=0;this.y=0;this.fakeZ=1;this.speed=0;this.colorIndex=0;};var colors=[];for(var i=0;i<10;i++)colors.push('#'+(i+5).toString(16)+(i+5).toString(16)+(i+5).toString(16));ga.particles.Star.prototype={dt:0,currentTime:0,drawContext:null,fieldWidth:0,fieldHeight:0,starSpeed:1,starImage:null,update:function(){this.x+=this.dt*this.speed;if(this.x<0){this.x=this.fieldWidth+32;this.y=Math.random()*this.fieldHeight;this.speed=this.fakeZ*this.fieldWidth*this.starSpeed/(1000);}},draw:function(){var width1=Math.round(4*this.fakeZ*this.fakeZ);if(width1>2){this.drawContext.fillStyle=colors[this.colorIndex];this.drawContext.globalAlpha=0.4+0.6*Math.abs(Math.cos(this.timeShift+Date.now()/200));this.drawContext.fillRect(Math.round(this.x),Math.round(this.y),3.8,3.8);}else{this.drawContext.fillStyle=colors[this.colorIndex];this.drawContext.globalAlpha=0.4+0.6*Math.abs(Math.cos(this.timeShift+Date.now()/200));this.drawContext.fillRect(Math.round(this.x),Math.round(this.y),1.6,1.6);}
this.drawContext.globalAlpha=1;},spawn:function(particleLoopBuffer,firstIndex,count){var w=this.fieldWidth,h=this.fieldHeight;var index=firstIndex;var length=particleLoopBuffer.length;var particle=null;while(count--){particle=particleLoopBuffer[index];particle.x=w*Math.random();particle.y=h*Math.random();particle.fakeZ=0.08+Math.pow(Math.random(),1.4)*0.92;particle.speed=this.starSpeed*w*particle.fakeZ/(1000);particle.colorIndex=0|(Math.random()*colors.length);index++;if(index==length)index=0;}
particleLoopBuffer.sort(function(a,b){if(!a.fakeZ*b.fakeZ)return 1;return(a.fakeZ-b.fakeZ)});}};});

// lib/game/SoundSource.js
ig.baked=true;ig.module('game.SoundSource').requires('impact.game','impact.sound').defines(function(){var _SoundSource=ig.Class.extend({bossMusic:new ig.Sound('media/music/Boss-5.*',true),AstVenOrbMusic:new ig.Sound('media/music/Granitoid-Basilisk.*',true),clearMusic:new ig.Sound('media/music/Password-4.*',true),controlsMusic:new ig.Sound('media/music/Cutscene-1.*',true),shoot:new ig.Sound('media/sfx/hit01.*',true),hit:new ig.Sound('media/sfx/hit03.*',true),explode:new ig.Sound('media/sfx/Explode01.*',true),blastoff:new ig.Sound('media/sfx/sfx_blastoff.*',true),teleport:new ig.Sound('media/sfx/sfx_teleport.*',true),pickup:new ig.Sound('media/sfx/PickupBulletTime.*',true),miniShipSpawn:new ig.Sound('media/sfx/MiniShipSpawn.*',true),miniShipKill:new ig.Sound('media/sfx/MiniShipKill.*',true),slowMo:new ig.Sound('media/sfx/SlowMo.*',true),missileLaunch:new ig.Sound('media/sfx/missile-launch.*',true)});window.SoundSource=new _SoundSource();});

// lib/game/entities/actor-enemySentinel.js
ig.baked=true;ig.module('game.entities.actor-enemySentinel').requires('game.entities.base-enemy').defines(function(){EntityEnemySentinel=EntityBaseEnemy.extend({animSheet:new ig.AnimationSheet('media/textures/purple-ship.png',52,48),size:{x:30,y:30},offset:{x:+6,y:+8},friction:{x:150,y:0},speed:600,health:7,shootTimer:null,moveTimer:null,initTimer:null,newSpawnTimer:null,xModifier:100,initTime:2,particleCnt:40,init:function(x,y,settings){this.parent(x,y,settings);this.addAnim('fly',0.2,[0,1,2,3,4,5,6]);this.initTimer=new ig.Timer(this.initTime);this.shootTimer=new ig.Timer(this.randomFromTo(1,3));this.newSpawnTimer=new ig.Timer(3);this.startAngle=this.ownAngle;this._angle=this.currentAnim.angle+3;this._increase=30;this.bullets=3;this.radius=1;this._entityBullet=EntityObjectEnemyBulletPurple;},update:function(){this.parent();this.shootBullets();},receiveDamage:function(value,from){this.parent(value,from);if(this.health>1){var x=this.pos.x+(this.size.x>>1);var y=this.pos.y+(this.size.y>>1);ig.game.fragmentSpawner.spawn(x,y,FragmentSpawner.green,this.particleCnt,this.size.x);}}});});

// lib/game/pathPatterns.js
ig.baked=true;ig.module('game.pathPatterns').requires('impact.game','plugins.Path','game.entities.actor-follower','game.entities.actor-enemySentinel').defines(function(){"use strict";ig.Game.inject({createPathOne:function(){var settings={path:null,pathSpeed:220,loopCount:0,spawnDelay:0,rank:3,onPathEnd:null,adjustAngle:true,shift:null,pathLengths:null,normalizedSegments:null,createFollower:true};var width=ig.system.width;var ceiling=0;var floor=ig.system.height;var height=30;var bumps=3;var smoothing=30;var onePath=new ga.Path([width,floor/4,width-400,floor/4]);onePath.addFunctionPath(width/2,ig.system.height,function(r){return height*Math.sin(bumps*Math.PI*r);},smoothing);settings.path=onePath;ig.game.spawnEntity(EntityEnemySentinel,-1,-1,settings);settings.spawnDelay+=0.8;ig.game.spawnEntity(EntityEnemySentinel,-1,-1,settings);settings.spawnDelay+=0.8;ig.game.spawnEntity(EntityEnemySentinel,-1,-1,settings);},createPathTwo:function(){var settings={path:null,pathSpeed:200,loopCount:0,spawnDelay:0,rank:3,onPathEnd:null,adjustAngle:true,shift:null,pathLengths:null,normalizedSegments:null,createFollower:true};var width=ig.system.width;var ceiling=0;var floor=ig.system.height;var height=30;var bumps=3;var smoothing=30;var twoPath=new ga.Path([width,floor/2,width-400,floor/2]);twoPath.addFunctionPath(width/2,ceiling,function(r){return height*Math.sin(bumps*Math.PI*r);},smoothing);settings.path=twoPath;ig.game.spawnEntity(EntityEnemySentinel,-1,-1,settings);settings.spawnDelay+=0.8;ig.game.spawnEntity(EntityEnemySentinel,-1,-1,settings);settings.spawnDelay+=0.8;ig.game.spawnEntity(EntityEnemySentinel,-1,-1,settings);},createPathThree:function(){var settings={path:null,pathSpeed:220,loopCount:0,spawnDelay:0,rank:3,onPathEnd:null,adjustAngle:true,shift:null,pathLengths:null,normalizedSegments:null,createFollower:true};var width=ig.system.width;var ceiling=0;var floor=ig.system.height;var height=30;var bumps=3;var smoothing=30;var threePath=new ga.Path([width/2,floor,width-400,floor/2]);threePath.addFunctionPath(width/2,ceiling,function(r){return height*Math.sin(bumps*Math.PI*r);},smoothing);settings.path=threePath;ig.game.spawnEntity(EntityEnemySentinel,-1,-1,settings);settings.spawnDelay+=0.8;ig.game.spawnEntity(EntityEnemySentinel,-1,-1,settings);settings.spawnDelay+=0.8;ig.game.spawnEntity(EntityEnemySentinel,-1,-1,settings);},createPathFour:function(){var settings={path:null,pathSpeed:180,loopCount:0,spawnDelay:0,rank:3,onPathEnd:null,adjustAngle:true,shift:null,pathLengths:null,normalizedSegments:null,createFollower:true};var width=ig.system.width;var ceiling=0;var floor=ig.system.height;var height=30;var bumps=3;var smoothing=30;var fourPath=new ga.Path([width/2,floor,ig.system.width/2,floor/2]);fourPath.addFunctionPath(0,floor/2,function(r){return height*Math.sin(bumps*Math.PI*r);},smoothing);settings.path=fourPath;this.spawnEntity(EntityActorEnemySpinShip,-1,-1,settings);settings.spawnDelay+=0.6;this.spawnEntity(EntityActorEnemySpinShip,-1,-1,settings);settings.spawnDelay+=0.6;this.spawnEntity(EntityActorEnemySpinShip,-1,-1,settings);},createPathFive:function(){var settings={path:null,pathSpeed:270,loopCount:0,spawnDelay:0,rank:3,onPathEnd:null,adjustAngle:true,shift:null,pathLengths:null,normalizedSegments:null,createFollower:true};var width=ig.system.width;var ceiling=0;var floor=ig.system.height;var height=30;var bumps=3;var smoothing=30;var onePath=new ga.Path([width,floor/4,width-400,floor/4]);onePath.addFunctionPath(width/2,ig.system.height,function(r){return height*Math.sin(bumps*Math.PI*r);},smoothing);settings.path=onePath;ig.game.spawnEntity(EntityTestFollower,-1,-1,settings);settings.spawnDelay+=0.8;ig.game.spawnEntity(EntityTestFollower,-1,-1,settings);settings.spawnDelay+=0.8;ig.game.spawnEntity(EntityTestFollower,-1,-1,settings);},createPathSix:function(){var settings={path:null,pathSpeed:220,loopCount:0,spawnDelay:0,rank:3,onPathEnd:null,adjustAngle:true,shift:null,pathLengths:null,normalizedSegments:null,createFollower:true};var width=ig.system.width;var ceiling=0;var floor=ig.system.height;var height=30;var bumps=3;var smoothing=30;var fourPath=new ga.Path([width/2,floor,ig.system.width/2,floor/2]);fourPath.addFunctionPath(0,floor/2,function(r){return height*Math.sin(bumps*Math.PI*r);},smoothing);settings.path=fourPath;this.spawnEntity(EntityActorEnemySpinShip,-1,-1,settings);settings.spawnDelay+=0.4;this.spawnEntity(EntityActorEnemySpinShip,-1,-1,settings);settings.spawnDelay+=0.4;this.spawnEntity(EntityActorEnemySpinShip,-1,-1,settings);}});});

// lib/game/UI/superRawrTypeLogo.js
ig.baked=true;ig.module('game.UI.superRawrTypeLogo').requires('impact.entity','impact.sound').defines(function(){EntitySuperRawrTypeLogo=ig.Entity.extend({screenImage:new ig.Image('media/ui/Super-Rawr-Type-Redux-Logo.png'),name:'Logo',isMarkedForDeath:false,finishTimer:null,hasFocus:true,timeTillDeath:1.2,init:function(x,y,settings){this.parent(x,y,settings);this.tween({pos:{x:ig.system.width/2-210,y:130}},2,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();},draw:function(){this.parent();var xPos=this.pos.x+0;var yPos=this.pos.y+0;this.screenImage.draw(xPos,yPos);},update:function(){this.parent();if(this.isMarkedForDeath===true){this.tweenOut();this.createFinishTimerAndKill();this.hasFocus=false;}
if(ig.game.mode===window.RType.MODE.INSTRUCTIONS_SCREEN){this.createFinishTimerAndKill();}},createFinishTimerAndKill:function(){if(this.finishTimer===null){this.finishTimer=new ig.Timer(this.timeTillDeath);this.tweenOut();}
if(this.finishTimer&&this.finishTimer.delta()>0){this.kill();}},tweenOut:function(){this.tween({pos:{x:-1500}},3,{easing:ig.Tween.Easing.Quartic.EaseOut}).start();}});});

// C:\Users\dvoyle200\SkyDrive\Development\web\impact\lib\game\main.js
ig.baked=true;ig.module('game.main').requires('impact.game','impact.font','impact.gaPooling','plugins.packed-textures','plugins.tween-lite','plugins.menu','plugins.Path','plugins.pause','plugins.parallax','plugins.pause-focus','plugins.screenshaker','plugins.musicFader','plugins.impact-tween.tween','game.entities.actor-player','game.entities.object-pu-bulletTime','game.entities.object-pu-miniship','game.entities.object-pu-life','game.entities.object-pu-missile','game.entities.object-pu-turret','game.entities.object-fragmentSpawner','game.entities.actor-follower','game.screens.start-screen','game.UI.PlayerInfoLeft','game.UI.PlayerInfoRight','game.UI.warningText','game.UI.gameOverScreen','game.menus','game.StarField','game.SoundSource','game.pathPatterns','game.UI.superRawrTypeLogo').defines(function(){ig.merge(ig,window.ImpactMixin);window.RType=ig.Game.extend({font:new ig.Font('media/fonts/04b03_16.font.png'),xFinBlue_sm:new ig.Font('media/fonts/xfinFont-blue-sm.png'),title:new ig.Image('media/textures/star.png'),menu:null,mode:0,difficulty:'EASY',isPaused:false,screenShaker:null,timeSlower:null,finishTimer:null,gameOverTimer:null,gameResetTime:8,init:function(){this.screenShaker=new ScreenShaker();this.timeSlower=new TimeSlower();this.fragmentSpawner=new FragmentSpawner(1000);this.setStarField();this.poolEntities();this.setMusic();this.setTitle();},update:function(){this.parent();this.updateShakeScreenAndSlowTime();this.updateMenu();this.inputControls();this.createGameOverScreen();this.createGameOverTimer();this.starSparkle.update();this.fragmentSpawner.update()
console.log(ig.game.mode);},draw:function(){this.parent();this.starSparkle.draw();this.fragmentSpawner.draw();this.drawInsertCoin();this.drawMenu();},drawInsertCoin:function(){if(ig.game.mode===window.RType.MODE.GAME){if((0|(ig.Timer.time*1))&1){this.font.draw("Insert Coin",ig.system.width-300,20);}}},drawMenu:function(){if(this.menu){this.menu.draw();}},updateMenu:function(){if(!this.menu&&(ig.input.pressed('escape'))){this.toggleMenu();}
if(this.menu){this.menu.update();}},inputControls:function(){ig.input.bind(ig.KEY.LEFT_ARROW,'left');ig.input.bind(ig.KEY.RIGHT_ARROW,'right');ig.input.bind(ig.KEY.UP_ARROW,'up');ig.input.bind(ig.KEY.DOWN_ARROW,'down');ig.input.bind(ig.KEY.ENTER,'enter');ig.input.bind(ig.KEY.C,'shoot');ig.input.bind(ig.KEY.X,'slowTime');ig.input.bind(ig.KEY.MOUSE1,'shoot');ig.input.bind(ig.KEY.V,'spawnTurret');ig.input.bind(ig.KEY.B,'shootMissile');ig.input.bind(ig.KEY.ESC,'escape');},toggleMenu:function(){if(ig.game.mode===window.RType.MODE.TITLE){if(this.menu instanceof TitleMenu){this.menu=new OptionsMenu();}else{this.menu=new TitleMenu();}}else{if(this.menu){ig.system.canvas.style.cursor='';this.menu=null;}else{this.menu=new PauseMenu();}
this.togglePause();}},setGame:function(){ig.game.unPause();this.menu=null;ig.music.play('astroVenOrbMusic');this.player=ig.game.spawnEntity(EntityActorPlayer,0,ig.system.height/2);this.enemySpawner=ig.game.spawnEntity(EntityActorEnemySpawner,ig.system.width/2,ig.system.height/2);ig.game.mode=window.RType.MODE.GAME;this.setDifficulty();this.setUI();this.destroyLogo();},destroyLogo:function(){var logo=ig.game.getEntityByName('Logo');logo.createFinishTimerAndKill();},setUI:function(){ig.game.spawnEntity(PlayerInfoLeft,-500,0);ig.game.spawnEntity(PlayerInfoRight,0,0);},setTitle:function(){ig.game.mode=window.RType.MODE.TITLE;this.clearScreen();this.menu=new TitleMenu();this.setMusic();ig.music.crossFade(.4,'controlsMusic');ig.game.spawnEntity(EntitySuperRawrTypeLogo,ig.system.width/2-210,-400);},setMusic:function(){ig.music.add(SoundSource.controlsMusic,'controlsMusic');ig.music.add(SoundSource.AstVenOrbMusic,'astroVenOrbMusic');ig.music.add(SoundSource.bossMusic,'bossMusic');ig.music.add(SoundSource.clearMusic,'clearMusic');ig.music.loop=true;},setDifficulty:function(){switch(ig.game.difficulty){case'EASY':ig.game.resetStats('EASY');break;case'NORMAL':ig.game.resetStats('NORMAL');break;case'HARD':ig.game.resetStats('HARD');break;default:ig.game.resetStats('NORMAL');}},setStarField:function(){ga.particles.Star.setOnPrototype({fieldWidth:ig.system.canvas.width,fieldHeight:ig.system.canvas.height,starSpeed:-0.3,starImage:this.title.data});var starCount=250;function getGameTime(){return ig.Timer.time*1e3;};this.starSparkle=new ga.JSparkle(ga.particles.Star,starCount,ig.system.context,getGameTime);this.starSparkle.spawn(starCount);},setGameOver:function(){this.clearScreen();this.resetStats();this.setTitle();},createGameOverTimer:function(){if(ig.game.mode===window.RType.MODE.GAME_OVER){if(this.gameOverTimer===null){this.gameOverTimer=new ig.Timer(this.gameResetTime);}}
if(this.gameOverTimer&&this.gameOverTimer.delta()>0){this.setGameOver();this.gameOverTimer=null;ig.game.mode=window.RType.MODE.TITLE;}},createGameOverScreen:function(){if(ig.game.mode===window.RType.MODE.GAME_OVER){var gameOverScreen=ig.game.getEntityByName('Game Over Screen');if(!gameOverScreen){if(this.finishTimer===null){this.finishTimer=new ig.Timer(2);}
if(this.finishTimer&&this.finishTimer.delta()>0){ig.game.spawnEntity(EntitygameOverScreen,0,-1000);this.finishTimer=null;}}}},updateShakeScreenAndSlowTime:function(){this.screenShaker.update();this.screenShaker.shakeScreen(this.screen);this.timeSlower.update();},slowTime:function(){if(this.bulletTime.current<=this.bulletTime.max&&this.bulletTime.current>=0&&this.player.slowMoTimer.delta()>this.player.slowMoDelay){this.timeSlower.alterTimeScale(0.4,1.2,2.2,1.2);this.bulletTime.current--;SoundSource.slowMo.play();this.player.slowMoTimer.reset();this.player.bulletTimeTimer=new ig.Timer(2);}},poolEntities:function(){ga.autoPoolEntities();EntityPlayerBullet.setupPool(60);EntityEnemyTurretBullet.setupPool(60);EntityTurretBullet.setupPool(100);EntityHomingMissile.setupPool(20);},clearScreen:function(){for(var i=0;i<this.entities.length;i++){this.entities[i].kill();};var gameOverScreen=ig.game.getEntityByName('Game Over Screen');if(gameOverScreen){gameOverScreen.kill();};}});window.RType.MODE={TITLE:0,GAME:1,GAME_OVER:2,BOSS_JUST_KILLED:3,INSTRUCTIONS_SCREEN:4};ig.Sound.enabled=true;ig.main('#canvas',RType,60,1280,720,1);});